<Activity mc:Ignorable="sap sap2010" x:Class="main" xmlns="http://schemas.microsoft.com/netfx/2009/xaml/activities" xmlns:av="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:mva="clr-namespace:Microsoft.VisualBasic.Activities;assembly=System.Activities" xmlns:s="clr-namespace:System;assembly=mscorlib" xmlns:sap="http://schemas.microsoft.com/netfx/2009/xaml/activities/presentation" xmlns:sap2010="http://schemas.microsoft.com/netfx/2010/xaml/activities/presentation" xmlns:scg="clr-namespace:System.Collections.Generic;assembly=mscorlib" xmlns:sd="clr-namespace:System.Data;assembly=System.Data" xmlns:this="clr-namespace:" xmlns:ui="http://schemas.uipath.com/workflow/activities" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
  <x:Members>
    <x:Property Name="_intRobotState" Type="InArgument(x:Int32)" />
    <x:Property Name="_dicConfig" Type="InArgument(scg:Dictionary(x:String, x:Object))" />
  </x:Members>
  <this:main._dicConfig>
    <InArgument x:TypeArguments="scg:Dictionary(x:String, x:Object)" />
  </this:main._dicConfig>
  <mva:VisualBasic.Settings>
    <x:Null />
  </mva:VisualBasic.Settings>
  <sap:VirtualizedContainerService.HintSize>864,1242</sap:VirtualizedContainerService.HintSize>
  <sap2010:WorkflowViewState.IdRef>main_1</sap2010:WorkflowViewState.IdRef>
  <TextExpression.NamespacesForImplementation>
    <scg:List x:TypeArguments="x:String" Capacity="32">
      <x:String>System.Activities</x:String>
      <x:String>System.Activities.Statements</x:String>
      <x:String>System.Activities.Expressions</x:String>
      <x:String>System.Activities.Validation</x:String>
      <x:String>System.Activities.XamlIntegration</x:String>
      <x:String>Microsoft.VisualBasic</x:String>
      <x:String>Microsoft.VisualBasic.Activities</x:String>
      <x:String>System</x:String>
      <x:String>System.Collections</x:String>
      <x:String>System.Collections.Generic</x:String>
      <x:String>System.Data</x:String>
      <x:String>System.Diagnostics</x:String>
      <x:String>System.Drawing</x:String>
      <x:String>System.IO</x:String>
      <x:String>System.Linq</x:String>
      <x:String>System.Net.Mail</x:String>
      <x:String>System.Xml</x:String>
      <x:String>System.Xml.Linq</x:String>
      <x:String>System.Windows.Markup</x:String>
      <x:String>UiPath.Core</x:String>
      <x:String>UiPath.Core.Activities</x:String>
      <x:String>System.Activities.DynamicUpdate</x:String>
      <x:String>System.Reflection</x:String>
      <x:String>System.Runtime.InteropServices</x:String>
      <x:String>System.Runtime.Serialization</x:String>
      <x:String>System.Collections.ObjectModel</x:String>
      <x:String>Microsoft.VisualBasic.CompilerServices</x:String>
      <x:String>System.ComponentModel</x:String>
      <x:String>System.Xml.Serialization</x:String>
      <x:String>UiPath.Excel</x:String>
      <x:String>UiPath.Excel.Activities</x:String>
      <x:String>System.Globalization</x:String>
    </scg:List>
  </TextExpression.NamespacesForImplementation>
  <TextExpression.ReferencesForImplementation>
    <scg:List x:TypeArguments="AssemblyReference" Capacity="34">
      <AssemblyReference>System.Activities</AssemblyReference>
      <AssemblyReference>Microsoft.VisualBasic</AssemblyReference>
      <AssemblyReference>mscorlib</AssemblyReference>
      <AssemblyReference>System.Data</AssemblyReference>
      <AssemblyReference>System.Data.DataSetExtensions</AssemblyReference>
      <AssemblyReference>System</AssemblyReference>
      <AssemblyReference>System.Drawing</AssemblyReference>
      <AssemblyReference>System.Core</AssemblyReference>
      <AssemblyReference>System.Xml</AssemblyReference>
      <AssemblyReference>System.Xml.Linq</AssemblyReference>
      <AssemblyReference>PresentationFramework</AssemblyReference>
      <AssemblyReference>WindowsBase</AssemblyReference>
      <AssemblyReference>PresentationCore</AssemblyReference>
      <AssemblyReference>System.Xaml</AssemblyReference>
      <AssemblyReference>UiPath.UiAutomation.Activities</AssemblyReference>
      <AssemblyReference>UiPath.System.Activities</AssemblyReference>
      <AssemblyReference>System.ServiceModel</AssemblyReference>
      <AssemblyReference>UiPath.Excel</AssemblyReference>
      <AssemblyReference>UiPath.Mail</AssemblyReference>
      <AssemblyReference>System.ValueTuple</AssemblyReference>
      <AssemblyReference>System.ComponentModel.Composition</AssemblyReference>
      <AssemblyReference>UiPath.Studio.Plugin.Workflow</AssemblyReference>
      <AssemblyReference>UiPath.System.Activities.Design</AssemblyReference>
      <AssemblyReference>Microsoft.Bcl.AsyncInterfaces</AssemblyReference>
      <AssemblyReference>System.Memory</AssemblyReference>
      <AssemblyReference>UiPath.OCR.Activities.Design</AssemblyReference>
      <AssemblyReference>UiPath.UIAutomationCore</AssemblyReference>
      <AssemblyReference>System.Runtime.Serialization</AssemblyReference>
      <AssemblyReference>UiPath.Excel.Activities</AssemblyReference>
      <AssemblyReference>UiPath.CV</AssemblyReference>
      <AssemblyReference>System.Data.Entity</AssemblyReference>
      <AssemblyReference>UiPath.Studio.Constants</AssemblyReference>
      <AssemblyReference>System.Collections.Immutable</AssemblyReference>
      <AssemblyReference>System.Runtime.WindowsRuntime</AssemblyReference>
    </scg:List>
  </TextExpression.ReferencesForImplementation>
  <sap:WorkflowViewStateService.ViewState>
    <scg:Dictionary x:TypeArguments="x:String, x:Object">
      <x:Boolean x:Key="ShouldExpandAll">True</x:Boolean>
    </scg:Dictionary>
  </sap:WorkflowViewStateService.ViewState>
  <Sequence sap2010:Annotation.AnnotationText="*** META ***&#xA;Process: RPA05_ETAXUpload&#xA;Creattion date: 2021-04-08&#xA;Last update: &#xA;Author: abeam.devs&#xA;UiPath Version: 2020.10.4" DisplayName="_main" sap:VirtualizedContainerService.HintSize="874,1077.33333333333" sap2010:WorkflowViewState.IdRef="Sequence_25">
    <sap:WorkflowViewStateService.ViewState>
      <scg:Dictionary x:TypeArguments="x:String, x:Object">
        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
        <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
      </scg:Dictionary>
    </sap:WorkflowViewStateService.ViewState>
    <StateMachine InitialState="{x:Reference __ReferenceID7}" DisplayName="main" sap:VirtualizedContainerService.HintSize="832,877.333333333333" sap2010:WorkflowViewState.IdRef="StateMachine_1">
      <sap:WorkflowViewStateService.ViewState>
        <scg:Dictionary x:TypeArguments="x:String, x:Object">
          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
          <av:Point x:Key="ShapeLocation">30,2.4</av:Point>
          <x:Double x:Key="StateContainerWidth">798.0394773782748</x:Double>
          <x:Double x:Key="StateContainerHeight">841</x:Double>
          <av:PointCollection x:Key="ConnectorLocation">57,77.0666666666667 57,107.066666666667 75.9,107.066666666667 75.9,108</av:PointCollection>
          <x:Boolean x:Key="IsPinned">False</x:Boolean>
        </scg:Dictionary>
      </sap:WorkflowViewStateService.ViewState>
      <State x:Name="__ReferenceID1" sap2010:Annotation.AnnotationText="1.  Save execution metadata&#xA;2. If exception: send email &#xA;3. If system exception throw exception" DisplayName="final_state" sap:VirtualizedContainerService.HintSize="207.333333333333,137.333333333333" sap2010:WorkflowViewState.IdRef="State_1" IsFinal="True">
        <State.Entry>
          <Sequence DisplayName="final_state" sap:VirtualizedContainerService.HintSize="654,2294" sap2010:WorkflowViewState.IdRef="Sequence_163">
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                <x:Boolean x:Key="IsPinned">False</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
            <Sequence DisplayName="final_sequence" sap:VirtualizedContainerService.HintSize="592,1892" sap2010:WorkflowViewState.IdRef="Sequence_63">
              <Sequence.Variables>
                <Variable x:TypeArguments="scg:Dictionary(x:String, x:Object)" Name="dicAuxData" />
                <Variable x:TypeArguments="s:String[]" Name="arrAttachments" />
              </Sequence.Variables>
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="inv_utils_output_json_log" sap:VirtualizedContainerService.HintSize="530,123.333333333333" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_23" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="wfs\_fmw\support\utils_output_json_log.xaml">
                <ui:InvokeWorkflowFile.Arguments>
                  <InArgument x:TypeArguments="scg:Dictionary(x:String, x:Object)" x:Key="_dicAuxData">[dicAuxData]</InArgument>
                  <InArgument x:TypeArguments="s:Exception" x:Key="_excSystemError">[excSystemError]</InArgument>
                  <InArgument x:TypeArguments="ui:BusinessRuleException" x:Key="_excBusinessError">[excBusinessError]</InArgument>
                  <InArgument x:TypeArguments="s:DateTime" x:Key="_dtiExecutionStartTime">[dtiExecutionStartTime]</InArgument>
                  <InArgument x:TypeArguments="x:Boolean" x:Key="_boolOutputJSON">[CBool(_dicConfig("DUMP_JSON_LOGS"))]</InArgument>
                  <InArgument x:TypeArguments="scg:Dictionary(x:String, x:Object)" x:Key="_dicConfiguration">[_dicConfig]</InArgument>
                </ui:InvokeWorkflowFile.Arguments>
              </ui:InvokeWorkflowFile>
              <If Condition="[excBusinessError IsNot Nothing]" DisplayName="if_exception_exists" sap:VirtualizedContainerService.HintSize="530,754" sap2010:WorkflowViewState.IdRef="If_78">
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <If.Then>
                  <Sequence sap2010:Annotation.AnnotationText="[Optional]  Depends on the process&#xA;- Send email to Business" DisplayName="report_business_exception" sap:VirtualizedContainerService.HintSize="493.333333333333,552" sap2010:WorkflowViewState.IdRef="Sequence_252">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <ui:LogMessage DisplayName="process_finshed_with_business_exception" sap:VirtualizedContainerService.HintSize="431.333333333333,103.333333333333" sap2010:WorkflowViewState.IdRef="LogMessage_118" Level="Warn" Message="[&quot;Process finished with business exception.&quot;]" />
                    <ui:MultipleAssign DisplayName="assign_email_parameters" sap:VirtualizedContainerService.HintSize="431.333333333333,170.666666666667" sap2010:WorkflowViewState.IdRef="MultipleAssign_19">
                      <ui:MultipleAssign.AssignOperations>
                        <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_39">
                            <ui:AssignOperation.To>
                              <OutArgument x:TypeArguments="x:String">[strSubjectBusinessError]</OutArgument>
                            </ui:AssignOperation.To>
                            <ui:AssignOperation.Value>
                              <InArgument x:TypeArguments="x:String">[_dicConfig("EMAIL_SUBJECT_BUSINESS").ToString]</InArgument>
                            </ui:AssignOperation.Value>
                          </ui:AssignOperation>
                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_40">
                            <ui:AssignOperation.To>
                              <OutArgument x:TypeArguments="s:String[]">[arrBodyFields]</OutArgument>
                            </ui:AssignOperation.To>
                            <ui:AssignOperation.Value>
                              <InArgument x:TypeArguments="s:String[]">[{_dicConfig("PROCESS_NAME_ID").ToString ,excBusinessError.Message}]</InArgument>
                            </ui:AssignOperation.Value>
                          </ui:AssignOperation>
                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_41">
                            <ui:AssignOperation.To>
                              <OutArgument x:TypeArguments="s:String[]">[arrAttachments]</OutArgument>
                            </ui:AssignOperation.To>
                            <ui:AssignOperation.Value>
                              <InArgument x:TypeArguments="s:String[]">[{}]</InArgument>
                            </ui:AssignOperation.Value>
                          </ui:AssignOperation>
                        </scg:List>
                      </ui:MultipleAssign.AssignOperations>
                    </ui:MultipleAssign>
                    <TerminateWorkflow DisplayName="Terminate Workflow" sap:VirtualizedContainerService.HintSize="358,32" sap2010:WorkflowViewState.IdRef="TerminateWorkflow_1" Reason="Process finished with business exception." />
                  </Sequence>
                </If.Then>
                <If.Else>
                  <Sequence sap2010:WorkflowViewState.IdRef="Sequence_253">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                  </Sequence>
                </If.Else>
              </If>
              <If Condition="[excSystemError IsNot Nothing]" DisplayName="if_sys_exc_exist" sap:VirtualizedContainerService.HintSize="484,812.666666666667" sap2010:WorkflowViewState.IdRef="If_79">
                <If.Then>
                  <Sequence DisplayName="report_sys_exc" sap:VirtualizedContainerService.HintSize="400,610.666666666667" sap2010:WorkflowViewState.IdRef="Sequence_254">
                    <Sequence.Variables>
                      <Variable x:TypeArguments="x:String" Name="strSubjectError" />
                    </Sequence.Variables>
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <ui:LogMessage DisplayName="process_erroneous" sap:VirtualizedContainerService.HintSize="358,103.333333333333" sap2010:WorkflowViewState.IdRef="LogMessage_120" Level="Warn" Message="[&quot;Process finished with error.&quot;]">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                    </ui:LogMessage>
                    <ui:MultipleAssign DisplayName="assign_email_parameters" sap:VirtualizedContainerService.HintSize="358,168.666666666667" sap2010:WorkflowViewState.IdRef="MultipleAssign_20">
                      <ui:MultipleAssign.AssignOperations>
                        <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_42">
                            <ui:AssignOperation.To>
                              <OutArgument x:TypeArguments="x:String">[strSubjectError]</OutArgument>
                            </ui:AssignOperation.To>
                            <ui:AssignOperation.Value>
                              <InArgument x:TypeArguments="x:String">[_dicConfig("EMAIL_SUBJECT_SYSTEM").ToString]</InArgument>
                            </ui:AssignOperation.Value>
                          </ui:AssignOperation>
                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_43">
                            <ui:AssignOperation.To>
                              <OutArgument x:TypeArguments="s:String[]">[arrBodyFields]</OutArgument>
                            </ui:AssignOperation.To>
                            <ui:AssignOperation.Value>
                              <InArgument x:TypeArguments="s:String[]">[{_dicConfig("PROCESS_NAME_ID").ToString, _intRobotState.ToString, excSystemError.Source.ToString, excSystemError.Message.Replace("&lt;", "-").Replace("&gt;", "-")}]</InArgument>
                            </ui:AssignOperation.Value>
                          </ui:AssignOperation>
                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_44">
                            <ui:AssignOperation.To>
                              <OutArgument x:TypeArguments="s:String[]">[arrAttachments]</OutArgument>
                            </ui:AssignOperation.To>
                            <ui:AssignOperation.Value>
                              <InArgument x:TypeArguments="s:String[]">[arrScreenshotNames.Select(function (filename) _dicConfig("EXCEPTIONS").ToString + filename).ToArray]</InArgument>
                            </ui:AssignOperation.Value>
                          </ui:AssignOperation>
                        </scg:List>
                      </ui:MultipleAssign.AssignOperations>
                    </ui:MultipleAssign>
                    <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="inv_utils_send_email_system_error" sap:VirtualizedContainerService.HintSize="358,96.6666666666667" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_25" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="wfs\_fmw\utils_send_email.xaml">
                      <ui:InvokeWorkflowFile.Arguments>
                        <InArgument x:TypeArguments="x:String" x:Key="_strSubject">[strSubjectError]</InArgument>
                        <InArgument x:TypeArguments="x:String" x:Key="_strCredentialsName">[_dicConfig("EMAIL_CREDENTIALS").ToString]</InArgument>
                        <InArgument x:TypeArguments="s:String[]" x:Key="_arrBodyFields">[arrBodyFields]</InArgument>
                        <InArgument x:TypeArguments="s:String[]" x:Key="_arrRecipients">[{}]</InArgument>
                        <InArgument x:TypeArguments="x:String" x:Key="_strSenderName">[_dicConfig("ROBOT_NAME").ToString]</InArgument>
                        <InArgument x:TypeArguments="s:String[]" x:Key="_arrAttachmentsFiles">[arrAttachments]</InArgument>
                        <InArgument x:TypeArguments="x:Boolean" x:Key="_boolSendEmail">[CBool(_dicConfig("SEND_EMAILS"))]</InArgument>
                        <InArgument x:TypeArguments="x:Int32" x:Key="_intEnvironment">[CInt(_dicConfig("ENVIRONMENT"))]</InArgument>
                        <InArgument x:TypeArguments="x:String" x:Key="_strRecipientsFmwFile">[_dicConfig("RECIPIENTS_FILE").ToString]</InArgument>
                        <InArgument x:TypeArguments="x:String" x:Key="_strEmailWrapperFile">[_dicConfig("EMAIL_WRAPPER_INTERNAL").ToString]</InArgument>
                        <InArgument x:TypeArguments="x:String" x:Key="_strBodyMsgFile">[_dicConfig("BODY_SYSTEM_EXCEPTION").ToString]</InArgument>
                        <InArgument x:TypeArguments="x:String" x:Key="_strEmailType">system_exception</InArgument>
                        <InArgument x:TypeArguments="s:String[]" x:Key="_arrExtraWrapperFields">[{}]</InArgument>
                        <InArgument x:TypeArguments="x:String" x:Key="_strEmailServer">outlook</InArgument>
                        <InArgument x:TypeArguments="x:Int32" x:Key="_intMaxTimeToSendEmail">45</InArgument>
                      </ui:InvokeWorkflowFile.Arguments>
                    </ui:InvokeWorkflowFile>
                    <Throw DisplayName="throw_system_exception" Exception="[excSystemError]" sap:VirtualizedContainerService.HintSize="358,32" sap2010:WorkflowViewState.IdRef="Throw_7" />
                  </Sequence>
                </If.Then>
                <If.Else>
                  <Sequence sap2010:WorkflowViewState.IdRef="Sequence_255">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                  </Sequence>
                </If.Else>
              </If>
            </Sequence>
            <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="ivk_utils_close_apps" sap:VirtualizedContainerService.HintSize="546,96.6666666666667" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_90" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="wfs\_fmw\utils_close_apps.xaml">
              <ui:InvokeWorkflowFile.Arguments>
                <InArgument x:TypeArguments="x:Int32" x:Key="_intTimeoutClose">2</InArgument>
              </ui:InvokeWorkflowFile.Arguments>
            </ui:InvokeWorkflowFile>
            <ui:LogMessage DisplayName="log_process_sucessful" sap:VirtualizedContainerService.HintSize="546,103.333333333333" sap2010:WorkflowViewState.IdRef="LogMessage_121" Level="Info" Message="[&quot;Process finished succesfully.&quot;]">
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
            </ui:LogMessage>
          </Sequence>
        </State.Entry>
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <av:Point x:Key="ShapeLocation">250,691</av:Point>
            <av:Size x:Key="ShapeSize">207.333333333333,137.333333333333</av:Size>
            <x:Boolean x:Key="IsPinned">False</x:Boolean>
            <x:Double x:Key="StateContainerWidth">173.60000000000002</x:Double>
            <x:Double x:Key="StateContainerHeight">25</x:Double>
            <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
        <State.Variables>
          <Variable x:TypeArguments="x:String" Name="strSubjectBusinessError" />
          <Variable x:TypeArguments="s:String[]" Name="arrBodyFields" />
        </State.Variables>
      </State>
      <State x:Name="__ReferenceID0" sap2010:Annotation.AnnotationText="Get Kissflow approval email" DisplayName="process_kissflow" sap:VirtualizedContainerService.HintSize="210,94" sap2010:WorkflowViewState.IdRef="State_3">
        <State.Entry>
          <Sequence sap2010:Annotation.AnnotationText="When copying this state, the only modification to be made is changing the condition of the below IF statement to match the process number." DisplayName="process_current_state" sap:VirtualizedContainerService.HintSize="1427.33333333333,3088" sap2010:WorkflowViewState.IdRef="Sequence_9">
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
            <If Condition="[_intRobotState = 1]" DisplayName="if_robot_state_is_this" sap:VirtualizedContainerService.HintSize="1385.33333333333,2998" sap2010:WorkflowViewState.IdRef="If_3">
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <If.Then>
                <TryCatch DisplayName="tc_process_current_state" sap:VirtualizedContainerService.HintSize="1348.66666666667,2796" sap2010:WorkflowViewState.IdRef="TryCatch_3">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <TryCatch.Try>
                    <Sequence DisplayName="try_process_current_state" sap:VirtualizedContainerService.HintSize="1310,2204.66666666667" sap2010:WorkflowViewState.IdRef="Sequence_11">
                      <Sequence.Variables>
                        <Variable x:TypeArguments="sd:DataTable" Name="dtaWorktrayFiltered" />
                        <Variable x:TypeArguments="s:String[]" Name="arrFiles" />
                        <Variable x:TypeArguments="x:String" Name="strInputPath" />
                      </Sequence.Variables>
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <ui:LogMessage DisplayName="log_starting_state" sap:VirtualizedContainerService.HintSize="1268,103.333333333333" sap2010:WorkflowViewState.IdRef="LogMessage_35" Level="Info" Message="[&quot;--- Khởi tạo state: &quot;+ _intRobotState.ToString + &quot; ---&quot;]">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                      </ui:LogMessage>
                      <ui:FilterDataTable sap2010:Annotation.AnnotationText="filter criteria &quot;prepare&quot; = Inactive" DataTable="[dtaWorktray]" DisplayName="filter_dtaWorktray" FilterRowsMode="Keep" sap:VirtualizedContainerService.HintSize="1268,202" sap2010:WorkflowViewState.IdRef="FilterDataTable_1" OutputDataTable="[dtaWorktrayFiltered]" SelectColumnsMode="Keep">
                        <ui:FilterDataTable.Filters>
                          <scg:List x:TypeArguments="ui:FilterOperationArgument" Capacity="4">
                            <ui:FilterOperationArgument BooleanOperator="And" Operator="CONTAINS">
                              <ui:FilterOperationArgument.Column>
                                <InArgument x:TypeArguments="x:String">["prepare"]</InArgument>
                              </ui:FilterOperationArgument.Column>
                              <ui:FilterOperationArgument.Operand>
                                <InArgument x:TypeArguments="x:String">["Inactive"]</InArgument>
                              </ui:FilterOperationArgument.Operand>
                            </ui:FilterOperationArgument>
                            <ui:FilterOperationArgument BooleanOperator="And" Operator="CONTAINS">
                              <ui:FilterOperationArgument.Column>
                                <InArgument x:TypeArguments="x:String">["file_type"]</InArgument>
                              </ui:FilterOperationArgument.Column>
                              <ui:FilterOperationArgument.Operand>
                                <InArgument x:TypeArguments="x:String">["kissflow"]</InArgument>
                              </ui:FilterOperationArgument.Operand>
                            </ui:FilterOperationArgument>
                          </scg:List>
                        </ui:FilterDataTable.Filters>
                        <ui:FilterDataTable.SelectColumns>
                          <scg:List x:TypeArguments="InArgument" Capacity="4">
                            <x:Null />
                          </scg:List>
                        </ui:FilterDataTable.SelectColumns>
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                      </ui:FilterDataTable>
                      <If Condition="[dtaWorktrayFiltered.Rows.Count &gt; 0]" DisplayName="if_has_file_to_proceed" sap:VirtualizedContainerService.HintSize="1268,1118.66666666667" sap2010:WorkflowViewState.IdRef="If_50">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <If.Then>
                          <Sequence DisplayName="execute_kissflow" sap:VirtualizedContainerService.HintSize="888,946.666666666667" sap2010:WorkflowViewState.IdRef="Sequence_152">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                            <ui:LogMessage DisplayName="log_info_start" sap:VirtualizedContainerService.HintSize="846,103.333333333333" sap2010:WorkflowViewState.IdRef="LogMessage_83" Level="Info" Message="[&quot;State 1:  Bắt đầu xử lý trích xuất dữ liệu từ địa chỉ email &quot; &amp; _dicConfig(&quot;MAIL_ADDRESS&quot;).Tostring &amp; &quot;...&quot;]">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                            </ui:LogMessage>
                            <If Condition="[intRetryCounter &lt; intMaxTryNumber - 1]" DisplayName="if_retry_max_times" sap:VirtualizedContainerService.HintSize="846,713.333333333333" sap2010:WorkflowViewState.IdRef="If_57">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <If.Then>
                                <Sequence DisplayName="process_get_kissflow_emails" sap:VirtualizedContainerService.HintSize="400,541.333333333333" sap2010:WorkflowViewState.IdRef="Sequence_196">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="ivk_outlook_get_kissflow_email" sap:VirtualizedContainerService.HintSize="358,123.333333333333" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_44" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="wfs\mail\outlook_get_kissflow_email.xaml">
                                    <ui:InvokeWorkflowFile.Arguments>
                                      <InArgument x:TypeArguments="s:DateTime" x:Key="_dtiProcess">[dtiProcess]</InArgument>
                                      <InArgument x:TypeArguments="x:String" x:Key="_strMailFolder">[_dicConfig("MAIL_FOLDER").ToString]</InArgument>
                                      <InArgument x:TypeArguments="x:String" x:Key="_strMailAddress">[_dicConfig("MAIL_ADDRESS").ToString]</InArgument>
                                      <InArgument x:TypeArguments="x:String" x:Key="_strMailFilter">[_dicConfig("MAIL_FILTER").ToString]</InArgument>
                                      <InArgument x:TypeArguments="x:String" x:Key="_strSavingFolder">[_dicConfig("UPLOAD_FOLDER").ToString]</InArgument>
                                      <InOutArgument x:TypeArguments="sd:DataTable" x:Key="_dtaTracking">[dtaTracking]</InOutArgument>
                                    </ui:InvokeWorkflowFile.Arguments>
                                  </ui:InvokeWorkflowFile>
                                  <ui:WriteRange StartingCell="{x:Null}" AddHeaders="True" DataTable="[dtaTracking]" DisplayName="wr_workbench" sap:VirtualizedContainerService.HintSize="358,124.666666666667" sap2010:WorkflowViewState.IdRef="WriteRange_8" SheetName="workbench" WorkbookPath="[Path.Combine(environment.CurrentDirectory,_dicConfig(&quot;PROCESS_DATA&quot;).ToString, _dicConfig(&quot;WORKTRAY_FILE&quot;).ToString)]">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                  </ui:WriteRange>
                                  <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="ivk_utils_update_worktray" sap:VirtualizedContainerService.HintSize="358,123.333333333333" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_11" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="wfs\_utils\utils_update_worktray.xaml">
                                    <ui:InvokeWorkflowFile.Arguments>
                                      <InOutArgument x:TypeArguments="sd:DataTable" x:Key="_dtaWorktray">[dtaWorktray]</InOutArgument>
                                      <InArgument x:TypeArguments="x:String" x:Key="_strStatus">Completed</InArgument>
                                      <InArgument x:TypeArguments="x:String" x:Key="_strFileType">kissflow</InArgument>
                                      <InArgument x:TypeArguments="x:String" x:Key="_strUpdateColumn">prepare</InArgument>
                                    </ui:InvokeWorkflowFile.Arguments>
                                  </ui:InvokeWorkflowFile>
                                </Sequence>
                              </If.Then>
                              <If.Else>
                                <Sequence DisplayName="reset_counter_and_continue" sap:VirtualizedContainerService.HintSize="400,468" sap2010:WorkflowViewState.IdRef="Sequence_181">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <ui:LogMessage DisplayName="log_max_retries_reach" sap:VirtualizedContainerService.HintSize="358,103.333333333333" sap2010:WorkflowViewState.IdRef="LogMessage_126" Level="Info" Message="[&quot;State 1:  Robot đã xử lý ngoại lệ nhiều hơn số lần cho phép... Tiến hành điền Worktray phần Kissflow là Pending...&quot;]">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                  </ui:LogMessage>
                                  <Assign DisplayName="reset_retry_counter" sap:VirtualizedContainerService.HintSize="358,71.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_138">
                                    <Assign.To>
                                      <OutArgument x:TypeArguments="x:Int32">[intRetryCounter]</OutArgument>
                                    </Assign.To>
                                    <Assign.Value>
                                      <InArgument x:TypeArguments="x:Int32">0</InArgument>
                                    </Assign.Value>
                                  </Assign>
                                  <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="ivk_utils_update_worktray" sap:VirtualizedContainerService.HintSize="358,123.333333333333" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_7" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="wfs\_utils\utils_update_worktray.xaml">
                                    <ui:InvokeWorkflowFile.Arguments>
                                      <InOutArgument x:TypeArguments="sd:DataTable" x:Key="_dtaWorktray">[dtaWorktray]</InOutArgument>
                                      <InArgument x:TypeArguments="x:String" x:Key="_strStatus">Failed</InArgument>
                                      <InArgument x:TypeArguments="x:String" x:Key="_strFileType">kissflow</InArgument>
                                      <InArgument x:TypeArguments="x:String" x:Key="_strUpdateColumn">prepare</InArgument>
                                    </ui:InvokeWorkflowFile.Arguments>
                                  </ui:InvokeWorkflowFile>
                                </Sequence>
                              </If.Else>
                            </If>
                          </Sequence>
                        </If.Then>
                        <If.Else>
                          <ui:LogMessage DisplayName="log_info_pass_state_1" sap:VirtualizedContainerService.HintSize="334,103.333333333333" sap2010:WorkflowViewState.IdRef="LogMessage_84" Level="Info" Message="[&quot;State 1:  Worktray - Không cần xử lý email Kissflow...&quot;]">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                          </ui:LogMessage>
                        </If.Else>
                      </If>
                      <ui:WriteRange StartingCell="{x:Null}" AddHeaders="True" DataTable="[dtaWorktray]" DisplayName="wr_worktray" sap:VirtualizedContainerService.HintSize="1268,124.666666666667" sap2010:WorkflowViewState.IdRef="WriteRange_1" SheetName="base" WorkbookPath="[Path.Combine(environment.CurrentDirectory,_dicConfig(&quot;PROCESS_DATA&quot;).ToString, _dicConfig(&quot;WORKTRAY_FILE&quot;).ToString)]">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                      </ui:WriteRange>
                      <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" sap2010:Annotation.AnnotationText="This activity allows to stop execution from orchestrator. It can be invoked many times as needed per state, to ensure checking of orchestrator signal." DisplayName="inv_orchestrator_stop_process" sap:VirtualizedContainerService.HintSize="1268,183.333333333333" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_17" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="wfs\_fmw\orchestrator_stop_process.xaml">
                        <ui:InvokeWorkflowFile.Arguments>
                          <scg:Dictionary x:TypeArguments="x:String, Argument" />
                        </ui:InvokeWorkflowFile.Arguments>
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                      </ui:InvokeWorkflowFile>
                      <Assign DisplayName="increment_robot_state" sap:VirtualizedContainerService.HintSize="1268,71.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_9">
                        <Assign.To>
                          <OutArgument x:TypeArguments="x:Int32">[_intRobotState]</OutArgument>
                        </Assign.To>
                        <Assign.Value>
                          <InArgument x:TypeArguments="x:Int32">[_intRobotState + 1]</InArgument>
                        </Assign.Value>
                      </Assign>
                      <Assign DisplayName="reset_retry_counter" sap:VirtualizedContainerService.HintSize="1268,71.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_14">
                        <Assign.To>
                          <OutArgument x:TypeArguments="x:Int32">[intRetryCounter]</OutArgument>
                        </Assign.To>
                        <Assign.Value>
                          <InArgument x:TypeArguments="x:Int32">0</InArgument>
                        </Assign.Value>
                      </Assign>
                    </Sequence>
                  </TryCatch.Try>
                  <TryCatch.Catches>
                    <Catch x:TypeArguments="ui:BusinessRuleException" sap:VirtualizedContainerService.HintSize="1266.66666666667,131.333333333333" sap2010:WorkflowViewState.IdRef="Catch`1_6">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <ActivityAction x:TypeArguments="ui:BusinessRuleException">
                        <ActivityAction.Argument>
                          <DelegateInArgument x:TypeArguments="ui:BusinessRuleException" Name="exception" />
                        </ActivityAction.Argument>
                        <Assign DisplayName="get_business_exception" sap:VirtualizedContainerService.HintSize="262,61.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_69">
                          <Assign.To>
                            <OutArgument x:TypeArguments="ui:BusinessRuleException">[excBusinessError]</OutArgument>
                          </Assign.To>
                          <Assign.Value>
                            <InArgument x:TypeArguments="ui:BusinessRuleException">[exception]</InArgument>
                          </Assign.Value>
                        </Assign>
                      </ActivityAction>
                    </Catch>
                    <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="1266.66666666667,131.333333333333" sap2010:WorkflowViewState.IdRef="Catch`1_7">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <ActivityAction x:TypeArguments="s:Exception">
                        <ActivityAction.Argument>
                          <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                        </ActivityAction.Argument>
                        <Assign DisplayName="get_system_exception" sap:VirtualizedContainerService.HintSize="262,61.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_70">
                          <Assign.To>
                            <OutArgument x:TypeArguments="s:Exception">[excSystemError]</OutArgument>
                          </Assign.To>
                          <Assign.Value>
                            <InArgument x:TypeArguments="s:Exception">[exception]</InArgument>
                          </Assign.Value>
                        </Assign>
                      </ActivityAction>
                    </Catch>
                  </TryCatch.Catches>
                </TryCatch>
              </If.Then>
            </If>
          </Sequence>
        </State.Entry>
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <av:Point x:Key="ShapeLocation">245,36.5</av:Point>
            <av:Size x:Key="ShapeSize">210,94</av:Size>
            <x:Boolean x:Key="IsPinned">False</x:Boolean>
            <x:Double x:Key="StateContainerWidth">176</x:Double>
            <x:Double x:Key="StateContainerHeight">27.04000000000002</x:Double>
            <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
        <State.Transitions>
          <Transition DisplayName="Error" sap:VirtualizedContainerService.HintSize="450,505" sap2010:WorkflowViewState.IdRef="Transition_20">
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <av:PointCollection x:Key="ConnectorLocation">455,92.9 485,92.9 485,180.3 583.2,180.3</av:PointCollection>
                <x:Int32 x:Key="SrcConnectionPointIndex">44</x:Int32>
                <x:Int32 x:Key="DestConnectionPointIndex">9</x:Int32>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
            <Transition.Condition>[excSystemError isNot Nothing or excBusinessError isNot Nothing]</Transition.Condition>
            <Transition.To>
              <State x:Name="__ReferenceID2" sap2010:Annotation.AnnotationText="1. Take screenshot&#xA;2. Log exception&#xA;3. Close applications&#xA;4. Set variables to retry current state&#xA;" DisplayName="error_state" sap:VirtualizedContainerService.HintSize="151.333333333333,479.333333333333" sap2010:WorkflowViewState.IdRef="State_17">
                <State.Entry>
                  <Sequence DisplayName="handle_error" sap:VirtualizedContainerService.HintSize="900,2650.4" sap2010:WorkflowViewState.IdRef="Sequence_110">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <ui:LogMessage DisplayName="log_error_found_in_state" sap:VirtualizedContainerService.HintSize="858.4,92.8" sap2010:WorkflowViewState.IdRef="LogMessage_70" Level="Error" Message="[String.Format(&quot;Error found in state: {0}&quot;, _intRobotState)]">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                    </ui:LogMessage>
                    <If Condition="[excBusinessError isNot Nothing]" DisplayName="if_business_exception_exists" sap:VirtualizedContainerService.HintSize="858.4,678.4" sap2010:WorkflowViewState.IdRef="If_38">
                      <If.Then>
                        <Sequence DisplayName="log_business_exception" sap:VirtualizedContainerService.HintSize="375.2,499.2" sap2010:WorkflowViewState.IdRef="Sequence_111">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <ui:MultipleAssign DisplayName="assign_screenshot_name" sap:VirtualizedContainerService.HintSize="333.6,99.2" sap2010:WorkflowViewState.IdRef="MultipleAssign_18">
                            <ui:MultipleAssign.AssignOperations>
                              <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_38">
                                  <ui:AssignOperation.To>
                                    <OutArgument x:TypeArguments="x:String">[strExceptionName]</OutArgument>
                                  </ui:AssignOperation.To>
                                  <ui:AssignOperation.Value>
                                    <InArgument x:TypeArguments="x:String">[Now.ToString("yyyyMMdd_HHmmss")+"_exception_" + intRetryCounter.ToString + ".txt"]</InArgument>
                                  </ui:AssignOperation.Value>
                                </ui:AssignOperation>
                              </scg:List>
                            </ui:MultipleAssign.AssignOperations>
                          </ui:MultipleAssign>
                          <ui:LogMessage DisplayName="log_business_exception" sap:VirtualizedContainerService.HintSize="333.6,92.8" sap2010:WorkflowViewState.IdRef="LogMessage_74" Level="Error" Message="[excBusinessError.Source + &quot; -&gt; &quot; + excBusinessError.Message]">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                          </ui:LogMessage>
                          <ui:WriteTextFile DisplayName="stamp_exception" FileName="[_dicConfig(&quot;EXCEPTIONS&quot;).ToString + strExceptionName]" sap:VirtualizedContainerService.HintSize="333.6,134.4" sap2010:WorkflowViewState.IdRef="WriteTextFile_7" Text="[excBusinessError.Source +&quot; - &quot;+excBusinessError.ToString.Replace(Environment.NewLine.ToCharArray(),&quot; | &quot;).Replace(&quot;&quot;&quot;&quot;c,&quot;'&quot;)]" />
                        </Sequence>
                      </If.Then>
                      <If.Else>
                        <Sequence sap:VirtualizedContainerService.HintSize="200,83" sap2010:WorkflowViewState.IdRef="Sequence_112">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                        </Sequence>
                      </If.Else>
                    </If>
                    <If Condition="[excSystemError isNot Nothing]" DisplayName="if_sys_exception_exists" sap:VirtualizedContainerService.HintSize="858.4,1432.8" sap2010:WorkflowViewState.IdRef="If_36">
                      <If.Then>
                        <Sequence sap2010:Annotation.AnnotationText="1. Take screenshot&#xA;2. Stamp exception in EXCEPTION folder&#xA;3. Set variables to retry current state" DisplayName="handle_system_exception" sap:VirtualizedContainerService.HintSize="820,1253.6" sap2010:WorkflowViewState.IdRef="Sequence_108">
                          <Sequence.Variables>
                            <Variable x:TypeArguments="x:String" Name="strScreenshotName" />
                          </Sequence.Variables>
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                              <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <ui:LogMessage DisplayName="log_system_exception" sap:VirtualizedContainerService.HintSize="778.4,92.8" sap2010:WorkflowViewState.IdRef="LogMessage_75" Level="Error" Message="[excSystemError.Source + &quot; -&gt; &quot; + excSystemError.Message]">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                          </ui:LogMessage>
                          <ui:MultipleAssign DisplayName="assign_screenshot_name" sap:VirtualizedContainerService.HintSize="778.4,130.4" sap2010:WorkflowViewState.IdRef="MultipleAssign_15">
                            <ui:MultipleAssign.AssignOperations>
                              <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_32">
                                  <ui:AssignOperation.To>
                                    <OutArgument x:TypeArguments="x:String">[strExceptionName]</OutArgument>
                                  </ui:AssignOperation.To>
                                  <ui:AssignOperation.Value>
                                    <InArgument x:TypeArguments="x:String">[Now.ToString("yyyyMMdd_HHmmss")+"_exception_" + intRetryCounter.ToString + ".txt"]</InArgument>
                                  </ui:AssignOperation.Value>
                                </ui:AssignOperation>
                                <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_33">
                                  <ui:AssignOperation.To>
                                    <OutArgument x:TypeArguments="x:String">[strScreenshotName]</OutArgument>
                                  </ui:AssignOperation.To>
                                  <ui:AssignOperation.Value>
                                    <InArgument x:TypeArguments="x:String">[Now.ToString("yyyyMMdd_HHmmss") + "_screenshot_" + intRetryCounter.ToString + ".png"]</InArgument>
                                  </ui:AssignOperation.Value>
                                </ui:AssignOperation>
                              </scg:List>
                            </ui:MultipleAssign.AssignOperations>
                          </ui:MultipleAssign>
                          <ui:CommentOut DisplayName="Comment Out" sap:VirtualizedContainerService.HintSize="778.4,52.8" sap2010:WorkflowViewState.IdRef="CommentOut_13">
                            <ui:CommentOut.Body>
                              <Sequence DisplayName="Ignored Activities" sap:VirtualizedContainerService.HintSize="375.2,206.4" sap2010:WorkflowViewState.IdRef="Sequence_278">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="inv_utils_take_screenshot workflow" sap:VirtualizedContainerService.HintSize="333.6,113.6" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_26" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="wfs\_fmw\utils_take_screenshot.xaml">
                                  <ui:InvokeWorkflowFile.Arguments>
                                    <InArgument x:TypeArguments="x:String" x:Key="_strScreenshotFolder">[_dicConfig("EXCEPTIONS").ToString]</InArgument>
                                    <InArgument x:TypeArguments="x:String" x:Key="_strScreenshotName">[strScreenshotName]</InArgument>
                                  </ui:InvokeWorkflowFile.Arguments>
                                </ui:InvokeWorkflowFile>
                              </Sequence>
                            </ui:CommentOut.Body>
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                <x:Boolean x:Key="IsPinned">True</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                          </ui:CommentOut>
                          <ui:WriteTextFile DisplayName="stamp_exception" FileName="[_dicConfig(&quot;EXCEPTIONS&quot;).ToString + strExceptionName]" sap:VirtualizedContainerService.HintSize="778.4,134.4" sap2010:WorkflowViewState.IdRef="WriteTextFile_6" Text="[excSystemError.Source +&quot; - &quot;+excSystemError.ToString.Replace(Environment.NewLine.ToCharArray(),&quot; | &quot;).Replace(&quot;&quot;&quot;&quot;c,&quot;'&quot;)]" />
                          <If Condition="[intRetryCounter &lt; intMaxTryNumber]" DisplayName="if_sys_exception_and_retries_left" sap:VirtualizedContainerService.HintSize="778.4,530.4" sap2010:WorkflowViewState.IdRef="If_37">
                            <If.Then>
                              <Sequence DisplayName="log_and_update_variables" sap:VirtualizedContainerService.HintSize="400,371.333333333333" sap2010:WorkflowViewState.IdRef="Sequence_109">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <ui:MultipleAssign DisplayName="update_variables" sap:VirtualizedContainerService.HintSize="358,138" sap2010:WorkflowViewState.IdRef="MultipleAssign_16">
                                  <ui:MultipleAssign.AssignOperations>
                                    <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_35">
                                        <ui:AssignOperation.To>
                                          <OutArgument x:TypeArguments="s:Exception">[excSystemError]</OutArgument>
                                        </ui:AssignOperation.To>
                                        <ui:AssignOperation.Value>
                                          <InArgument x:TypeArguments="s:Exception">[Nothing]</InArgument>
                                        </ui:AssignOperation.Value>
                                      </ui:AssignOperation>
                                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_36">
                                        <ui:AssignOperation.To>
                                          <OutArgument x:TypeArguments="x:Int32">[intRetryCounter]</OutArgument>
                                        </ui:AssignOperation.To>
                                        <ui:AssignOperation.Value>
                                          <InArgument x:TypeArguments="x:Int32">[intRetryCounter + 1]</InArgument>
                                        </ui:AssignOperation.Value>
                                      </ui:AssignOperation>
                                    </scg:List>
                                  </ui:MultipleAssign.AssignOperations>
                                </ui:MultipleAssign>
                                <ui:LogMessage DisplayName="log_retrying" sap:VirtualizedContainerService.HintSize="358,103.333333333333" sap2010:WorkflowViewState.IdRef="LogMessage_72" Level="Info" Message="[&quot;Retrying process... &quot;+(intMaxTryNumber-intRetryCounter).ToString+&quot; retries left.&quot;]">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                </ui:LogMessage>
                              </Sequence>
                            </If.Then>
                            <If.Else>
                              <ui:LogMessage DisplayName="log_retries_maxed_out" sap:VirtualizedContainerService.HintSize="334,103.333333333333" sap2010:WorkflowViewState.IdRef="LogMessage_73" Level="Warn" Message="[&quot;Maximum retries number reached! Raising system exception&quot;]">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                              </ui:LogMessage>
                            </If.Else>
                          </If>
                        </Sequence>
                      </If.Then>
                    </If>
                    <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="ivk_utils_kill_apps" sap:VirtualizedContainerService.HintSize="858.666666666667,96.6666666666667" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_89" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="wfs\_utils\utils_kill_apps.xaml">
                      <ui:InvokeWorkflowFile.Arguments>
                        <InArgument x:TypeArguments="x:String" x:Key="_strApps">msedge.exe</InArgument>
                      </ui:InvokeWorkflowFile.Arguments>
                    </ui:InvokeWorkflowFile>
                    <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="ivk_utils_close_apps" sap:VirtualizedContainerService.HintSize="858.666666666667,96.6666666666667" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_27" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="wfs\_fmw\utils_close_apps.xaml">
                      <ui:InvokeWorkflowFile.Arguments>
                        <InArgument x:TypeArguments="x:Int32" x:Key="_intTimeoutClose">1</InArgument>
                      </ui:InvokeWorkflowFile.Arguments>
                    </ui:InvokeWorkflowFile>
                  </Sequence>
                </State.Entry>
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <av:Point x:Key="ShapeLocation">583.2,108.4</av:Point>
                    <av:Size x:Key="ShapeSize">151.333333333333,479.333333333333</av:Size>
                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    <x:Double x:Key="StateContainerWidth">117.60000000000014</x:Double>
                    <x:Double x:Key="StateContainerHeight">335.64000000000004</x:Double>
                    <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <State.Transitions>
                  <Transition DisplayName="Retry" sap:VirtualizedContainerService.HintSize="448.8,509.6" sap2010:WorkflowViewState.IdRef="Transition_21">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <av:PointCollection x:Key="ConnectorLocation">583.2,157.333333333333 553.2,157.333333333333 553.2,55.3 455,55.3</av:PointCollection>
                        <x:Int32 x:Key="SrcConnectionPointIndex">5</x:Int32>
                        <x:Int32 x:Key="DestConnectionPointIndex">12</x:Int32>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <Transition.To>
                      <x:Reference>__ReferenceID0</x:Reference>
                    </Transition.To>
                    <Transition.Condition>[excSystemError is Nothing and excBusinessError Is Nothing]</Transition.Condition>
                  </Transition>
                  <Transition DisplayName="report_error" sap:VirtualizedContainerService.HintSize="448.8,509.6" sap2010:WorkflowViewState.IdRef="Transition_22">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <av:PointCollection x:Key="ConnectorLocation">658.866666666667,587.733333333333 658.866666666667,773.4 457.333333333333,773.4</av:PointCollection>
                        <x:Int32 x:Key="SrcConnectionPointIndex">39</x:Int32>
                        <x:Int32 x:Key="DestConnectionPointIndex">44</x:Int32>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <Transition.To>
                      <x:Reference>__ReferenceID1</x:Reference>
                    </Transition.To>
                    <Transition.Condition>[excSystemError isNot Nothing or excBusinessError IsNot Nothing]</Transition.Condition>
                  </Transition>
                </State.Transitions>
                <State.Variables>
                  <Variable x:TypeArguments="x:String" Name="strExceptionName" />
                </State.Variables>
              </State>
            </Transition.To>
          </Transition>
          <Transition DisplayName="Success" sap:VirtualizedContainerService.HintSize="450,505" sap2010:WorkflowViewState.IdRef="Transition_30">
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Int32 x:Key="SrcConnectionPointIndex">57</x:Int32>
                <x:Int32 x:Key="DestConnectionPointIndex">29</x:Int32>
                <av:PointCollection x:Key="ConnectorLocation">245,107 215,107 215,196.1 245,196.1</av:PointCollection>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
            <Transition.Condition>[excSystemError is Nothing and excBusinessError is Nothing]</Transition.Condition>
            <Transition.To>
              <State x:Name="__ReferenceID4" sap2010:Annotation.AnnotationText="Process SAP Realize#" DisplayName="process_realize" sap:VirtualizedContainerService.HintSize="210,94" sap2010:WorkflowViewState.IdRef="State_19">
                <State.Entry>
                  <Sequence sap2010:Annotation.AnnotationText="When copying this state, the only modification to be made is changing the condition of the below IF statement to match the process number." DisplayName="process_current_state" sap:VirtualizedContainerService.HintSize="2308,11563.3333333333" sap2010:WorkflowViewState.IdRef="Sequence_102">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                        <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <If Condition="[_intRobotState = 2]" DisplayName="if_robot_state_is_this" sap:VirtualizedContainerService.HintSize="2266,11440.6666666667" sap2010:WorkflowViewState.IdRef="If_33">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <If.Then>
                        <TryCatch DisplayName="tc_process_current_state" sap:VirtualizedContainerService.HintSize="2229.33333333333,11258.6666666667" sap2010:WorkflowViewState.IdRef="TryCatch_17">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <TryCatch.Try>
                            <Sequence DisplayName="try_process_current_state2" sap:VirtualizedContainerService.HintSize="2190.66666666667,10657.3333333333" sap2010:WorkflowViewState.IdRef="Sequence_101">
                              <Sequence.Variables>
                                <Variable x:TypeArguments="sd:DataTable" Name="dtaWorktrayFiltered" />
                                <Variable x:TypeArguments="x:String" Name="strLastFolderName" />
                              </Sequence.Variables>
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <ui:LogMessage DisplayName="log_starting_state" sap:VirtualizedContainerService.HintSize="2148.66666666667,93.3333333333333" sap2010:WorkflowViewState.IdRef="LogMessage_68" Level="Info" Message="[&quot;--- Khởi tạo state: &quot;+ _intRobotState.ToString + &quot; ---&quot;]">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                              </ui:LogMessage>
                              <ui:FilterDataTable sap2010:Annotation.AnnotationText="filter criteria &quot;prepare&quot; = Inactive" DataTable="[dtaWorktray]" DisplayName="filter_dtaWorktray" FilterRowsMode="Keep" sap:VirtualizedContainerService.HintSize="2148.66666666667,192" sap2010:WorkflowViewState.IdRef="FilterDataTable_4" OutputDataTable="[dtaWorktrayFiltered]" SelectColumnsMode="Keep">
                                <ui:FilterDataTable.Filters>
                                  <scg:List x:TypeArguments="ui:FilterOperationArgument" Capacity="4">
                                    <ui:FilterOperationArgument BooleanOperator="And" Operator="CONTAINS">
                                      <ui:FilterOperationArgument.Column>
                                        <InArgument x:TypeArguments="x:String">["prepare"]</InArgument>
                                      </ui:FilterOperationArgument.Column>
                                      <ui:FilterOperationArgument.Operand>
                                        <InArgument x:TypeArguments="x:String">["Inactive"]</InArgument>
                                      </ui:FilterOperationArgument.Operand>
                                    </ui:FilterOperationArgument>
                                    <ui:FilterOperationArgument BooleanOperator="And" Operator="CONTAINS">
                                      <ui:FilterOperationArgument.Column>
                                        <InArgument x:TypeArguments="x:String">["file_type"]</InArgument>
                                      </ui:FilterOperationArgument.Column>
                                      <ui:FilterOperationArgument.Operand>
                                        <InArgument x:TypeArguments="x:String">["realize"]</InArgument>
                                      </ui:FilterOperationArgument.Operand>
                                    </ui:FilterOperationArgument>
                                  </scg:List>
                                </ui:FilterDataTable.Filters>
                                <ui:FilterDataTable.SelectColumns>
                                  <scg:List x:TypeArguments="InArgument" Capacity="4">
                                    <x:Null />
                                  </scg:List>
                                </ui:FilterDataTable.SelectColumns>
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                              </ui:FilterDataTable>
                              <If Condition="[dtaWorktrayFiltered.Rows.Count &gt; 0]" DisplayName="if_has_file_to_proceed" sap:VirtualizedContainerService.HintSize="2148.66666666667,9281.33333333333" sap2010:WorkflowViewState.IdRef="If_73">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <If.Then>
                                  <Sequence DisplayName="process_state_2" sap:VirtualizedContainerService.HintSize="1768.66666666667,9119.33333333333" sap2010:WorkflowViewState.IdRef="Sequence_239">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <ui:LogMessage DisplayName="log_info_start" sap:VirtualizedContainerService.HintSize="1726.66666666667,93.3333333333333" sap2010:WorkflowViewState.IdRef="LogMessage_104" Level="Info" Message="[&quot;State 2:  Bắt đầu bước tạo file import từ Realize Report...&quot;]">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                    </ui:LogMessage>
                                    <If Condition="[intRetryCounter &lt; intMaxTryNumber -1]" DisplayName="if_retry_max_times" sap:VirtualizedContainerService.HintSize="1726.66666666667,8894" sap2010:WorkflowViewState.IdRef="If_66">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <If.Then>
                                        <Sequence DisplayName="process_realize" sap:VirtualizedContainerService.HintSize="1280.66666666667,8732" sap2010:WorkflowViewState.IdRef="Sequence_218">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="ivk_GATES_login" sap:VirtualizedContainerService.HintSize="1238.66666666667,113.333333333333" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_46" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="wfs\gates\GATES_login.xaml">
                                            <ui:InvokeWorkflowFile.Arguments>
                                              <InArgument x:TypeArguments="x:String" x:Key="_strGatesLink">[_dicConfig("GATES_LINK").ToString]</InArgument>
                                              <InArgument x:TypeArguments="x:String" x:Key="_strCredential">[_dicConfig("GATES_CREDENTIALS").ToString]</InArgument>
                                            </ui:InvokeWorkflowFile.Arguments>
                                          </ui:InvokeWorkflowFile>
                                          <If Condition="[dicRealizeNumber is Nothing]" DisplayName="if_realize_list_is_not_initialized" sap:VirtualizedContainerService.HintSize="1238.66666666667,1872" sap2010:WorkflowViewState.IdRef="If_84">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <If.Then>
                                              <TryCatch DisplayName="tc_download_realize_report" sap:VirtualizedContainerService.HintSize="548,1710" sap2010:WorkflowViewState.IdRef="TryCatch_19">
                                                <TryCatch.Try>
                                                  <Sequence DisplayName="try_download_realize_report" sap:VirtualizedContainerService.HintSize="403.333333333333,993.333333333333" sap2010:WorkflowViewState.IdRef="Sequence_266">
                                                    <Sequence.Variables>
                                                      <Variable x:TypeArguments="x:String" Name="strSalesDeliveryReport" />
                                                    </Sequence.Variables>
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="ivk_GATES_navigation" sap:VirtualizedContainerService.HintSize="361.333333333333,113.333333333333" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_47" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="wfs\gates\GATES_navigation.xaml">
                                                      <ui:InvokeWorkflowFile.Arguments>
                                                        <InArgument x:TypeArguments="x:String" x:Key="_strTransactionCode">[_dicConfig("DELIVERY_POSTING_TX").ToString]</InArgument>
                                                        <InArgument x:TypeArguments="x:Boolean" x:Key="_boolClosingWindow">False</InArgument>
                                                      </ui:InvokeWorkflowFile.Arguments>
                                                    </ui:InvokeWorkflowFile>
                                                    <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="ivk_GATES_download_Sales_Delivery" sap:VirtualizedContainerService.HintSize="361.333333333333,113.333333333333" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_48" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="wfs\gates\GATES_download_Sales_Delivery.xaml">
                                                      <ui:InvokeWorkflowFile.Arguments>
                                                        <InArgument x:TypeArguments="s:DateTime" x:Key="_dtiProcess">[dtiProcess]</InArgument>
                                                        <InArgument x:TypeArguments="x:String" x:Key="_strCompanyCode">[_dicConfig("COMPANY_CODE").ToString]</InArgument>
                                                        <InArgument x:TypeArguments="x:String" x:Key="_strDownloadFolder">[_dicConfig("DOWNLOAD_FOLDER").ToString]</InArgument>
                                                        <InArgument x:TypeArguments="x:String" x:Key="_strProcessFolder">[_dicConfig("REPORT_FOLDER").ToString]</InArgument>
                                                        <OutArgument x:TypeArguments="x:String" x:Key="_strSalesDeliveryReport">[strSalesDeliveryReport]</OutArgument>
                                                      </ui:InvokeWorkflowFile.Arguments>
                                                    </ui:InvokeWorkflowFile>
                                                    <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="ivk_excel_get_realize_list" sap:VirtualizedContainerService.HintSize="361.333333333333,113.333333333333" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_49" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="wfs\excel\excel_get_realize_list.xaml">
                                                      <ui:InvokeWorkflowFile.Arguments>
                                                        <InArgument x:TypeArguments="s:DateTime" x:Key="_dtiProcess">[dtiProcess]</InArgument>
                                                        <InArgument x:TypeArguments="x:String" x:Key="_strRealizeReport">[strSalesDeliveryReport]</InArgument>
                                                        <InArgument x:TypeArguments="x:String" x:Key="_strBacklogReport">[Path.Combine(_dicConfig("INPUTS").ToString, _dicConfig("BACKLOG_FILE").ToString)]</InArgument>
                                                        <OutArgument x:TypeArguments="scg:Dictionary(x:String, x:Boolean)" x:Key="_dicRealizeNumber">[dicRealizeNumber]</OutArgument>
                                                      </ui:InvokeWorkflowFile.Arguments>
                                                    </ui:InvokeWorkflowFile>
                                                    <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="ivk_excel_sync_BL&amp;GI_realize" sap:VirtualizedContainerService.HintSize="361.333333333333,113.333333333333" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_93" UnSafe="False" WorkflowFileName="wfs\excel\excel_sync_BL&amp;GI_realize.xaml">
                                                      <ui:InvokeWorkflowFile.Arguments>
                                                        <InArgument x:TypeArguments="x:String" x:Key="_strSalesDeliveryReport">[strSalesDeliveryReport]</InArgument>
                                                      </ui:InvokeWorkflowFile.Arguments>
                                                    </ui:InvokeWorkflowFile>
                                                    <ui:ReadRange Range="{x:Null}" AddHeaders="True" DataTable="[dtaRealize]" DisplayName="rr_realize_list" sap:VirtualizedContainerService.HintSize="361.333333333333,86.6666666666667" sap2010:WorkflowViewState.IdRef="ReadRange_6" SheetName="Sheet1" WorkbookPath="[strSalesDeliveryReport]" />
                                                    <ui:FilterDataTable DataTable="[dtaRealize]" DisplayName="filter_relevant_realize" FilterRowsMode="Keep" sap:VirtualizedContainerService.HintSize="361.333333333333,161.333333333333" sap2010:WorkflowViewState.IdRef="FilterDataTable_5" OutputDataTable="[dtaRealize]" SelectColumnsMode="Keep">
                                                      <ui:FilterDataTable.Filters>
                                                        <scg:List x:TypeArguments="ui:FilterOperationArgument" Capacity="4">
                                                          <ui:FilterOperationArgument BooleanOperator="And" Operator="EQ">
                                                            <ui:FilterOperationArgument.Column>
                                                              <InArgument x:TypeArguments="x:String">["Document category"]</InArgument>
                                                            </ui:FilterOperationArgument.Column>
                                                            <ui:FilterOperationArgument.Operand>
                                                              <InArgument x:TypeArguments="x:String">["BL"]</InArgument>
                                                            </ui:FilterOperationArgument.Operand>
                                                          </ui:FilterOperationArgument>
                                                          <ui:FilterOperationArgument BooleanOperator="And" Operator="EQ">
                                                            <ui:FilterOperationArgument.Column>
                                                              <InArgument x:TypeArguments="x:String">["Currency"]</InArgument>
                                                            </ui:FilterOperationArgument.Column>
                                                            <ui:FilterOperationArgument.Operand>
                                                              <InArgument x:TypeArguments="x:String">["VND"]</InArgument>
                                                            </ui:FilterOperationArgument.Operand>
                                                          </ui:FilterOperationArgument>
                                                          <ui:FilterOperationArgument BooleanOperator="And" Operator="NOTEQ">
                                                            <ui:FilterOperationArgument.Column>
                                                              <InArgument x:TypeArguments="x:String">["Qty in unit of entry"]</InArgument>
                                                            </ui:FilterOperationArgument.Column>
                                                            <ui:FilterOperationArgument.Operand>
                                                              <InArgument x:TypeArguments="x:Int32">[0]</InArgument>
                                                            </ui:FilterOperationArgument.Operand>
                                                          </ui:FilterOperationArgument>
                                                        </scg:List>
                                                      </ui:FilterDataTable.Filters>
                                                      <ui:FilterDataTable.SelectColumns>
                                                        <scg:List x:TypeArguments="InArgument" Capacity="4">
                                                          <x:Null />
                                                        </scg:List>
                                                      </ui:FilterDataTable.SelectColumns>
                                                    </ui:FilterDataTable>
                                                  </Sequence>
                                                </TryCatch.Try>
                                                <TryCatch.Catches>
                                                  <Catch x:TypeArguments="ui:BusinessRuleException" sap:VirtualizedContainerService.HintSize="514,293.333333333333" sap2010:WorkflowViewState.IdRef="Catch`1_35">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <ActivityAction x:TypeArguments="ui:BusinessRuleException">
                                                      <ActivityAction.Argument>
                                                        <DelegateInArgument x:TypeArguments="ui:BusinessRuleException" Name="br_exc" />
                                                      </ActivityAction.Argument>
                                                      <If Condition="[br_exc.Message = &quot;no_realize_data&quot;]" DisplayName="catch_br_exce_no_realize_data" sap:VirtualizedContainerService.HintSize="508,223.333333333333" sap2010:WorkflowViewState.IdRef="If_83">
                                                        <If.Then>
                                                          <Assign DisplayName="init_dicRealize" sap:VirtualizedContainerService.HintSize="262,61.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_164">
                                                            <Assign.To>
                                                              <OutArgument x:TypeArguments="scg:Dictionary(x:String, x:Boolean)">[dicRealizeNumber]</OutArgument>
                                                            </Assign.To>
                                                            <Assign.Value>
                                                              <InArgument x:TypeArguments="scg:Dictionary(x:String, x:Boolean)">[new Dictionary(of String, Boolean)]</InArgument>
                                                            </Assign.Value>
                                                          </Assign>
                                                        </If.Then>
                                                        <If.Else>
                                                          <Rethrow sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Rethrow_1" />
                                                        </If.Else>
                                                      </If>
                                                    </ActivityAction>
                                                  </Catch>
                                                  <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="514,104.666666666667" sap2010:WorkflowViewState.IdRef="Catch`1_36">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <ActivityAction x:TypeArguments="s:Exception">
                                                      <ActivityAction.Argument>
                                                        <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                      </ActivityAction.Argument>
                                                      <Rethrow sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Rethrow_2" />
                                                    </ActivityAction>
                                                  </Catch>
                                                </TryCatch.Catches>
                                              </TryCatch>
                                            </If.Then>
                                            <If.Else>
                                              <ui:LogMessage DisplayName="log_progress" sap:VirtualizedContainerService.HintSize="334,93.3333333333333" sap2010:WorkflowViewState.IdRef="LogMessage_128" Level="Info" Message="[&quot;Đã xử lý phần download báo cáo Realization List...&quot;]" />
                                            </If.Else>
                                          </If>
                                          <If Condition="[dicRealizeNumber.Count &gt; 0]" DisplayName="if_realize_list_has_values" sap:VirtualizedContainerService.HintSize="1238.66666666667,6411.33333333333" sap2010:WorkflowViewState.IdRef="If_92">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <If.Then>
                                              <ui:ForEach x:TypeArguments="scg:KeyValuePair(x:String, x:Boolean)" CurrentIndex="{x:Null}" DisplayName="fe_realize_number" sap:VirtualizedContainerService.HintSize="858.666666666667,6249.33333333333" sap2010:WorkflowViewState.IdRef="ForEach`1_20" Values="[dicRealizeNumber]">
                                                <ui:ForEach.Body>
                                                  <ActivityAction x:TypeArguments="scg:KeyValuePair(x:String, x:Boolean)">
                                                    <ActivityAction.Argument>
                                                      <DelegateInArgument x:TypeArguments="scg:KeyValuePair(x:String, x:Boolean)" Name="realize" />
                                                    </ActivityAction.Argument>
                                                    <Sequence DisplayName="process_realize_mapping" sap:VirtualizedContainerService.HintSize="822,6122.66666666667" sap2010:WorkflowViewState.IdRef="Sequence_276">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <If Condition="[dtaTracking.AsEnumerable.Any(Function (a) a(&quot;state&quot;).ToString = &quot;Prepare&quot; AndAlso a(&quot;request&quot;).ToString = realize.Key)]" DisplayName="check_realize_proceeded" sap:VirtualizedContainerService.HintSize="780,409.333333333333" sap2010:WorkflowViewState.IdRef="If_85">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <If.Then>
                                                          <Sequence DisplayName="log_and_continue" sap:VirtualizedContainerService.HintSize="376,247.333333333333" sap2010:WorkflowViewState.IdRef="Sequence_267">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <ui:LogMessage DisplayName="log_processed" sap:VirtualizedContainerService.HintSize="334,93.3333333333333" sap2010:WorkflowViewState.IdRef="LogMessage_129" Level="Info" Message="[&quot;Số realize &quot; &amp; realize.Key  &amp; &quot; đã được xử lý trước đó...&quot;]" />
                                                            <ui:Continue DisplayName="Continue" sap:VirtualizedContainerService.HintSize="334,22" sap2010:WorkflowViewState.IdRef="Continue_15" />
                                                          </Sequence>
                                                        </If.Then>
                                                        <If.Else>
                                                          <ui:LogMessage DisplayName="log_process_as_new" sap:VirtualizedContainerService.HintSize="334,93.3333333333333" sap2010:WorkflowViewState.IdRef="LogMessage_130" Level="Info" Message="[&quot;Kiểm tra &amp; xử lý realize &quot; &amp; realize.Key  &amp; &quot;...&quot;]" />
                                                        </If.Else>
                                                      </If>
                                                      <If Condition="[realize.value = True]" DisplayName="check_realize_in_backlog" sap:VirtualizedContainerService.HintSize="780,792" sap2010:WorkflowViewState.IdRef="If_86">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <If.Then>
                                                          <ui:LogMessage DisplayName="log_progress" sap:VirtualizedContainerService.HintSize="334,93.3333333333333" sap2010:WorkflowViewState.IdRef="LogMessage_131" Level="Info" Message="[&quot;Realize &quot; &amp; realize.Key &amp; &quot; chưa có trong Backlog. Tiến hành xử lý realize và xuất file import Thái Sơn...&quot;]" />
                                                        </If.Then>
                                                        <If.Else>
                                                          <Sequence DisplayName="log_and_continue" sap:VirtualizedContainerService.HintSize="376,630" sap2010:WorkflowViewState.IdRef="Sequence_268">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <ui:LogMessage DisplayName="log_progress" sap:VirtualizedContainerService.HintSize="334,93.3333333333333" sap2010:WorkflowViewState.IdRef="LogMessage_132" Level="Info" Message="[&quot;Realize &quot; &amp; realize.Key &amp; &quot; đã được xử lý và ghi lại trong Backlog trước đó. Thực hiện realize kế tiếp...&quot;]" />
                                                            <ui:AddDataRow DataRow="{x:Null}" ArrayRow="[{&quot;Prepare&quot;, realize.Key, &quot;&quot;, &quot;Tạo file import&quot;, &quot;NG&quot;, &quot;Realize đã được xử lý và xuất hóa đơn trước đó&quot;}]" DataTable="[dtaTracking]" DisplayName="adr__dtaTracking" sap:VirtualizedContainerService.HintSize="334,188" sap2010:WorkflowViewState.IdRef="AddDataRow_1" />
                                                            <ui:WriteRange StartingCell="{x:Null}" AddHeaders="True" DataTable="[dtaTracking]" DisplayName="wr_bench" sap:VirtualizedContainerService.HintSize="334,114.666666666667" sap2010:WorkflowViewState.IdRef="WriteRange_9" SheetName="workbench" WorkbookPath="[Path.Combine(environment.CurrentDirectory,_dicConfig(&quot;PROCESS_DATA&quot;).ToString, _dicConfig(&quot;WORKTRAY_FILE&quot;).ToString)]">
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                            </ui:WriteRange>
                                                            <ui:Continue sap:VirtualizedContainerService.HintSize="334,22" sap2010:WorkflowViewState.IdRef="Continue_16" />
                                                          </Sequence>
                                                        </If.Else>
                                                      </If>
                                                      <If Condition="[dtaCustomerDefinition is Nothing]" DisplayName="is_dtaCustomerDefinition_valid" sap:VirtualizedContainerService.HintSize="780,816.666666666667" sap2010:WorkflowViewState.IdRef="If_87">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <If.Then>
                                                          <Sequence DisplayName="build_dtaCustomerDefinition" sap:VirtualizedContainerService.HintSize="476,634.666666666667" sap2010:WorkflowViewState.IdRef="Sequence_269">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <ui:ReadRange Range="{x:Null}" AddHeaders="True" DataTable="[dtaCustomerDefinition]" DisplayName="rr_customer_definition_list" sap:VirtualizedContainerService.HintSize="434,86.6666666666667" sap2010:WorkflowViewState.IdRef="ReadRange_7" SheetName="definition" WorkbookPath="[Path.Combine(_dicConfig(&quot;INPUTS&quot;).ToString, _dicConfig(&quot;CUSTOMER_DEFINITION_FILE&quot;).ToString)]" />
                                                            <ui:AddDataColumn x:TypeArguments="x:String" AllowDBNull="{x:Null}" AutoIncrement="{x:Null}" Column="{x:Null}" DefaultValue="{x:Null}" MaxLength="{x:Null}" Unique="{x:Null}" ColumnName="Key" DataTable="[dtaCustomerDefinition]" DisplayName="adc_BP&amp;ProfitCenter" sap:VirtualizedContainerService.HintSize="434,188" sap2010:WorkflowViewState.IdRef="AddDataColumn`1_1" />
                                                            <ui:ForEach x:TypeArguments="sd:DataRow" CurrentIndex="{x:Null}" DisplayName="fer__dtaCustomerDefinition" sap:VirtualizedContainerService.HintSize="434,188" sap2010:WorkflowViewState.IdRef="ForEach`1_19" Values="[dtaCustomerDefinition.Rows]">
                                                              <ui:ForEach.Body>
                                                                <ActivityAction x:TypeArguments="sd:DataRow">
                                                                  <ActivityAction.Argument>
                                                                    <DelegateInArgument x:TypeArguments="sd:DataRow" Name="row" />
                                                                  </ActivityAction.Argument>
                                                                  <Assign sap:VirtualizedContainerService.HintSize="262,61.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_181">
                                                                    <Assign.To>
                                                                      <OutArgument x:TypeArguments="x:Object">[row("Key")]</OutArgument>
                                                                    </Assign.To>
                                                                    <Assign.Value>
                                                                      <InArgument x:TypeArguments="x:String">[row("Segment (Gates)").ToString &amp; row("Mã khách hàng").ToString]</InArgument>
                                                                    </Assign.Value>
                                                                  </Assign>
                                                                </ActivityAction>
                                                              </ui:ForEach.Body>
                                                            </ui:ForEach>
                                                          </Sequence>
                                                        </If.Then>
                                                        <If.Else>
                                                          <Sequence sap2010:WorkflowViewState.IdRef="Sequence_270">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                          </Sequence>
                                                        </If.Else>
                                                      </If>
                                                      <If Condition="[dtaConversion is Nothing]" DisplayName="is_dtaConversion_valid" sap:VirtualizedContainerService.HintSize="780,268.666666666667" sap2010:WorkflowViewState.IdRef="If_114">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <If.Then>
                                                          <ui:ReadRange Range="{x:Null}" AddHeaders="True" DataTable="[dtaConversion]" DisplayName="rr_customer_definition_list" sap:VirtualizedContainerService.HintSize="334,86.6666666666667" sap2010:WorkflowViewState.IdRef="ReadRange_18" SheetName="conversion" WorkbookPath="[Path.Combine(_dicConfig(&quot;INPUTS&quot;).ToString, _dicConfig(&quot;CUSTOMER_DEFINITION_FILE&quot;).ToString)]" />
                                                        </If.Then>
                                                        <If.Else>
                                                          <Sequence sap2010:WorkflowViewState.IdRef="Sequence_315">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                          </Sequence>
                                                        </If.Else>
                                                      </If>
                                                      <If Condition="[dtaSpecialItems is Nothing]" DisplayName="is_dtaSpecialItems_valid" sap:VirtualizedContainerService.HintSize="780,268.666666666667" sap2010:WorkflowViewState.IdRef="If_88">
                                                        <If.Then>
                                                          <ui:ReadRange Range="{x:Null}" AddHeaders="True" DataTable="[dtaSpecialItems]" DisplayName="rr_special_list" sap:VirtualizedContainerService.HintSize="334,86.6666666666667" sap2010:WorkflowViewState.IdRef="ReadRange_8" SheetName="material_conversion" WorkbookPath="[Path.Combine(_dicConfig(&quot;INPUTS&quot;).ToString, _dicConfig(&quot;SPECIAL_FILE&quot;).ToString)]" />
                                                        </If.Then>
                                                        <If.Else>
                                                          <Sequence sap2010:WorkflowViewState.IdRef="Sequence_271">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                          </Sequence>
                                                        </If.Else>
                                                      </If>
                                                      <If Condition="[dtaVATReport is Nothing]" DisplayName="is_vat_report_downloaded" sap:VirtualizedContainerService.HintSize="780,667.333333333333" sap2010:WorkflowViewState.IdRef="If_89">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <If.Then>
                                                          <Sequence DisplayName="download_VAT_report" sap:VirtualizedContainerService.HintSize="386.666666666667,485.333333333333" sap2010:WorkflowViewState.IdRef="Sequence_272">
                                                            <Sequence.Variables>
                                                              <Variable x:TypeArguments="x:String" Name="strVATReport" />
                                                            </Sequence.Variables>
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="ivk_GATES_navigation" sap:VirtualizedContainerService.HintSize="344.666666666667,113.333333333333" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_50" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="wfs\gates\GATES_navigation.xaml">
                                                              <ui:InvokeWorkflowFile.Arguments>
                                                                <InArgument x:TypeArguments="x:String" x:Key="_strTransactionCode">[_dicConfig("VAT_REPORT_TX").ToString]</InArgument>
                                                                <InArgument x:TypeArguments="x:Boolean" x:Key="_boolClosingWindow">False</InArgument>
                                                              </ui:InvokeWorkflowFile.Arguments>
                                                            </ui:InvokeWorkflowFile>
                                                            <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="ivk_GATES_download_VAT_report" sap:VirtualizedContainerService.HintSize="344.666666666667,113.333333333333" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_51" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="wfs\gates\GATES_download_VAT_report.xaml">
                                                              <ui:InvokeWorkflowFile.Arguments>
                                                                <InArgument x:TypeArguments="x:String" x:Key="_strCompanyCode">[_dicConfig("COMPANY_CODE").ToString]</InArgument>
                                                                <InArgument x:TypeArguments="s:DateTime" x:Key="_dtiProcess">[dtiProcess]</InArgument>
                                                                <InArgument x:TypeArguments="x:String" x:Key="_strDownloadFolder">[_dicConfig("DOWNLOAD_FOLDER").ToString]</InArgument>
                                                                <InArgument x:TypeArguments="x:String" x:Key="_strProcessFolder">[_dicConfig("REPORT_FOLDER").ToString]</InArgument>
                                                                <OutArgument x:TypeArguments="x:String" x:Key="_strVATReportPath">[strVATReport]</OutArgument>
                                                              </ui:InvokeWorkflowFile.Arguments>
                                                            </ui:InvokeWorkflowFile>
                                                            <ui:ReadRange Range="{x:Null}" AddHeaders="True" DataTable="[dtaVATReport]" DisplayName="rr_vat_report" sap:VirtualizedContainerService.HintSize="344.666666666667,86.6666666666667" sap2010:WorkflowViewState.IdRef="ReadRange_9" SheetName="Sheet1" WorkbookPath="[strVATReport]" />
                                                          </Sequence>
                                                        </If.Then>
                                                      </If>
                                                      <If Condition="[dtaMaterialMaster is Nothing]" DisplayName="is_material_master_downloaded" sap:VirtualizedContainerService.HintSize="780,1218.66666666667" sap2010:WorkflowViewState.IdRef="If_90">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <If.Then>
                                                          <Sequence DisplayName="download_material_master" sap:VirtualizedContainerService.HintSize="476,1036.66666666667" sap2010:WorkflowViewState.IdRef="Sequence_274">
                                                            <Sequence.Variables>
                                                              <Variable x:TypeArguments="ui:WorkbookApplication" Name="wb" />
                                                              <Variable x:TypeArguments="x:String" Name="strMaterialMaster" />
                                                            </Sequence.Variables>
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="ivk_GATES_navigation" sap:VirtualizedContainerService.HintSize="434,113.333333333333" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_52" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="wfs\gates\GATES_navigation.xaml">
                                                              <ui:InvokeWorkflowFile.Arguments>
                                                                <InArgument x:TypeArguments="x:String" x:Key="_strTransactionCode">[_dicConfig("MATERIAL_MASTER_TX").ToString]</InArgument>
                                                                <InArgument x:TypeArguments="x:Boolean" x:Key="_boolClosingWindow">False</InArgument>
                                                              </ui:InvokeWorkflowFile.Arguments>
                                                            </ui:InvokeWorkflowFile>
                                                            <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="ivk_GATES_download_Material_Master" sap:VirtualizedContainerService.HintSize="434,113.333333333333" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_53" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="wfs\gates\GATES_download_Material_Master.xaml">
                                                              <ui:InvokeWorkflowFile.Arguments>
                                                                <InArgument x:TypeArguments="s:DateTime" x:Key="_dtiProcess">[dtiProcess]</InArgument>
                                                                <InArgument x:TypeArguments="x:String" x:Key="_strCompanyCode">[_dicConfig("COMPANY_CODE").ToString]</InArgument>
                                                                <InArgument x:TypeArguments="x:String" x:Key="_strDownloadFolder">[_dicConfig("DOWNLOAD_FOLDER").ToString]</InArgument>
                                                                <InArgument x:TypeArguments="x:String" x:Key="_strProcessFolder">[_dicConfig("REPORT_FOLDER").ToString]</InArgument>
                                                                <OutArgument x:TypeArguments="x:String" x:Key="_strMaterialMasterReport">[strMaterialMaster]</OutArgument>
                                                              </ui:InvokeWorkflowFile.Arguments>
                                                            </ui:InvokeWorkflowFile>
                                                            <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="ivk_excel_kill" sap:VirtualizedContainerService.HintSize="434,113.333333333333" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_54" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="wfs\excel\excel_kill.xaml">
                                                              <ui:InvokeWorkflowFile.Arguments>
                                                                <scg:Dictionary x:TypeArguments="x:String, Argument" />
                                                              </ui:InvokeWorkflowFile.Arguments>
                                                            </ui:InvokeWorkflowFile>
                                                            <ui:ExcelApplicationScope Password="{x:Null}" AutoSave="False" CreateNewFile="False" DisplayName="eac_material_master" sap:VirtualizedContainerService.HintSize="434,484.666666666667" sap2010:WorkflowViewState.IdRef="ExcelApplicationScope_1" InstanceCachePeriod="0" Visible="False" Workbook="[wb]" WorkbookPath="[strMaterialMaster]">
                                                              <ui:ExcelApplicationScope.Body>
                                                                <ActivityAction x:TypeArguments="ui:WorkbookApplication">
                                                                  <ActivityAction.Argument>
                                                                    <DelegateInArgument x:TypeArguments="ui:WorkbookApplication" Name="ExcelWorkbookScope" />
                                                                  </ActivityAction.Argument>
                                                                  <Sequence DisplayName="read_datatable" sap:VirtualizedContainerService.HintSize="376,376" sap2010:WorkflowViewState.IdRef="Sequence_273">
                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                      </scg:Dictionary>
                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                    <ui:InvokeVBA OutputValue="{x:Null}" CodeFilePath="wfs\vba\delete_duplicate_column.bas" DisplayName="ivk_vba_delete_duplicate_column" EntryMethodName="Main" sap:VirtualizedContainerService.HintSize="334,86.6666666666667" sap2010:WorkflowViewState.IdRef="InvokeVBA_1" />
                                                                    <ui:ExcelReadRange AddHeaders="True" DataTable="[dtaMaterialMaster]" DisplayName="rr_dtaMaterialMaster" sap:VirtualizedContainerService.HintSize="334,58.6666666666667" sap2010:WorkflowViewState.IdRef="ExcelReadRange_1" SheetName="Sheet1">
                                                                      <ui:ExcelReadRange.Range>
                                                                        <InArgument x:TypeArguments="x:String">
                                                                          <Literal x:TypeArguments="x:String" Value="" />
                                                                        </InArgument>
                                                                      </ui:ExcelReadRange.Range>
                                                                    </ui:ExcelReadRange>
                                                                    <ui:ExcelCloseWorkbook DisplayName="close_wb" sap:VirtualizedContainerService.HintSize="334,58.6666666666667" sap2010:WorkflowViewState.IdRef="ExcelCloseWorkbook_1" Workbook="[wb]" />
                                                                  </Sequence>
                                                                </ActivityAction>
                                                              </ui:ExcelApplicationScope.Body>
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                            </ui:ExcelApplicationScope>
                                                          </Sequence>
                                                        </If.Then>
                                                      </If>
                                                      <If Condition="[dtaGrossProfit  is Nothing]" DisplayName="is_gross_profit_downloaded" sap:VirtualizedContainerService.HintSize="780,667.333333333333" sap2010:WorkflowViewState.IdRef="If_91">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <If.Then>
                                                          <Sequence DisplayName="download_gross_profit" sap:VirtualizedContainerService.HintSize="392.666666666667,485.333333333333" sap2010:WorkflowViewState.IdRef="Sequence_275">
                                                            <Sequence.Variables>
                                                              <Variable x:TypeArguments="x:String" Name="strGrossProfitBOList" />
                                                            </Sequence.Variables>
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="ivk_GATES_navigate_DataAnalysis" sap:VirtualizedContainerService.HintSize="350.666666666667,113.333333333333" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_55" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="wfs\gates\GATES_navigate_DataAnalysis.xaml">
                                                              <ui:InvokeWorkflowFile.Arguments>
                                                                <scg:Dictionary x:TypeArguments="x:String, Argument" />
                                                              </ui:InvokeWorkflowFile.Arguments>
                                                            </ui:InvokeWorkflowFile>
                                                            <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="ivk_GATES_download_Gross_Profit" sap:VirtualizedContainerService.HintSize="350.666666666667,113.333333333333" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_56" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="wfs\gates\GATES_download_Gross_Profit.xaml">
                                                              <ui:InvokeWorkflowFile.Arguments>
                                                                <OutArgument x:TypeArguments="x:String" x:Key="_strGrossProfitBO">[strGrossProfitBOList]</OutArgument>
                                                                <InArgument x:TypeArguments="s:DateTime" x:Key="_dtiProcess">[dtiProcess]</InArgument>
                                                                <InArgument x:TypeArguments="x:String" x:Key="_strCompanyCode">[_dicConfig("COMPANY_CODE").ToString]</InArgument>
                                                                <InArgument x:TypeArguments="x:String" x:Key="_strDownloadFolder">[_dicConfig("DOWNLOAD_FOLDER").ToString]</InArgument>
                                                                <InArgument x:TypeArguments="x:String" x:Key="_strProcessFolder">[_dicConfig("REPORT_FOLDER").ToString]</InArgument>
                                                              </ui:InvokeWorkflowFile.Arguments>
                                                            </ui:InvokeWorkflowFile>
                                                            <ui:ReadRange AddHeaders="True" DataTable="[dtaGrossProfit]" DisplayName="rr_GrossProfit" sap:VirtualizedContainerService.HintSize="350.666666666667,86.6666666666667" sap2010:WorkflowViewState.IdRef="ReadRange_10" Range="B2" SheetName="Gross Profit List" WorkbookPath="[strGrossProfitBOList]" />
                                                          </Sequence>
                                                        </If.Then>
                                                      </If>
                                                      <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="ivk_excel_create_import_file" sap:VirtualizedContainerService.HintSize="780,113.333333333333" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_77" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="wfs\excel\excel_create_realize_import_new.xaml">
                                                        <ui:InvokeWorkflowFile.Arguments>
                                                          <InArgument x:TypeArguments="s:DateTime" x:Key="_dtiProcess">[dtiProcess]</InArgument>
                                                          <InArgument x:TypeArguments="x:String" x:Key="_strRealizeNumber">[realize.Key]</InArgument>
                                                          <InArgument x:TypeArguments="x:String" x:Key="_strTemplatePath">[Path.Combine(_dicConfig("INPUTS").ToString, _dicConfig("TEMPLATE_FILE").ToString)]</InArgument>
                                                          <InArgument x:TypeArguments="x:String" x:Key="_strUploadFolder">[_dicConfig("UPLOAD_FOLDER").ToString]</InArgument>
                                                          <InOutArgument x:TypeArguments="sd:DataTable" x:Key="_dtaTracking">[dtaTracking]</InOutArgument>
                                                          <InArgument x:TypeArguments="sd:DataTable" x:Key="_dtaCustomerDefinition">[dtaCustomerDefinition]</InArgument>
                                                          <InArgument x:TypeArguments="sd:DataTable" x:Key="_dtaConversion">[dtaConversion]</InArgument>
                                                          <InArgument x:TypeArguments="sd:DataTable" x:Key="_dtaSpecialItems">[dtaSpecialItems]</InArgument>
                                                          <InArgument x:TypeArguments="sd:DataTable" x:Key="_dtaRealize">[dtaRealize]</InArgument>
                                                          <InArgument x:TypeArguments="sd:DataTable" x:Key="_dtaVATReport">[dtaVATReport]</InArgument>
                                                          <InArgument x:TypeArguments="sd:DataTable" x:Key="_dtaMaterialMaster">[dtaMaterialMaster]</InArgument>
                                                          <InArgument x:TypeArguments="sd:DataTable" x:Key="_dtaGrossProfit">[dtaGrossProfit]</InArgument>
                                                          <InArgument x:TypeArguments="x:String" x:Key="_strWorktray">[Path.Combine(environment.CurrentDirectory,_dicConfig("PROCESS_DATA").ToString, _dicConfig("WORKTRAY_FILE").ToString)]</InArgument>
                                                        </ui:InvokeWorkflowFile.Arguments>
                                                      </ui:InvokeWorkflowFile>
                                                      <ui:CommentOut DisplayName="Comment Out" sap:VirtualizedContainerService.HintSize="780,284" sap2010:WorkflowViewState.IdRef="CommentOut_15">
                                                        <ui:CommentOut.Body>
                                                          <Sequence DisplayName="Ignored Activities" sap:VirtualizedContainerService.HintSize="395.333333333333,205.333333333333" sap2010:WorkflowViewState.IdRef="Sequence_318">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="ivk_excel_create_import_file" sap:VirtualizedContainerService.HintSize="353.333333333333,113.333333333333" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_57" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="wfs\excel\excel_create_realize_import_file.xaml">
                                                              <ui:InvokeWorkflowFile.Arguments>
                                                                <InArgument x:TypeArguments="x:String" x:Key="_strRealizeNumber">[realize.Key]</InArgument>
                                                                <InArgument x:TypeArguments="x:String" x:Key="_strTemplatePath">[Path.Combine(_dicConfig("INPUTS").ToString, _dicConfig("TEMPLATE_FILE").ToString)]</InArgument>
                                                                <InArgument x:TypeArguments="x:String" x:Key="_strUploadFolder">[_dicConfig("UPLOAD_FOLDER").ToString]</InArgument>
                                                                <InArgument x:TypeArguments="sd:DataTable" x:Key="_dtaVATReport">[dtaVATReport]</InArgument>
                                                                <InArgument x:TypeArguments="sd:DataTable" x:Key="_dtaMaterialMaster">[dtaMaterialMaster]</InArgument>
                                                                <InArgument x:TypeArguments="sd:DataTable" x:Key="_dtaGrossProfit">[dtaGrossProfit]</InArgument>
                                                                <InArgument x:TypeArguments="sd:DataTable" x:Key="_dtaRealize">[dtaRealize]</InArgument>
                                                                <InArgument x:TypeArguments="s:DateTime" x:Key="_dtiProcess">[dtiProcess]</InArgument>
                                                                <InArgument x:TypeArguments="x:String" x:Key="_strInvoiceDateFormat">[_dicConfig("INVOICE_DATE_FORMAT").ToString]</InArgument>
                                                                <InArgument x:TypeArguments="sd:DataTable" x:Key="_dtaSpecialItems">[dtaSpecialItems]</InArgument>
                                                                <InArgument x:TypeArguments="sd:DataTable" x:Key="_dtaCustomerDefinition">[dtaCustomerDefinition]</InArgument>
                                                                <InOutArgument x:TypeArguments="sd:DataTable" x:Key="_dtaTracking">[dtaTracking]</InOutArgument>
                                                                <InArgument x:TypeArguments="sd:DataTable" x:Key="_dtaConversion">[dtaConversion]</InArgument>
                                                              </ui:InvokeWorkflowFile.Arguments>
                                                            </ui:InvokeWorkflowFile>
                                                          </Sequence>
                                                        </ui:CommentOut.Body>
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                      </ui:CommentOut>
                                                      <ui:WriteRange StartingCell="{x:Null}" AddHeaders="True" DataTable="[dtaTracking]" DisplayName="wr_bench" sap:VirtualizedContainerService.HintSize="780,124.666666666667" sap2010:WorkflowViewState.IdRef="WriteRange_3" SheetName="workbench" WorkbookPath="[Path.Combine(environment.CurrentDirectory,_dicConfig(&quot;PROCESS_DATA&quot;).ToString, _dicConfig(&quot;WORKTRAY_FILE&quot;).ToString)]">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                      </ui:WriteRange>
                                                    </Sequence>
                                                  </ActivityAction>
                                                </ui:ForEach.Body>
                                              </ui:ForEach>
                                            </If.Then>
                                            <If.Else>
                                              <ui:LogMessage DisplayName="log_progress" sap:VirtualizedContainerService.HintSize="334,93.3333333333333" sap2010:WorkflowViewState.IdRef="LogMessage_133" Level="Info" Message="[&quot;Không có số realize nào cần xử lý ngày &quot; &amp; dtiProcess.ToString(&quot;dd/MM/yyyy&quot;) &amp; &quot;...&quot;]" />
                                            </If.Else>
                                          </If>
                                          <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="ivk_utils_update_worktray" sap:VirtualizedContainerService.HintSize="1238.66666666667,123.333333333333" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_30" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="wfs\_utils\utils_update_worktray.xaml">
                                            <ui:InvokeWorkflowFile.Arguments>
                                              <InOutArgument x:TypeArguments="sd:DataTable" x:Key="_dtaWorktray">[dtaWorktray]</InOutArgument>
                                              <InArgument x:TypeArguments="x:String" x:Key="_strStatus">Completed</InArgument>
                                              <InArgument x:TypeArguments="x:String" x:Key="_strFileType">realize</InArgument>
                                              <InArgument x:TypeArguments="x:String" x:Key="_strUpdateColumn">prepare</InArgument>
                                            </ui:InvokeWorkflowFile.Arguments>
                                          </ui:InvokeWorkflowFile>
                                        </Sequence>
                                      </If.Then>
                                      <If.Else>
                                        <Sequence DisplayName="reset_counter_and_continue" sap:VirtualizedContainerService.HintSize="400,500" sap2010:WorkflowViewState.IdRef="Sequence_219">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <ui:LogMessage DisplayName="log_max_retries_reach" sap:VirtualizedContainerService.HintSize="338,103.333333333333" sap2010:WorkflowViewState.IdRef="LogMessage_127" Level="Info" Message="[&quot;State 2:  Robot đã xử lý ngoại lệ nhiều hơn số lần cho phép... Tiến hành điền Worktray phần Realize là Pending...&quot;]">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                          </ui:LogMessage>
                                          <Assign DisplayName="reset_retry_counter" sap:VirtualizedContainerService.HintSize="338,71.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_152">
                                            <Assign.To>
                                              <OutArgument x:TypeArguments="x:Int32">[intRetryCounter]</OutArgument>
                                            </Assign.To>
                                            <Assign.Value>
                                              <InArgument x:TypeArguments="x:Int32">0</InArgument>
                                            </Assign.Value>
                                          </Assign>
                                          <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="ivk_utils_update_worktray" sap:VirtualizedContainerService.HintSize="338,123.333333333333" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_45" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="wfs\_utils\utils_update_worktray.xaml">
                                            <ui:InvokeWorkflowFile.Arguments>
                                              <InOutArgument x:TypeArguments="sd:DataTable" x:Key="_dtaWorktray">[dtaWorktray]</InOutArgument>
                                              <InArgument x:TypeArguments="x:String" x:Key="_strStatus">Failed</InArgument>
                                              <InArgument x:TypeArguments="x:String" x:Key="_strFileType">realize</InArgument>
                                              <InArgument x:TypeArguments="x:String" x:Key="_strUpdateColumn">prepare</InArgument>
                                            </ui:InvokeWorkflowFile.Arguments>
                                          </ui:InvokeWorkflowFile>
                                        </Sequence>
                                      </If.Else>
                                    </If>
                                  </Sequence>
                                </If.Then>
                                <If.Else>
                                  <ui:LogMessage DisplayName="log_info_pass_state_2" sap:VirtualizedContainerService.HintSize="334,103.333333333333" sap2010:WorkflowViewState.IdRef="LogMessage_113" Level="Info" Message="[&quot;State 2:  Không cần xử lý thao tác tạo file import từ Realize Report...&quot;]">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                  </ui:LogMessage>
                                </If.Else>
                              </If>
                              <ui:WriteRange StartingCell="{x:Null}" AddHeaders="True" DataTable="[dtaWorktray]" DisplayName="wr_worktray" sap:VirtualizedContainerService.HintSize="2148.66666666667,124.666666666667" sap2010:WorkflowViewState.IdRef="WriteRange_2" SheetName="base" WorkbookPath="[Path.Combine(environment.CurrentDirectory,_dicConfig(&quot;PROCESS_DATA&quot;).ToString, _dicConfig(&quot;WORKTRAY_FILE&quot;).ToString)]">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                              </ui:WriteRange>
                              <ui:Comment sap:VirtualizedContainerService.HintSize="2148.66666666667,104.666666666667" sap2010:WorkflowViewState.IdRef="Comment_20" Text="Invoke your process above from here. If process is successful, the assignments at the end of the state will occur." />
                              <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="ivk_utils_close_apps" sap:VirtualizedContainerService.HintSize="2148.66666666667,123.333333333333" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_76" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="wfs\_fmw\utils_close_apps.xaml">
                                <ui:InvokeWorkflowFile.Arguments>
                                  <InArgument x:TypeArguments="x:Int32" x:Key="_intTimeoutClose">1</InArgument>
                                </ui:InvokeWorkflowFile.Arguments>
                              </ui:InvokeWorkflowFile>
                              <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" sap2010:Annotation.AnnotationText="This activity allows to stop execution from orchestrator. It can be invoked many times as needed per state, to ensure checking of orchestrator signal." DisplayName="inv_orchestrator_stop_process" sap:VirtualizedContainerService.HintSize="2148.66666666667,183.333333333333" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_20" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="wfs\_fmw\orchestrator_stop_process.xaml">
                                <ui:InvokeWorkflowFile.Arguments>
                                  <scg:Dictionary x:TypeArguments="x:String, Argument" />
                                </ui:InvokeWorkflowFile.Arguments>
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                              </ui:InvokeWorkflowFile>
                              <Assign DisplayName="increment_robot_state" sap:VirtualizedContainerService.HintSize="2148.66666666667,71.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_87">
                                <Assign.To>
                                  <OutArgument x:TypeArguments="x:Int32">[_intRobotState]</OutArgument>
                                </Assign.To>
                                <Assign.Value>
                                  <InArgument x:TypeArguments="x:Int32">[_intRobotState + 1]</InArgument>
                                </Assign.Value>
                              </Assign>
                              <Assign DisplayName="reset_retry_counter" sap:VirtualizedContainerService.HintSize="2148.66666666667,71.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_88">
                                <Assign.To>
                                  <OutArgument x:TypeArguments="x:Int32">[intRetryCounter]</OutArgument>
                                </Assign.To>
                                <Assign.Value>
                                  <InArgument x:TypeArguments="x:Int32">0</InArgument>
                                </Assign.Value>
                              </Assign>
                            </Sequence>
                          </TryCatch.Try>
                          <TryCatch.Catches>
                            <Catch x:TypeArguments="ui:BusinessRuleException" sap:VirtualizedContainerService.HintSize="2195.33333333333,141.333333333333" sap2010:WorkflowViewState.IdRef="Catch`1_31">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <ActivityAction x:TypeArguments="ui:BusinessRuleException">
                                <ActivityAction.Argument>
                                  <DelegateInArgument x:TypeArguments="ui:BusinessRuleException" Name="exception" />
                                </ActivityAction.Argument>
                                <Assign DisplayName="get_business_exception" sap:VirtualizedContainerService.HintSize="262,71.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_89">
                                  <Assign.To>
                                    <OutArgument x:TypeArguments="ui:BusinessRuleException">[excBusinessError]</OutArgument>
                                  </Assign.To>
                                  <Assign.Value>
                                    <InArgument x:TypeArguments="ui:BusinessRuleException">[exception]</InArgument>
                                  </Assign.Value>
                                </Assign>
                              </ActivityAction>
                            </Catch>
                            <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="2195.33333333333,141.333333333333" sap2010:WorkflowViewState.IdRef="Catch`1_32">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <ActivityAction x:TypeArguments="s:Exception">
                                <ActivityAction.Argument>
                                  <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                </ActivityAction.Argument>
                                <Assign DisplayName="get_system_exception" sap:VirtualizedContainerService.HintSize="262,71.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_90">
                                  <Assign.To>
                                    <OutArgument x:TypeArguments="s:Exception">[excSystemError]</OutArgument>
                                  </Assign.To>
                                  <Assign.Value>
                                    <InArgument x:TypeArguments="s:Exception">[exception]</InArgument>
                                  </Assign.Value>
                                </Assign>
                              </ActivityAction>
                            </Catch>
                          </TryCatch.Catches>
                        </TryCatch>
                      </If.Then>
                    </If>
                  </Sequence>
                </State.Entry>
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <av:Point x:Key="ShapeLocation">245,158.5</av:Point>
                    <av:Size x:Key="ShapeSize">210,94</av:Size>
                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    <x:Double x:Key="StateContainerWidth">176</x:Double>
                    <x:Double x:Key="StateContainerHeight">27.04000000000002</x:Double>
                    <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <State.Transitions>
                  <Transition DisplayName="Success" sap:VirtualizedContainerService.HintSize="450,505" sap2010:WorkflowViewState.IdRef="Transition_28">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Int32 x:Key="SrcConnectionPointIndex">49</x:Int32>
                        <x:Int32 x:Key="DestConnectionPointIndex">29</x:Int32>
                        <av:PointCollection x:Key="ConnectorLocation">245,219.6 215,219.6 215,326.1 245,326.1</av:PointCollection>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <Transition.Condition>[excSystemError is Nothing and excBusinessError is Nothing]</Transition.Condition>
                    <Transition.To>
                      <State x:Name="__ReferenceID5" sap2010:Annotation.AnnotationText="Process Steel REQ_ETAX" DisplayName="process_steel" sap:VirtualizedContainerService.HintSize="210,94" sap2010:WorkflowViewState.IdRef="State_20">
                        <State.Entry>
                          <Sequence sap2010:Annotation.AnnotationText="When copying this state, the only modification to be made is changing the condition of the below IF statement to match the process number." DisplayName="process_current_state" sap:VirtualizedContainerService.HintSize="2376,6773.33333333333" sap2010:WorkflowViewState.IdRef="Sequence_104">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                            <If Condition="[_intRobotState = 3]" DisplayName="if_robot_state_is_this" sap:VirtualizedContainerService.HintSize="2334,6650.66666666667" sap2010:WorkflowViewState.IdRef="If_34">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <If.Then>
                                <TryCatch DisplayName="tc_process_current_state" sap:VirtualizedContainerService.HintSize="2297.33333333333,6468.66666666667" sap2010:WorkflowViewState.IdRef="TryCatch_18">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <TryCatch.Try>
                                    <Sequence DisplayName="try_process_current_state" sap:VirtualizedContainerService.HintSize="2258.66666666667,5887.33333333333" sap2010:WorkflowViewState.IdRef="Sequence_103">
                                      <Sequence.Variables>
                                        <Variable x:TypeArguments="sd:DataTable" Name="dtaWorktrayFiltered" />
                                        <Variable x:TypeArguments="s:String[]" Name="arrSteelRequests" />
                                      </Sequence.Variables>
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <ui:LogMessage DisplayName="log_starting_state" sap:VirtualizedContainerService.HintSize="2216.66666666667,93.3333333333333" sap2010:WorkflowViewState.IdRef="LogMessage_69" Level="Info" Message="[&quot;--- Khởi tạo state: &quot;+ _intRobotState.ToString + &quot; ---&quot;]">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                      </ui:LogMessage>
                                      <ui:FilterDataTable sap2010:Annotation.AnnotationText="filter criteria &quot;prepare&quot; = Inactive" DataTable="[dtaWorktray]" DisplayName="filter_dtaWorktray" FilterRowsMode="Keep" sap:VirtualizedContainerService.HintSize="2216.66666666667,192" sap2010:WorkflowViewState.IdRef="FilterDataTable_6" OutputDataTable="[dtaWorktrayFiltered]" SelectColumnsMode="Keep">
                                        <ui:FilterDataTable.Filters>
                                          <scg:List x:TypeArguments="ui:FilterOperationArgument" Capacity="4">
                                            <ui:FilterOperationArgument BooleanOperator="And" Operator="CONTAINS">
                                              <ui:FilterOperationArgument.Column>
                                                <InArgument x:TypeArguments="x:String">["prepare"]</InArgument>
                                              </ui:FilterOperationArgument.Column>
                                              <ui:FilterOperationArgument.Operand>
                                                <InArgument x:TypeArguments="x:String">["Inactive"]</InArgument>
                                              </ui:FilterOperationArgument.Operand>
                                            </ui:FilterOperationArgument>
                                            <ui:FilterOperationArgument BooleanOperator="And" Operator="CONTAINS">
                                              <ui:FilterOperationArgument.Column>
                                                <InArgument x:TypeArguments="x:String">["file_type"]</InArgument>
                                              </ui:FilterOperationArgument.Column>
                                              <ui:FilterOperationArgument.Operand>
                                                <InArgument x:TypeArguments="x:String">["steel"]</InArgument>
                                              </ui:FilterOperationArgument.Operand>
                                            </ui:FilterOperationArgument>
                                          </scg:List>
                                        </ui:FilterDataTable.Filters>
                                        <ui:FilterDataTable.SelectColumns>
                                          <scg:List x:TypeArguments="InArgument" Capacity="4">
                                            <x:Null />
                                          </scg:List>
                                        </ui:FilterDataTable.SelectColumns>
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                      </ui:FilterDataTable>
                                      <If Condition="[dtaWorktrayFiltered.Rows.Count &gt; 0]" DisplayName="if_has_file_to_proceed" sap:VirtualizedContainerService.HintSize="2216.66666666667,4536" sap2010:WorkflowViewState.IdRef="If_104">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <If.Then>
                                          <Sequence DisplayName="process_state_3" sap:VirtualizedContainerService.HintSize="1812.66666666667,4374" sap2010:WorkflowViewState.IdRef="Sequence_292">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <ui:LogMessage DisplayName="log_info_start" sap:VirtualizedContainerService.HintSize="1770.66666666667,93.3333333333333" sap2010:WorkflowViewState.IdRef="LogMessage_134" Level="Info" Message="[&quot;State 3:  Bắt đầu bước tạo file import từ Yêu cầu phát hành hóa đơn từ phòng Thép...&quot;]">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                            </ui:LogMessage>
                                            <If Condition="[intRetryCounter &lt; intMaxTryNumber -1]" DisplayName="if_retry_max_times" sap:VirtualizedContainerService.HintSize="1770.66666666667,4148.66666666667" sap2010:WorkflowViewState.IdRef="If_103">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <If.Then>
                                                <Sequence DisplayName="process_steel" sap:VirtualizedContainerService.HintSize="1348.66666666667,3986.66666666667" sap2010:WorkflowViewState.IdRef="Sequence_290">
                                                  <Sequence.Variables>
                                                    <Variable x:TypeArguments="x:Boolean" Name="boolFolderExist" />
                                                  </Sequence.Variables>
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <ui:FolderExistsX DisplayName="fe_input_folder" Exists="[boolFolderExist]" sap:VirtualizedContainerService.HintSize="1306.66666666667,134" sap2010:WorkflowViewState.IdRef="FolderExistsX_1" Path="[strSteelInputFolder]" />
                                                  <If Condition="[boolFolderExist]" DisplayName="if_folder_available" sap:VirtualizedContainerService.HintSize="1306.66666666667,223.333333333333" sap2010:WorkflowViewState.IdRef="If_123">
                                                    <If.Then>
                                                      <Assign DisplayName="get_steel_request" sap:VirtualizedContainerService.HintSize="262,61.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_169">
                                                        <Assign.To>
                                                          <OutArgument x:TypeArguments="s:String[]">[arrSteelRequests]</OutArgument>
                                                        </Assign.To>
                                                        <Assign.Value>
                                                          <InArgument x:TypeArguments="s:String[]">[Directory.GetFiles(strSteelInputFolder,"*.xls*")]</InArgument>
                                                        </Assign.Value>
                                                      </Assign>
                                                    </If.Then>
                                                    <If.Else>
                                                      <Assign DisplayName="assign_blank_array" sap:VirtualizedContainerService.HintSize="262,61.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_183">
                                                        <Assign.To>
                                                          <OutArgument x:TypeArguments="s:String[]">[arrSteelRequests]</OutArgument>
                                                        </Assign.To>
                                                        <Assign.Value>
                                                          <InArgument x:TypeArguments="s:String[]">[{}]</InArgument>
                                                        </Assign.Value>
                                                      </Assign>
                                                    </If.Else>
                                                  </If>
                                                  <If Condition="[arrSteelRequests.Count &gt; 0]" DisplayName="if_no_files_to_proceed" sap:VirtualizedContainerService.HintSize="1306.66666666667,3304" sap2010:WorkflowViewState.IdRef="If_105">
                                                    <If.Then>
                                                      <Sequence DisplayName="process_requests" sap:VirtualizedContainerService.HintSize="926.666666666667,3142" sap2010:WorkflowViewState.IdRef="Sequence_296">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <ui:LogMessage DisplayName="log_info_start" sap:VirtualizedContainerService.HintSize="884.666666666667,93.3333333333333" sap2010:WorkflowViewState.IdRef="LogMessage_144" Level="Info" Message="[&quot;State 3:  Bắt đầu xử lý việc tạo file import từ &quot; &amp; arrSteelRequests.Count &amp; &quot; file yêu cầu xuất hóa đơn của phòng thép...&quot;]">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                        </ui:LogMessage>
                                                        <Sequence DisplayName="build_dtaCustomerDefinition" sap:VirtualizedContainerService.HintSize="884.666666666667,634.666666666667" sap2010:WorkflowViewState.IdRef="Sequence_297">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <ui:ReadRange Range="{x:Null}" AddHeaders="True" DataTable="[dtaCustomerDefinition]" DisplayName="rr_customer_definition_list" sap:VirtualizedContainerService.HintSize="434,86.6666666666667" sap2010:WorkflowViewState.IdRef="ReadRange_16" SheetName="definition" WorkbookPath="[Path.Combine(_dicConfig(&quot;INPUTS&quot;).ToString, _dicConfig(&quot;CUSTOMER_DEFINITION_FILE&quot;).ToString)]" />
                                                          <ui:AddDataColumn x:TypeArguments="x:String" AllowDBNull="{x:Null}" AutoIncrement="{x:Null}" Column="{x:Null}" DefaultValue="{x:Null}" MaxLength="{x:Null}" Unique="{x:Null}" ColumnName="Key" DataTable="[dtaCustomerDefinition]" DisplayName="adc_BP&amp;ProfitCenter" sap:VirtualizedContainerService.HintSize="434,188" sap2010:WorkflowViewState.IdRef="AddDataColumn`1_3" />
                                                          <ui:ForEach x:TypeArguments="sd:DataRow" CurrentIndex="{x:Null}" DisplayName="fer__dtaCustomerDefinition" sap:VirtualizedContainerService.HintSize="434,188" sap2010:WorkflowViewState.IdRef="ForEach`1_24" Values="[dtaCustomerDefinition.Rows]">
                                                            <ui:ForEach.Body>
                                                              <ActivityAction x:TypeArguments="sd:DataRow">
                                                                <ActivityAction.Argument>
                                                                  <DelegateInArgument x:TypeArguments="sd:DataRow" Name="row" />
                                                                </ActivityAction.Argument>
                                                                <Assign sap:VirtualizedContainerService.HintSize="262,61.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_170">
                                                                  <Assign.To>
                                                                    <OutArgument x:TypeArguments="x:Object">[row("Key")]</OutArgument>
                                                                  </Assign.To>
                                                                  <Assign.Value>
                                                                    <InArgument x:TypeArguments="x:String">[row("Steel Section").ToString &amp; row("Mã khách hàng").ToString]</InArgument>
                                                                  </Assign.Value>
                                                                </Assign>
                                                              </ActivityAction>
                                                            </ui:ForEach.Body>
                                                          </ui:ForEach>
                                                        </Sequence>
                                                        <If Condition="[dtaBacklog is Nothing]" DisplayName="is_dtaBacklog_valid" sap:VirtualizedContainerService.HintSize="884.666666666667,268.666666666667" sap2010:WorkflowViewState.IdRef="If_109">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <If.Then>
                                                            <ui:ReadRange Range="{x:Null}" AddHeaders="True" DataTable="[dtaBacklog]" DisplayName="rr_backlog_list" sap:VirtualizedContainerService.HintSize="334,86.6666666666667" sap2010:WorkflowViewState.IdRef="ReadRange_17" SheetName="backlog" WorkbookPath="[Path.Combine(_dicConfig(&quot;INPUTS&quot;).ToString, _dicConfig(&quot;BACKLOG_FILE&quot;).ToString)]" />
                                                          </If.Then>
                                                          <If.Else>
                                                            <Sequence sap2010:WorkflowViewState.IdRef="Sequence_301">
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                            </Sequence>
                                                          </If.Else>
                                                        </If>
                                                        <ui:ForEach x:TypeArguments="x:String" CurrentIndex="{x:Null}" DisplayName="fe_steel_request" sap:VirtualizedContainerService.HintSize="884.666666666667,1933.33333333333" sap2010:WorkflowViewState.IdRef="ForEach`1_23" Values="[arrSteelRequests]">
                                                          <ui:ForEach.Body>
                                                            <ActivityAction x:TypeArguments="x:String">
                                                              <ActivityAction.Argument>
                                                                <DelegateInArgument x:TypeArguments="x:String" Name="file" />
                                                              </ActivityAction.Argument>
                                                              <Sequence DisplayName="process_each_file" sap:VirtualizedContainerService.HintSize="848,1806.66666666667" sap2010:WorkflowViewState.IdRef="Sequence_295">
                                                                <sap:WorkflowViewStateService.ViewState>
                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                  </scg:Dictionary>
                                                                </sap:WorkflowViewStateService.ViewState>
                                                                <If Condition="[dtaTracking.AsEnumerable.Any(Function (a) a(&quot;state&quot;).ToString = &quot;Prepare&quot; AndAlso a(&quot;request&quot;).ToString = Path.GetFileNameWithoutExtension(file))]" DisplayName="check_steel_proceeded" sap:VirtualizedContainerService.HintSize="806,409.333333333333" sap2010:WorkflowViewState.IdRef="If_107">
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                    </scg:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                  <If.Then>
                                                                    <Sequence DisplayName="log_and_continue" sap:VirtualizedContainerService.HintSize="376,247.333333333333" sap2010:WorkflowViewState.IdRef="Sequence_299">
                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                        </scg:Dictionary>
                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                      <ui:LogMessage DisplayName="log_processed" sap:VirtualizedContainerService.HintSize="334,93.3333333333333" sap2010:WorkflowViewState.IdRef="LogMessage_145" Level="Info" Message="[&quot;File &quot; &amp; Path.GetFileNameWithoutExtension(file)  &amp; &quot; đã được xử lý trước đó...&quot;]" />
                                                                      <ui:Continue DisplayName="Continue" sap:VirtualizedContainerService.HintSize="334,22" sap2010:WorkflowViewState.IdRef="Continue_19" />
                                                                    </Sequence>
                                                                  </If.Then>
                                                                  <If.Else>
                                                                    <ui:LogMessage DisplayName="log_process_as_new" sap:VirtualizedContainerService.HintSize="334,93.3333333333333" sap2010:WorkflowViewState.IdRef="LogMessage_146" Level="Info" Message="[&quot;Kiểm tra &amp; xử lý Yêu cầu phát hành hóa đơn &quot; &amp; Path.GetFileNameWithoutExtension(file) &amp; &quot;...&quot;]" />
                                                                  </If.Else>
                                                                </If>
                                                                <If Condition="[dtaBacklog.AsEnumerable.Any(Function (a) a(&quot;invoice_name&quot;).ToString = Path.GetFileNameWithoutExtension(file) AndAlso a(&quot;type&quot;).ToString = &quot;Steel&quot;)]" DisplayName="check_steel_in_backlog" sap:VirtualizedContainerService.HintSize="806,1112" sap2010:WorkflowViewState.IdRef="If_108">
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                    </scg:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                  <If.Then>
                                                                    <Sequence DisplayName="log_and_continue" sap:VirtualizedContainerService.HintSize="426,950" sap2010:WorkflowViewState.IdRef="Sequence_302">
                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                        </scg:Dictionary>
                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                      <ui:LogMessage DisplayName="log_progress" sap:VirtualizedContainerService.HintSize="384,93.3333333333333" sap2010:WorkflowViewState.IdRef="LogMessage_149" Level="Warn" Message="[&quot;Yêu cầu phát hành &quot; &amp; Path.GetFileNameWithoutExtension(file) &amp; &quot; đã được xử lý và ghi lại trong Backlog trước đó. Thực hiện yêu cầu kế tiếp...&quot;]" />
                                                                      <ui:AddDataRow DataRow="{x:Null}" ArrayRow="[{&quot;Prepare&quot;, Path.GetFileNameWithoutExtension(file), &quot;&quot;, &quot;Tạo file import&quot;, &quot;NG&quot;, &quot;Yêu cầu đã được xử lý và xuất hóa đơn trong Backlog&quot;}]" DataTable="[dtaTracking]" DisplayName="adr__dtaTracking" sap:VirtualizedContainerService.HintSize="384,188" sap2010:WorkflowViewState.IdRef="AddDataRow_4" />
                                                                      <ui:WriteRange StartingCell="{x:Null}" AddHeaders="True" DataTable="[dtaTracking]" DisplayName="wr_bench" sap:VirtualizedContainerService.HintSize="384,114.666666666667" sap2010:WorkflowViewState.IdRef="WriteRange_13" SheetName="workbench" WorkbookPath="[Path.Combine(environment.CurrentDirectory,_dicConfig(&quot;PROCESS_DATA&quot;).ToString, _dicConfig(&quot;WORKTRAY_FILE&quot;).ToString)]">
                                                                        <sap:WorkflowViewStateService.ViewState>
                                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                          </scg:Dictionary>
                                                                        </sap:WorkflowViewStateService.ViewState>
                                                                      </ui:WriteRange>
                                                                      <ui:CreateDirectory ContinueOnError="{x:Null}" DisplayName="create_fail_folder" sap:VirtualizedContainerService.HintSize="384,80" sap2010:WorkflowViewState.IdRef="CreateDirectory_1" Path="[strFailedFolder]" />
                                                                      <ui:MoveFile ContinueOnError="{x:Null}" Destination="[Path.Combine(strFailedFolder, Path.GetFileName(file))]" DisplayName="move_file" sap:VirtualizedContainerService.HintSize="384,160" sap2010:WorkflowViewState.IdRef="MoveFile_1" Overwrite="True" Path="[file]" />
                                                                      <ui:Continue sap:VirtualizedContainerService.HintSize="384,22" sap2010:WorkflowViewState.IdRef="Continue_21" />
                                                                    </Sequence>
                                                                  </If.Then>
                                                                  <If.Else>
                                                                    <ui:LogMessage DisplayName="log_progress" sap:VirtualizedContainerService.HintSize="334,93.3333333333333" sap2010:WorkflowViewState.IdRef="LogMessage_147" Level="Info" Message="[&quot;Yêu cầu &quot; &amp; Path.GetFileNameWithoutExtension(file) &amp; &quot; chưa có trong Backlog. Tiến hành xử lý yêu cầu và xuất file import Thái Sơn...&quot;]" />
                                                                  </If.Else>
                                                                </If>
                                                                <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="ivk_excel_get_invoice_data" sap:VirtualizedContainerService.HintSize="806,113.333333333333" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_72" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="wfs\excel\excel_get_steel_invoice_data.xaml">
                                                                  <ui:InvokeWorkflowFile.Arguments>
                                                                    <InArgument x:TypeArguments="x:String" x:Key="_strRequestETAXFile">
                                                                      <mva:VisualBasicValue x:TypeArguments="x:String" ExpressionText="file" />
                                                                    </InArgument>
                                                                    <InArgument x:TypeArguments="s:DateTime" x:Key="_dtiProcess">
                                                                      <mva:VisualBasicValue x:TypeArguments="s:DateTime" ExpressionText="dtiProcess" />
                                                                    </InArgument>
                                                                    <InArgument x:TypeArguments="sd:DataTable" x:Key="_dtaCustomerDefinition">
                                                                      <mva:VisualBasicValue x:TypeArguments="sd:DataTable" ExpressionText="dtaCustomerDefinition" />
                                                                    </InArgument>
                                                                    <InOutArgument x:TypeArguments="sd:DataTable" x:Key="_dtaTracking">
                                                                      <mva:VisualBasicReference x:TypeArguments="sd:DataTable" ExpressionText="dtaTracking" />
                                                                    </InOutArgument>
                                                                    <InArgument x:TypeArguments="x:String" x:Key="_strTemplatePath">
                                                                      <mva:VisualBasicValue x:TypeArguments="x:String" ExpressionText="Path.Combine(_dicConfig(&quot;INPUTS&quot;).ToString, _dicConfig(&quot;TEMPLATE_FILE&quot;).ToString)" />
                                                                    </InArgument>
                                                                    <InArgument x:TypeArguments="x:String" x:Key="_strUploadFolder">
                                                                      <mva:VisualBasicValue x:TypeArguments="x:String" ExpressionText="_dicConfig(&quot;UPLOAD_FOLDER&quot;).ToString" />
                                                                    </InArgument>
                                                                    <InArgument x:TypeArguments="x:String" x:Key="_strCompletedFolder">
                                                                      <mva:VisualBasicValue x:TypeArguments="x:String" ExpressionText="strSuccessFolder" />
                                                                    </InArgument>
                                                                    <InArgument x:TypeArguments="x:String" x:Key="_strFailedFolder">
                                                                      <mva:VisualBasicValue x:TypeArguments="x:String" ExpressionText="strFailedFolder" />
                                                                    </InArgument>
                                                                  </ui:InvokeWorkflowFile.Arguments>
                                                                </ui:InvokeWorkflowFile>
                                                              </Sequence>
                                                            </ActivityAction>
                                                          </ui:ForEach.Body>
                                                        </ui:ForEach>
                                                      </Sequence>
                                                    </If.Then>
                                                    <If.Else>
                                                      <ui:LogMessage DisplayName="log_progress" sap:VirtualizedContainerService.HintSize="334,93.3333333333333" sap2010:WorkflowViewState.IdRef="LogMessage_143" Level="Info" Message="[&quot;Không có file yêu cầu nào cần xử lý lúc &quot; &amp; now.ToString(&quot;dd/MM/yyyy hh:mm:ss&quot;) &amp; &quot;...&quot;]" />
                                                    </If.Else>
                                                  </If>
                                                  <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="ivk_utils_update_worktray" sap:VirtualizedContainerService.HintSize="1306.66666666667,113.333333333333" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_70" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="wfs\_utils\utils_update_worktray.xaml">
                                                    <ui:InvokeWorkflowFile.Arguments>
                                                      <InOutArgument x:TypeArguments="sd:DataTable" x:Key="_dtaWorktray">[dtaWorktray]</InOutArgument>
                                                      <InArgument x:TypeArguments="x:String" x:Key="_strStatus">Completed</InArgument>
                                                      <InArgument x:TypeArguments="x:String" x:Key="_strFileType">steel</InArgument>
                                                      <InArgument x:TypeArguments="x:String" x:Key="_strUpdateColumn">prepare</InArgument>
                                                    </ui:InvokeWorkflowFile.Arguments>
                                                  </ui:InvokeWorkflowFile>
                                                </Sequence>
                                              </If.Then>
                                              <If.Else>
                                                <Sequence DisplayName="reset_counter_and_continue" sap:VirtualizedContainerService.HintSize="376,440" sap2010:WorkflowViewState.IdRef="Sequence_291">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <ui:LogMessage DisplayName="log_max_retries_reach" sap:VirtualizedContainerService.HintSize="334,93.3333333333333" sap2010:WorkflowViewState.IdRef="LogMessage_141" Level="Info" Message="[&quot;State 3:  Robot đã xử lý ngoại lệ nhiều hơn số lần cho phép... Tiến hành điền Worktray phần Steel là Pending...&quot;]">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                  </ui:LogMessage>
                                                  <Assign DisplayName="reset_retry_counter" sap:VirtualizedContainerService.HintSize="334,61.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_168">
                                                    <Assign.To>
                                                      <OutArgument x:TypeArguments="x:Int32">[intRetryCounter]</OutArgument>
                                                    </Assign.To>
                                                    <Assign.Value>
                                                      <InArgument x:TypeArguments="x:Int32">0</InArgument>
                                                    </Assign.Value>
                                                  </Assign>
                                                  <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="ivk_utils_update_worktray" sap:VirtualizedContainerService.HintSize="334,113.333333333333" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_71" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="wfs\_utils\utils_update_worktray.xaml">
                                                    <ui:InvokeWorkflowFile.Arguments>
                                                      <InOutArgument x:TypeArguments="sd:DataTable" x:Key="_dtaWorktray">[dtaWorktray]</InOutArgument>
                                                      <InArgument x:TypeArguments="x:String" x:Key="_strStatus">Failed</InArgument>
                                                      <InArgument x:TypeArguments="x:String" x:Key="_strFileType">steel</InArgument>
                                                      <InArgument x:TypeArguments="x:String" x:Key="_strUpdateColumn">prepare</InArgument>
                                                    </ui:InvokeWorkflowFile.Arguments>
                                                  </ui:InvokeWorkflowFile>
                                                </Sequence>
                                              </If.Else>
                                            </If>
                                          </Sequence>
                                        </If.Then>
                                        <If.Else>
                                          <ui:LogMessage DisplayName="log_info_pass_state_3" sap:VirtualizedContainerService.HintSize="334,93.3333333333333" sap2010:WorkflowViewState.IdRef="LogMessage_142" Level="Info" Message="[&quot;State 3:  Không cần xử lý thao tác tạo file import từ Yêu cầu phát hành hóa đơn đỏ...&quot;]">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                          </ui:LogMessage>
                                        </If.Else>
                                      </If>
                                      <ui:WriteRange StartingCell="{x:Null}" AddHeaders="True" DataTable="[dtaTracking]" DisplayName="wr_bench" sap:VirtualizedContainerService.HintSize="2216.66666666667,124.666666666667" sap2010:WorkflowViewState.IdRef="WriteRange_14" SheetName="workbench" WorkbookPath="[Path.Combine(environment.CurrentDirectory,_dicConfig(&quot;PROCESS_DATA&quot;).ToString, _dicConfig(&quot;WORKTRAY_FILE&quot;).ToString)]">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                      </ui:WriteRange>
                                      <ui:WriteRange StartingCell="{x:Null}" AddHeaders="True" DataTable="[dtaWorktray]" DisplayName="wr_worktray" sap:VirtualizedContainerService.HintSize="2216.66666666667,124.666666666667" sap2010:WorkflowViewState.IdRef="WriteRange_15" SheetName="base" WorkbookPath="[Path.Combine(environment.CurrentDirectory,_dicConfig(&quot;PROCESS_DATA&quot;).ToString, _dicConfig(&quot;WORKTRAY_FILE&quot;).ToString)]">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                      </ui:WriteRange>
                                      <ui:Comment sap:VirtualizedContainerService.HintSize="2216.66666666667,104" sap2010:WorkflowViewState.IdRef="Comment_21" Text="Invoke your process above from here. If process is successful, the assignments at the end of the state will occur." />
                                      <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" sap2010:Annotation.AnnotationText="This activity allows to stop execution from orchestrator. It can be invoked many times as needed per state, to ensure checking of orchestrator signal." DisplayName="inv_orchestrator_stop_process" sap:VirtualizedContainerService.HintSize="2216.66666666667,156.666666666667" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_21" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="wfs\_fmw\orchestrator_stop_process.xaml">
                                        <ui:InvokeWorkflowFile.Arguments>
                                          <scg:Dictionary x:TypeArguments="x:String, Argument" />
                                        </ui:InvokeWorkflowFile.Arguments>
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                      </ui:InvokeWorkflowFile>
                                      <Assign DisplayName="increment_robot_state" sap:VirtualizedContainerService.HintSize="2216.66666666667,72" sap2010:WorkflowViewState.IdRef="Assign_91">
                                        <Assign.To>
                                          <OutArgument x:TypeArguments="x:Int32">[_intRobotState]</OutArgument>
                                        </Assign.To>
                                        <Assign.Value>
                                          <InArgument x:TypeArguments="x:Int32">[_intRobotState + 1]</InArgument>
                                        </Assign.Value>
                                      </Assign>
                                      <Assign DisplayName="reset_retry_counter" sap:VirtualizedContainerService.HintSize="2216.66666666667,72" sap2010:WorkflowViewState.IdRef="Assign_92">
                                        <Assign.To>
                                          <OutArgument x:TypeArguments="x:Int32">[intRetryCounter]</OutArgument>
                                        </Assign.To>
                                        <Assign.Value>
                                          <InArgument x:TypeArguments="x:Int32">0</InArgument>
                                        </Assign.Value>
                                      </Assign>
                                    </Sequence>
                                  </TryCatch.Try>
                                  <TryCatch.Catches>
                                    <Catch x:TypeArguments="ui:BusinessRuleException" sap:VirtualizedContainerService.HintSize="2263.33333333333,131.333333333333" sap2010:WorkflowViewState.IdRef="Catch`1_33">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <ActivityAction x:TypeArguments="ui:BusinessRuleException">
                                        <ActivityAction.Argument>
                                          <DelegateInArgument x:TypeArguments="ui:BusinessRuleException" Name="exception" />
                                        </ActivityAction.Argument>
                                        <Assign DisplayName="get_business_exception" sap:VirtualizedContainerService.HintSize="262,61.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_93">
                                          <Assign.To>
                                            <OutArgument x:TypeArguments="ui:BusinessRuleException">[excBusinessError]</OutArgument>
                                          </Assign.To>
                                          <Assign.Value>
                                            <InArgument x:TypeArguments="ui:BusinessRuleException">[exception]</InArgument>
                                          </Assign.Value>
                                        </Assign>
                                      </ActivityAction>
                                    </Catch>
                                    <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="2263.33333333333,131.333333333333" sap2010:WorkflowViewState.IdRef="Catch`1_34">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <ActivityAction x:TypeArguments="s:Exception">
                                        <ActivityAction.Argument>
                                          <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                        </ActivityAction.Argument>
                                        <Assign DisplayName="get_system_exception" sap:VirtualizedContainerService.HintSize="262,61.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_94">
                                          <Assign.To>
                                            <OutArgument x:TypeArguments="s:Exception">[excSystemError]</OutArgument>
                                          </Assign.To>
                                          <Assign.Value>
                                            <InArgument x:TypeArguments="s:Exception">[exception]</InArgument>
                                          </Assign.Value>
                                        </Assign>
                                      </ActivityAction>
                                    </Catch>
                                  </TryCatch.Catches>
                                </TryCatch>
                              </If.Then>
                            </If>
                          </Sequence>
                        </State.Entry>
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <av:Point x:Key="ShapeLocation">245,288.5</av:Point>
                            <av:Size x:Key="ShapeSize">210,94</av:Size>
                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            <x:Double x:Key="StateContainerWidth">176</x:Double>
                            <x:Double x:Key="StateContainerHeight">27.04000000000002</x:Double>
                            <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <State.Transitions>
                          <Transition DisplayName="Success" sap:VirtualizedContainerService.HintSize="450,505" sap2010:WorkflowViewState.IdRef="Transition_26">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Int32 x:Key="SrcConnectionPointIndex">53</x:Int32>
                                <x:Int32 x:Key="DestConnectionPointIndex">21</x:Int32>
                                <av:PointCollection x:Key="ConnectorLocation">245,354.3 215,354.3 215,446.8 244.8,446.8</av:PointCollection>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                            <Transition.Condition>[excSystemError is Nothing and excBusinessError is Nothing]</Transition.Condition>
                            <Transition.To>
                              <State x:Name="__ReferenceID3" sap2010:Annotation.AnnotationText="upload_ThaiSon_files" DisplayName="upload_ts" sap:VirtualizedContainerService.HintSize="210.666666666667,92" sap2010:WorkflowViewState.IdRef="State_18">
                                <State.Entry>
                                  <Sequence sap2010:Annotation.AnnotationText="When copying this state, the only modification to be made is changing the condition of the below IF statement to match the process number." DisplayName="process_current_state" sap:VirtualizedContainerService.HintSize="1980.66666666667,6980.66666666667" sap2010:WorkflowViewState.IdRef="Sequence_100">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <If Condition="[_intRobotState = 4]" DisplayName="if_robot_state_is_this" sap:VirtualizedContainerService.HintSize="1918.66666666667,6828" sap2010:WorkflowViewState.IdRef="If_31">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <If.Then>
                                        <TryCatch DisplayName="tc_process_current_state" sap:VirtualizedContainerService.HintSize="1882,6626" sap2010:WorkflowViewState.IdRef="TryCatch_16">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <TryCatch.Try>
                                            <Sequence DisplayName="try_process_current_state" sap:VirtualizedContainerService.HintSize="1843.33333333333,6014.66666666667" sap2010:WorkflowViewState.IdRef="Sequence_99">
                                              <Sequence.Variables>
                                                <Variable x:TypeArguments="x:String" Name="strProcessDate" />
                                                <Variable x:TypeArguments="x:String" Name="strSubject" />
                                                <Variable x:TypeArguments="x:String" Name="strBodyFile" />
                                                <Variable x:TypeArguments="s:String[]" Name="arrExtraRecipients" />
                                                <Variable x:TypeArguments="s:String[]" Name="arrAttachments" />
                                                <Variable x:TypeArguments="s:String[]" Name="arrBodyFields" />
                                                <Variable x:TypeArguments="sd:DataTable" Name="dtaWorktrayFiltered" />
                                                <Variable x:TypeArguments="sd:DataTable" Name="dtaUpload" />
                                              </Sequence.Variables>
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <ui:LogMessage DisplayName="log_starting_state" sap:VirtualizedContainerService.HintSize="1781.33333333333,103.333333333333" sap2010:WorkflowViewState.IdRef="LogMessage_67" Level="Info" Message="[&quot;--- Khởi tạo state: &quot;+ _intRobotState.ToString + &quot; ---&quot;]">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                              </ui:LogMessage>
                                              <ui:FilterDataTable DataTable="[dtaTracking]" DisplayName="filter_dtaWorkbench" FilterRowsMode="Keep" sap:VirtualizedContainerService.HintSize="1781.33333333333,171.333333333333" sap2010:WorkflowViewState.IdRef="FilterDataTable_7" OutputDataTable="[dtaUpload]" SelectColumnsMode="Keep">
                                                <ui:FilterDataTable.Filters>
                                                  <scg:List x:TypeArguments="ui:FilterOperationArgument" Capacity="4">
                                                    <ui:FilterOperationArgument BooleanOperator="And" Operator="EQ">
                                                      <ui:FilterOperationArgument.Column>
                                                        <InArgument x:TypeArguments="x:String">["state"]</InArgument>
                                                      </ui:FilterOperationArgument.Column>
                                                      <ui:FilterOperationArgument.Operand>
                                                        <InArgument x:TypeArguments="x:String">["Prepare"]</InArgument>
                                                      </ui:FilterOperationArgument.Operand>
                                                    </ui:FilterOperationArgument>
                                                    <ui:FilterOperationArgument BooleanOperator="And" Operator="EQ">
                                                      <ui:FilterOperationArgument.Column>
                                                        <InArgument x:TypeArguments="x:String">["status"]</InArgument>
                                                      </ui:FilterOperationArgument.Column>
                                                      <ui:FilterOperationArgument.Operand>
                                                        <InArgument x:TypeArguments="x:String">["OK"]</InArgument>
                                                      </ui:FilterOperationArgument.Operand>
                                                    </ui:FilterOperationArgument>
                                                    <ui:FilterOperationArgument BooleanOperator="And" Operator="EQ">
                                                      <ui:FilterOperationArgument.Column>
                                                        <InArgument x:TypeArguments="x:String">["activity"]</InArgument>
                                                      </ui:FilterOperationArgument.Column>
                                                      <ui:FilterOperationArgument.Operand>
                                                        <InArgument x:TypeArguments="x:String">["Tạo file import"]</InArgument>
                                                      </ui:FilterOperationArgument.Operand>
                                                    </ui:FilterOperationArgument>
                                                  </scg:List>
                                                </ui:FilterDataTable.Filters>
                                                <ui:FilterDataTable.SelectColumns>
                                                  <scg:List x:TypeArguments="InArgument" Capacity="4">
                                                    <x:Null />
                                                  </scg:List>
                                                </ui:FilterDataTable.SelectColumns>
                                              </ui:FilterDataTable>
                                              <If Condition="[intRetryCounter &lt; intMaxTryNumber - 1]" DisplayName="if_retry_max_times" sap:VirtualizedContainerService.HintSize="1781.33333333333,4618" sap2010:WorkflowViewState.IdRef="If_82">
                                                <If.Then>
                                                  <If Condition="[dtaUpload.Rows.Count &gt; 0]" DisplayName="check_file_to_proceed" sap:VirtualizedContainerService.HintSize="1335.33333333333,4446" sap2010:WorkflowViewState.IdRef="If_116">
                                                    <If.Then>
                                                      <Sequence DisplayName="process_upload" sap:VirtualizedContainerService.HintSize="1298.66666666667,4244" sap2010:WorkflowViewState.IdRef="Sequence_323">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <ui:Comment sap:VirtualizedContainerService.HintSize="1236.66666666667,65.3333333333333" sap2010:WorkflowViewState.IdRef="Comment_25" Text="// Login to upload Thai Son" />
                                                        <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="ivk_utils_close_apps" sap:VirtualizedContainerService.HintSize="1236.66666666667,123.333333333333" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_92" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="wfs\_fmw\utils_close_apps.xaml">
                                                          <ui:InvokeWorkflowFile.Arguments>
                                                            <InArgument x:TypeArguments="x:Int32" x:Key="_intTimeoutClose">1</InArgument>
                                                          </ui:InvokeWorkflowFile.Arguments>
                                                        </ui:InvokeWorkflowFile>
                                                        <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="ivk_browser_open_inv_system" sap:VirtualizedContainerService.HintSize="1236.66666666667,123.333333333333" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_86" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="wfs\browser\browser_open_inv_system.xaml">
                                                          <ui:InvokeWorkflowFile.Arguments>
                                                            <InArgument x:TypeArguments="x:String" x:Key="_strTaxCode">[_dicConfig("THAISON_TAXCODE").ToString]</InArgument>
                                                            <InArgument x:TypeArguments="x:String" x:Key="_strCredentials">[_dicConfig("THAISON_CREDENTIALS").ToString]</InArgument>
                                                            <InArgument x:TypeArguments="x:String" x:Key="_strWebsite">[_dicConfig("THAISON_WEBSITE").ToString]</InArgument>
                                                          </ui:InvokeWorkflowFile.Arguments>
                                                        </ui:InvokeWorkflowFile>
                                                        <If Condition="[dtaBacklog is Nothing]" DisplayName="is_dtaBacklog_valid" sap:VirtualizedContainerService.HintSize="1236.66666666667,298.666666666667" sap2010:WorkflowViewState.IdRef="If_121">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <If.Then>
                                                            <ui:ReadRange Range="{x:Null}" AddHeaders="True" DataTable="[dtaBacklog]" DisplayName="rr_backlog_list" sap:VirtualizedContainerService.HintSize="334,96.6666666666667" sap2010:WorkflowViewState.IdRef="ReadRange_19" SheetName="backlog" WorkbookPath="[Path.Combine(_dicConfig(&quot;INPUTS&quot;).ToString, _dicConfig(&quot;BACKLOG_FILE&quot;).ToString)]" />
                                                          </If.Then>
                                                          <If.Else>
                                                            <Sequence sap2010:WorkflowViewState.IdRef="Sequence_335">
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                            </Sequence>
                                                          </If.Else>
                                                        </If>
                                                        <ui:ForEach x:TypeArguments="sd:DataRow" CurrentIndex="{x:Null}" DisplayName="fer_dtaWorkbench" sap:VirtualizedContainerService.HintSize="1236.66666666667,2861.33333333333" sap2010:WorkflowViewState.IdRef="ForEach`1_28" Values="[dtaUpload.Rows]">
                                                          <ui:ForEach.Body>
                                                            <ActivityAction x:TypeArguments="sd:DataRow">
                                                              <ActivityAction.Argument>
                                                                <DelegateInArgument x:TypeArguments="sd:DataRow" Name="r" />
                                                              </ActivityAction.Argument>
                                                              <Sequence DisplayName="upload_template_file" sap:VirtualizedContainerService.HintSize="1200,2724.66666666667" sap2010:WorkflowViewState.IdRef="Sequence_322">
                                                                <Sequence.Variables>
                                                                  <Variable x:TypeArguments="x:Double" Name="dblTotalAmount" />
                                                                  <Variable x:TypeArguments="x:Boolean" Name="boolCheckResult" />
                                                                  <Variable x:TypeArguments="x:String" Name="strCheckText" />
                                                                </Sequence.Variables>
                                                                <sap:WorkflowViewStateService.ViewState>
                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                  </scg:Dictionary>
                                                                </sap:WorkflowViewStateService.ViewState>
                                                                <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="ivk_excel_check_import_validity" sap:VirtualizedContainerService.HintSize="1138,123.333333333333" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_91" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="wfs\excel\excel_check_import_validity.xaml">
                                                                  <ui:InvokeWorkflowFile.Arguments>
                                                                    <InArgument x:TypeArguments="x:String" x:Key="_strUploadFile">[r("file").ToString]</InArgument>
                                                                    <OutArgument x:TypeArguments="x:String" x:Key="_strCheckText">[strCheckText]</OutArgument>
                                                                    <OutArgument x:TypeArguments="x:Boolean" x:Key="_boolCheckResult">[boolCheckResult]</OutArgument>
                                                                    <OutArgument x:TypeArguments="x:Double" x:Key="_dblTotalAmount">[dblTotalAmount]</OutArgument>
                                                                  </ui:InvokeWorkflowFile.Arguments>
                                                                </ui:InvokeWorkflowFile>
                                                                <If Condition="[boolCheckResult]" DisplayName="if_validity_is_OK" sap:VirtualizedContainerService.HintSize="1138,1124" sap2010:WorkflowViewState.IdRef="If_119">
                                                                  <If.Then>
                                                                    <Sequence DisplayName="log_ok" sap:VirtualizedContainerService.HintSize="400,225.333333333333" sap2010:WorkflowViewState.IdRef="Sequence_330">
                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                        </scg:Dictionary>
                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                      <ui:LogMessage DisplayName="log_progress" sap:VirtualizedContainerService.HintSize="338,103.333333333333" sap2010:WorkflowViewState.IdRef="LogMessage_158" Level="Info" Message="[&quot;File &quot; &amp; r(&quot;file&quot;).ToString &amp; &quot; đã được xác thực dữ liệu upload...&quot;]" />
                                                                    </Sequence>
                                                                  </If.Then>
                                                                  <If.Else>
                                                                    <Sequence DisplayName="warn_result_not_ok" sap:VirtualizedContainerService.HintSize="546,952" sap2010:WorkflowViewState.IdRef="Sequence_331">
                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                        </scg:Dictionary>
                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                      <ui:LogMessage DisplayName="warn_ng" sap:VirtualizedContainerService.HintSize="484,103.333333333333" sap2010:WorkflowViewState.IdRef="LogMessage_159" Level="Warn" Message="[&quot;Dữ liệu File &quot; &amp; r(&quot;file&quot;).ToString &amp; &quot; không đủ để thực hiện bước upload. Bỏ qua yêu cầu này...&quot;]" />
                                                                      <If Condition="[dtaTracking.AsEnumerable.Any(Function (a) a(&quot;state&quot;).ToString = &quot;Upload&quot; AndAlso a(&quot;request&quot;).ToString = r(&quot;request&quot;).ToString) = False]" DisplayName="if_first_try" sap:VirtualizedContainerService.HintSize="484,686.666666666667" sap2010:WorkflowViewState.IdRef="If_120">
                                                                        <If.Then>
                                                                          <Sequence sap:VirtualizedContainerService.HintSize="400,484.666666666667" sap2010:WorkflowViewState.IdRef="Sequence_332">
                                                                            <sap:WorkflowViewStateService.ViewState>
                                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                              </scg:Dictionary>
                                                                            </sap:WorkflowViewStateService.ViewState>
                                                                            <ui:AddDataRow DataRow="{x:Null}" ArrayRow="[{&quot;Upload&quot;, r(&quot;request&quot;).ToString, r(&quot;file&quot;).ToString,&quot;NG&quot;, &quot;File không đủ thông tin để upload&quot;}]" DataTable="[dtaTracking]" DisplayName="adr__dtaTracking" sap:VirtualizedContainerService.HintSize="338,198" sap2010:WorkflowViewState.IdRef="AddDataRow_7" />
                                                                            <ui:WriteRange StartingCell="{x:Null}" AddHeaders="True" DataTable="[dtaTracking]" DisplayName="wr_bench" sap:VirtualizedContainerService.HintSize="338,124.666666666667" sap2010:WorkflowViewState.IdRef="WriteRange_21" SheetName="workbench" WorkbookPath="[Path.Combine(environment.CurrentDirectory,_dicConfig(&quot;PROCESS_DATA&quot;).ToString, _dicConfig(&quot;WORKTRAY_FILE&quot;).ToString)]">
                                                                              <sap:WorkflowViewStateService.ViewState>
                                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                </scg:Dictionary>
                                                                              </sap:WorkflowViewStateService.ViewState>
                                                                            </ui:WriteRange>
                                                                          </Sequence>
                                                                        </If.Then>
                                                                        <If.Else>
                                                                          <Sequence sap2010:WorkflowViewState.IdRef="Sequence_333">
                                                                            <sap:WorkflowViewStateService.ViewState>
                                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                              </scg:Dictionary>
                                                                            </sap:WorkflowViewStateService.ViewState>
                                                                          </Sequence>
                                                                        </If.Else>
                                                                      </If>
                                                                    </Sequence>
                                                                  </If.Else>
                                                                </If>
                                                                <If Condition="[dtaBacklog.AsEnumerable.Any(function (a) a(&quot;invoice_name&quot;).ToString.Contains(r(&quot;request&quot;).ToString)) = False]" DisplayName="if_invoice_already_in_backlog" sap:VirtualizedContainerService.HintSize="1138,1275.33333333333" sap2010:WorkflowViewState.IdRef="If_117">
                                                                  <If.Then>
                                                                    <Sequence DisplayName="new_request" sap:VirtualizedContainerService.HintSize="546,1103.33333333333" sap2010:WorkflowViewState.IdRef="Sequence_326">
                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                        </scg:Dictionary>
                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                      <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="ivk_browser_navigate_create_invoice workflow" sap:VirtualizedContainerService.HintSize="484,123.333333333333" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_87" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="wfs\browser\browser_navigate_create_invoice.xaml">
                                                                        <ui:InvokeWorkflowFile.Arguments>
                                                                          <InArgument x:TypeArguments="x:String" x:Key="_strCreateInvoiceSite">[_dicConfig("THAISON_CREATE_INVOICE_SITE").ToString]</InArgument>
                                                                        </ui:InvokeWorkflowFile.Arguments>
                                                                      </ui:InvokeWorkflowFile>
                                                                      <If Condition="[Split(Path.GetFileNameWithoutExtension(r(&quot;file&quot;).ToString),&quot;_&quot;)(0).Equals(&quot;Kissflow&quot;)]" DisplayName="if_file_is_kf" sap:VirtualizedContainerService.HintSize="484,325.333333333333" sap2010:WorkflowViewState.IdRef="If_122">
                                                                        <If.Then>
                                                                          <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="ivk_excel_update_item_type" sap:VirtualizedContainerService.HintSize="334,123.333333333333" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_94" UnSafe="False" WorkflowFileName="wfs\excel\excel_update_item_type.xaml">
                                                                            <ui:InvokeWorkflowFile.Arguments>
                                                                              <InArgument x:TypeArguments="x:String" x:Key="_strUploadFile">[r("file").ToString]</InArgument>
                                                                            </ui:InvokeWorkflowFile.Arguments>
                                                                          </ui:InvokeWorkflowFile>
                                                                        </If.Then>
                                                                        <If.Else>
                                                                          <Sequence sap2010:WorkflowViewState.IdRef="Sequence_337">
                                                                            <sap:WorkflowViewStateService.ViewState>
                                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                              </scg:Dictionary>
                                                                            </sap:WorkflowViewStateService.ViewState>
                                                                          </Sequence>
                                                                        </If.Else>
                                                                      </If>
                                                                      <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="ivk_browser_upload_invoice" sap:VirtualizedContainerService.HintSize="484,123.333333333333" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_88" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="wfs\browser\browser_upload_invoice.xaml">
                                                                        <ui:InvokeWorkflowFile.Arguments>
                                                                          <InArgument x:TypeArguments="x:String" x:Key="_strUploadFile">[r("file").ToString]</InArgument>
                                                                          <InArgument x:TypeArguments="s:DateTime" x:Key="_dtiProcess">[dtiProcess]</InArgument>
                                                                          <InOutArgument x:TypeArguments="sd:DataTable" x:Key="_dtaTracking">[dtaTracking]</InOutArgument>
                                                                          <InOutArgument x:TypeArguments="sd:DataTable" x:Key="_dtaBacklog">[dtaBacklog]</InOutArgument>
                                                                          <InArgument x:TypeArguments="x:String" x:Key="_strRequest">[r("request").ToString]</InArgument>
                                                                          <InOutArgument x:TypeArguments="x:Int32" x:Key="_intSteelCount">[intSteelCount]</InOutArgument>
                                                                          <InOutArgument x:TypeArguments="x:Int32" x:Key="_intKFCount">[intKFCount]</InOutArgument>
                                                                          <InOutArgument x:TypeArguments="x:Int32" x:Key="_intRealizeCount">[intRealizeCount]</InOutArgument>
                                                                        </ui:InvokeWorkflowFile.Arguments>
                                                                      </ui:InvokeWorkflowFile>
                                                                      <ui:WriteRange StartingCell="{x:Null}" AddHeaders="True" DataTable="[dtaTracking]" DisplayName="wr_bench" sap:VirtualizedContainerService.HintSize="484,124.666666666667" sap2010:WorkflowViewState.IdRef="WriteRange_18" SheetName="workbench" WorkbookPath="[Path.Combine(environment.CurrentDirectory,_dicConfig(&quot;PROCESS_DATA&quot;).ToString, _dicConfig(&quot;WORKTRAY_FILE&quot;).ToString)]">
                                                                        <sap:WorkflowViewStateService.ViewState>
                                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                          </scg:Dictionary>
                                                                        </sap:WorkflowViewStateService.ViewState>
                                                                      </ui:WriteRange>
                                                                      <ui:WriteRange StartingCell="{x:Null}" AddHeaders="True" DataTable="[dtaBacklog]" DisplayName="wr_backlog" sap:VirtualizedContainerService.HintSize="484,124.666666666667" sap2010:WorkflowViewState.IdRef="WriteRange_19" SheetName="backlog" WorkbookPath="[Path.Combine(_dicConfig(&quot;INPUTS&quot;).ToString, _dicConfig(&quot;BACKLOG_FILE&quot;).ToString)]">
                                                                        <sap:WorkflowViewStateService.ViewState>
                                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                          </scg:Dictionary>
                                                                        </sap:WorkflowViewStateService.ViewState>
                                                                      </ui:WriteRange>
                                                                    </Sequence>
                                                                  </If.Then>
                                                                  <If.Else>
                                                                    <Sequence DisplayName="log_skip" sap:VirtualizedContainerService.HintSize="546,1024" sap2010:WorkflowViewState.IdRef="Sequence_327">
                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                        </scg:Dictionary>
                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                      <ui:LogMessage DisplayName="log_already_backlog" sap:VirtualizedContainerService.HintSize="484,103.333333333333" sap2010:WorkflowViewState.IdRef="LogMessage_157" Level="Info" Message="[&quot;Yêu cầu &quot; &amp; r(&quot;request&quot;).ToString &amp; &quot; đã được xử lý trước đó và tồn tại trong backlog...&quot;]" />
                                                                      <If Condition="[dtaTracking.AsEnumerable.Any(Function (a) a(&quot;state&quot;).ToString = &quot;Upload&quot; AndAlso a(&quot;request&quot;).ToString = r(&quot;request&quot;).ToString) = False]" DisplayName="if_first_try" sap:VirtualizedContainerService.HintSize="484,686.666666666667" sap2010:WorkflowViewState.IdRef="If_118">
                                                                        <If.Then>
                                                                          <Sequence sap:VirtualizedContainerService.HintSize="400,484.666666666667" sap2010:WorkflowViewState.IdRef="Sequence_328">
                                                                            <sap:WorkflowViewStateService.ViewState>
                                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                              </scg:Dictionary>
                                                                            </sap:WorkflowViewStateService.ViewState>
                                                                            <ui:AddDataRow DataRow="{x:Null}" ArrayRow="[{&quot;Upload&quot;, r(&quot;request&quot;).ToString, r(&quot;file&quot;).ToString,&quot;NG&quot;, &quot;Yêu cầu đã tồn tại trong backlog&quot;}]" DataTable="[dtaTracking]" DisplayName="adr__dtaTracking" sap:VirtualizedContainerService.HintSize="338,198" sap2010:WorkflowViewState.IdRef="AddDataRow_6" />
                                                                            <ui:WriteRange StartingCell="{x:Null}" AddHeaders="True" DataTable="[dtaTracking]" DisplayName="wr_bench" sap:VirtualizedContainerService.HintSize="338,124.666666666667" sap2010:WorkflowViewState.IdRef="WriteRange_20" SheetName="workbench" WorkbookPath="[Path.Combine(environment.CurrentDirectory,_dicConfig(&quot;PROCESS_DATA&quot;).ToString, _dicConfig(&quot;WORKTRAY_FILE&quot;).ToString)]">
                                                                              <sap:WorkflowViewStateService.ViewState>
                                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                </scg:Dictionary>
                                                                              </sap:WorkflowViewStateService.ViewState>
                                                                            </ui:WriteRange>
                                                                          </Sequence>
                                                                        </If.Then>
                                                                        <If.Else>
                                                                          <Sequence sap2010:WorkflowViewState.IdRef="Sequence_329">
                                                                            <sap:WorkflowViewStateService.ViewState>
                                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                              </scg:Dictionary>
                                                                            </sap:WorkflowViewStateService.ViewState>
                                                                          </Sequence>
                                                                        </If.Else>
                                                                      </If>
                                                                      <ui:Continue sap:VirtualizedContainerService.HintSize="484,32" sap2010:WorkflowViewState.IdRef="Continue_22" />
                                                                    </Sequence>
                                                                  </If.Else>
                                                                </If>
                                                              </Sequence>
                                                            </ActivityAction>
                                                          </ui:ForEach.Body>
                                                        </ui:ForEach>
                                                        <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="ivk_utils_update_worktray" sap:VirtualizedContainerService.HintSize="1236.66666666667,123.333333333333" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_83" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="wfs\_utils\utils_update_worktray.xaml">
                                                          <ui:InvokeWorkflowFile.Arguments>
                                                            <InOutArgument x:TypeArguments="sd:DataTable" x:Key="_dtaWorktray">[dtaWorktray]</InOutArgument>
                                                            <InArgument x:TypeArguments="x:String" x:Key="_strStatus">Completed</InArgument>
                                                            <InArgument x:TypeArguments="x:String" x:Key="_strFileType">steel</InArgument>
                                                            <InArgument x:TypeArguments="x:String" x:Key="_strUpdateColumn">upload</InArgument>
                                                          </ui:InvokeWorkflowFile.Arguments>
                                                        </ui:InvokeWorkflowFile>
                                                        <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="ivk_utils_update_worktray" sap:VirtualizedContainerService.HintSize="1236.66666666667,123.333333333333" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_84" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="wfs\_utils\utils_update_worktray.xaml">
                                                          <ui:InvokeWorkflowFile.Arguments>
                                                            <InOutArgument x:TypeArguments="sd:DataTable" x:Key="_dtaWorktray">[dtaWorktray]</InOutArgument>
                                                            <InArgument x:TypeArguments="x:String" x:Key="_strStatus">Completed</InArgument>
                                                            <InArgument x:TypeArguments="x:String" x:Key="_strFileType">kissflow</InArgument>
                                                            <InArgument x:TypeArguments="x:String" x:Key="_strUpdateColumn">upload</InArgument>
                                                          </ui:InvokeWorkflowFile.Arguments>
                                                        </ui:InvokeWorkflowFile>
                                                        <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="ivk_utils_update_worktray" sap:VirtualizedContainerService.HintSize="1236.66666666667,123.333333333333" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_85" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="wfs\_utils\utils_update_worktray.xaml">
                                                          <ui:InvokeWorkflowFile.Arguments>
                                                            <InOutArgument x:TypeArguments="sd:DataTable" x:Key="_dtaWorktray">[dtaWorktray]</InOutArgument>
                                                            <InArgument x:TypeArguments="x:String" x:Key="_strStatus">Completed</InArgument>
                                                            <InArgument x:TypeArguments="x:String" x:Key="_strFileType">realize</InArgument>
                                                            <InArgument x:TypeArguments="x:String" x:Key="_strUpdateColumn">upload</InArgument>
                                                          </ui:InvokeWorkflowFile.Arguments>
                                                        </ui:InvokeWorkflowFile>
                                                      </Sequence>
                                                    </If.Then>
                                                    <If.Else>
                                                      <Sequence DisplayName="update_worktray" sap:VirtualizedContainerService.HintSize="200,84" sap2010:WorkflowViewState.IdRef="Sequence_324">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                      </Sequence>
                                                    </If.Else>
                                                  </If>
                                                </If.Then>
                                                <If.Else>
                                                  <Sequence DisplayName="reset_counter_and_continue" sap:VirtualizedContainerService.HintSize="400,826.666666666667" sap2010:WorkflowViewState.IdRef="Sequence_325">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <ui:LogMessage DisplayName="log_max_retries_reach" sap:VirtualizedContainerService.HintSize="338,103.333333333333" sap2010:WorkflowViewState.IdRef="LogMessage_156" Level="Info" Message="[&quot;State 4:  Robot đã xử lý ngoại lệ nhiều hơn số lần cho phép... Tiến hành điền Worktray phần upload là Pending...&quot;]">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                    </ui:LogMessage>
                                                    <Assign DisplayName="reset_retry_counter" sap:VirtualizedContainerService.HintSize="338,71.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_182">
                                                      <Assign.To>
                                                        <OutArgument x:TypeArguments="x:Int32">[intRetryCounter]</OutArgument>
                                                      </Assign.To>
                                                      <Assign.Value>
                                                        <InArgument x:TypeArguments="x:Int32">0</InArgument>
                                                      </Assign.Value>
                                                    </Assign>
                                                    <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="ivk_utils_update_worktray" sap:VirtualizedContainerService.HintSize="338,123.333333333333" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_78" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="wfs\_utils\utils_update_worktray.xaml">
                                                      <ui:InvokeWorkflowFile.Arguments>
                                                        <InOutArgument x:TypeArguments="sd:DataTable" x:Key="_dtaWorktray">[dtaWorktray]</InOutArgument>
                                                        <InArgument x:TypeArguments="x:String" x:Key="_strStatus">Failed</InArgument>
                                                        <InArgument x:TypeArguments="x:String" x:Key="_strFileType">steel</InArgument>
                                                        <InArgument x:TypeArguments="x:String" x:Key="_strUpdateColumn">upload</InArgument>
                                                      </ui:InvokeWorkflowFile.Arguments>
                                                    </ui:InvokeWorkflowFile>
                                                    <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="ivk_utils_update_worktray" sap:VirtualizedContainerService.HintSize="338,123.333333333333" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_81" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="wfs\_utils\utils_update_worktray.xaml">
                                                      <ui:InvokeWorkflowFile.Arguments>
                                                        <InOutArgument x:TypeArguments="sd:DataTable" x:Key="_dtaWorktray">[dtaWorktray]</InOutArgument>
                                                        <InArgument x:TypeArguments="x:String" x:Key="_strStatus">Failed</InArgument>
                                                        <InArgument x:TypeArguments="x:String" x:Key="_strFileType">kissflow</InArgument>
                                                        <InArgument x:TypeArguments="x:String" x:Key="_strUpdateColumn">upload</InArgument>
                                                      </ui:InvokeWorkflowFile.Arguments>
                                                    </ui:InvokeWorkflowFile>
                                                    <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="ivk_utils_update_worktray" sap:VirtualizedContainerService.HintSize="338,123.333333333333" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_82" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="wfs\_utils\utils_update_worktray.xaml">
                                                      <ui:InvokeWorkflowFile.Arguments>
                                                        <InOutArgument x:TypeArguments="sd:DataTable" x:Key="_dtaWorktray">[dtaWorktray]</InOutArgument>
                                                        <InArgument x:TypeArguments="x:String" x:Key="_strStatus">Failed</InArgument>
                                                        <InArgument x:TypeArguments="x:String" x:Key="_strFileType">realize</InArgument>
                                                        <InArgument x:TypeArguments="x:String" x:Key="_strUpdateColumn">upload</InArgument>
                                                      </ui:InvokeWorkflowFile.Arguments>
                                                    </ui:InvokeWorkflowFile>
                                                  </Sequence>
                                                </If.Else>
                                              </If>
                                              <ui:WriteRange StartingCell="{x:Null}" AddHeaders="True" DataTable="[dtaTracking]" DisplayName="wr_bench" sap:VirtualizedContainerService.HintSize="1781.33333333333,124.666666666667" sap2010:WorkflowViewState.IdRef="WriteRange_16" SheetName="workbench" WorkbookPath="[Path.Combine(environment.CurrentDirectory,_dicConfig(&quot;PROCESS_DATA&quot;).ToString, _dicConfig(&quot;WORKTRAY_FILE&quot;).ToString)]">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                              </ui:WriteRange>
                                              <ui:WriteRange StartingCell="{x:Null}" AddHeaders="True" DataTable="[dtaWorktray]" DisplayName="wr_worktray" sap:VirtualizedContainerService.HintSize="1781.33333333333,124.666666666667" sap2010:WorkflowViewState.IdRef="WriteRange_17" SheetName="base" WorkbookPath="[Path.Combine(environment.CurrentDirectory,_dicConfig(&quot;PROCESS_DATA&quot;).ToString, _dicConfig(&quot;WORKTRAY_FILE&quot;).ToString)]">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                              </ui:WriteRange>
                                              <ui:Comment sap:VirtualizedContainerService.HintSize="1781.33333333333,104.666666666667" sap2010:WorkflowViewState.IdRef="Comment_19" Text="Invoke your process above from here. If process is successful, the assignments at the end of the state will occur." />
                                              <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" sap2010:Annotation.AnnotationText="This activity allows to stop execution from orchestrator. It can be invoked many times as needed per state, to ensure checking of orchestrator signal." DisplayName="inv_orchestrator_stop_process" sap:VirtualizedContainerService.HintSize="1781.33333333333,183.333333333333" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_22" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="wfs\_fmw\orchestrator_stop_process.xaml">
                                                <ui:InvokeWorkflowFile.Arguments>
                                                  <scg:Dictionary x:TypeArguments="x:String, Argument" />
                                                </ui:InvokeWorkflowFile.Arguments>
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                              </ui:InvokeWorkflowFile>
                                              <Assign DisplayName="increment_robot_state" sap:VirtualizedContainerService.HintSize="1781.33333333333,71.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_83">
                                                <Assign.To>
                                                  <OutArgument x:TypeArguments="x:Int32">[_intRobotState]</OutArgument>
                                                </Assign.To>
                                                <Assign.Value>
                                                  <InArgument x:TypeArguments="x:Int32">[_intRobotState + 1]</InArgument>
                                                </Assign.Value>
                                              </Assign>
                                              <Assign DisplayName="reset_retry_counter" sap:VirtualizedContainerService.HintSize="1781.33333333333,71.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_84">
                                                <Assign.To>
                                                  <OutArgument x:TypeArguments="x:Int32">[intRetryCounter]</OutArgument>
                                                </Assign.To>
                                                <Assign.Value>
                                                  <InArgument x:TypeArguments="x:Int32">0</InArgument>
                                                </Assign.Value>
                                              </Assign>
                                            </Sequence>
                                          </TryCatch.Try>
                                          <TryCatch.Catches>
                                            <Catch x:TypeArguments="ui:BusinessRuleException" sap:VirtualizedContainerService.HintSize="1760.66666666667,141.333333333333" sap2010:WorkflowViewState.IdRef="Catch`1_29">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <ActivityAction x:TypeArguments="ui:BusinessRuleException">
                                                <ActivityAction.Argument>
                                                  <DelegateInArgument x:TypeArguments="ui:BusinessRuleException" Name="exception" />
                                                </ActivityAction.Argument>
                                                <Assign DisplayName="get_business_exception" sap:VirtualizedContainerService.HintSize="262,71.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_85">
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="ui:BusinessRuleException">[excBusinessError]</OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="ui:BusinessRuleException">[exception]</InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                              </ActivityAction>
                                            </Catch>
                                            <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="1760.66666666667,141.333333333333" sap2010:WorkflowViewState.IdRef="Catch`1_30">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <ActivityAction x:TypeArguments="s:Exception">
                                                <ActivityAction.Argument>
                                                  <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                </ActivityAction.Argument>
                                                <Assign DisplayName="get_system_exception" sap:VirtualizedContainerService.HintSize="262,71.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_86">
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="s:Exception">[excSystemError]</OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="s:Exception">[exception]</InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                              </ActivityAction>
                                            </Catch>
                                          </TryCatch.Catches>
                                        </TryCatch>
                                      </If.Then>
                                    </If>
                                  </Sequence>
                                </State.Entry>
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <av:Point x:Key="ShapeLocation">244.8,419.2</av:Point>
                                    <av:Size x:Key="ShapeSize">210.666666666667,92</av:Size>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                    <x:Double x:Key="StateContainerWidth">176.55540450051569</x:Double>
                                    <x:Double x:Key="StateContainerHeight">25.489912898647617</x:Double>
                                    <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <State.Transitions>
                                  <Transition DisplayName="Error" sap:VirtualizedContainerService.HintSize="450,505" sap2010:WorkflowViewState.IdRef="Transition_24">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Int32 x:Key="SrcConnectionPointIndex">40</x:Int32>
                                        <x:Int32 x:Key="DestConnectionPointIndex">65</x:Int32>
                                        <av:PointCollection x:Key="ConnectorLocation">455.466666666667,469.8 485.466666666667,469.8 485.466666666667,515.833333333333 583.2,515.833333333333</av:PointCollection>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <Transition.To>
                                      <x:Reference>__ReferenceID2</x:Reference>
                                    </Transition.To>
                                    <Transition.Condition>[excSystemError isNot Nothing or excBusinessError isNot Nothing]</Transition.Condition>
                                  </Transition>
                                  <Transition DisplayName="Success" sap2010:WorkflowViewState.IdRef="Transition_33">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <av:PointCollection x:Key="ConnectorLocation">244.8,474.4 214.8,474.4 214.8,613.033333333333 250.333333333333,613.033333333333</av:PointCollection>
                                        <x:Int32 x:Key="SrcConnectionPointIndex">45</x:Int32>
                                        <x:Int32 x:Key="DestConnectionPointIndex">49</x:Int32>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <Transition.Condition>[excSystemError is Nothing and excBusinessError is Nothing]</Transition.Condition>
                                    <Transition.To>
                                      <State x:Name="__ReferenceID6" DisplayName="execution_mail" sap:VirtualizedContainerService.HintSize="206.666666666667,98" sap2010:WorkflowViewState.IdRef="State_21">
                                        <State.Entry>
                                          <Sequence sap2010:Annotation.AnnotationText="When copying this state, the only modification to be made is changing the condition of the below IF statement to match the process number." DisplayName="process_current_state" sap:VirtualizedContainerService.HintSize="596,2261.33333333333" sap2010:WorkflowViewState.IdRef="Sequence_311">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <If Condition="[_intRobotState = 5]" DisplayName="if_robot_state_is_this" sap:VirtualizedContainerService.HintSize="554,2171.33333333333" sap2010:WorkflowViewState.IdRef="If_113">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <If.Then>
                                                <TryCatch DisplayName="tc_process_current_state" sap:VirtualizedContainerService.HintSize="517.333333333333,1969.33333333333" sap2010:WorkflowViewState.IdRef="TryCatch_20">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <TryCatch.Try>
                                                    <Sequence DisplayName="try_process_current_state" sap:VirtualizedContainerService.HintSize="478.666666666667,1378" sap2010:WorkflowViewState.IdRef="Sequence_313">
                                                      <Sequence.Variables>
                                                        <Variable x:TypeArguments="x:String" Name="strProcessDate" />
                                                      </Sequence.Variables>
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <ui:LogMessage DisplayName="log_starting_state" sap:VirtualizedContainerService.HintSize="436.666666666667,103.333333333333" sap2010:WorkflowViewState.IdRef="LogMessage_154" Level="Info" Message="[&quot;--- Khởi tạo state: &quot;+ _intRobotState.ToString + &quot; ---&quot;]">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                      </ui:LogMessage>
                                                      <ui:LogMessage DisplayName="log_process" sap:VirtualizedContainerService.HintSize="436.666666666667,103.333333333333" sap2010:WorkflowViewState.IdRef="LogMessage_155" Level="Info" Message="[&quot;Thực hiện gửi mail thông báo kết quả....&quot;]" />
                                                      <Assign DisplayName="assign_datetime_string" sap:VirtualizedContainerService.HintSize="436.666666666667,71.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_177">
                                                        <Assign.To>
                                                          <OutArgument x:TypeArguments="x:String">[strProcessDate]</OutArgument>
                                                        </Assign.To>
                                                        <Assign.Value>
                                                          <InArgument x:TypeArguments="x:String">[dtiProcess.ToString("dd/MM/yyyy [hh:mm:ss]")]</InArgument>
                                                        </Assign.Value>
                                                      </Assign>
                                                      <Sequence sap2010:Annotation.AnnotationText="Add this sequence to a workflow to add internal process information/data" DisplayName="send_mails" sap:VirtualizedContainerService.HintSize="436.666666666667,532.666666666667" sap2010:WorkflowViewState.IdRef="Sequence_334">
                                                        <Sequence.Variables>
                                                          <Variable x:TypeArguments="x:String" Name="strSubject" />
                                                          <Variable x:TypeArguments="x:String" Name="strBodyFile" />
                                                          <Variable x:TypeArguments="s:String[]" Name="arrBodyFields" />
                                                          <Variable x:TypeArguments="s:String[]" Name="arrExtraRecipients" />
                                                          <Variable x:TypeArguments="s:String[]" Name="arrAttachments" />
                                                        </Sequence.Variables>
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                            <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <ui:MultipleAssign DisplayName="assign_txn_report_email_params" sap:VirtualizedContainerService.HintSize="338,230" sap2010:WorkflowViewState.IdRef="MultipleAssign_21">
                                                          <ui:MultipleAssign.AssignOperations>
                                                            <scg:List x:TypeArguments="ui:AssignOperation" Capacity="8">
                                                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_45">
                                                                <ui:AssignOperation.To>
                                                                  <OutArgument x:TypeArguments="x:String">[strSubject]</OutArgument>
                                                                </ui:AssignOperation.To>
                                                                <ui:AssignOperation.Value>
                                                                  <InArgument x:TypeArguments="x:String">[string.Format(_dicConfig("EMAIL_SUBJECT_REPORT").ToString,strProcessDate)]</InArgument>
                                                                </ui:AssignOperation.Value>
                                                              </ui:AssignOperation>
                                                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_46">
                                                                <ui:AssignOperation.To>
                                                                  <OutArgument x:TypeArguments="x:String">[strBodyFile]</OutArgument>
                                                                </ui:AssignOperation.To>
                                                                <ui:AssignOperation.Value>
                                                                  <InArgument x:TypeArguments="x:String">[_dicConfig("BODY_EXECUTION_REPORT").ToString]</InArgument>
                                                                </ui:AssignOperation.Value>
                                                              </ui:AssignOperation>
                                                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_47">
                                                                <ui:AssignOperation.To>
                                                                  <OutArgument x:TypeArguments="s:String[]">[arrBodyFields]</OutArgument>
                                                                </ui:AssignOperation.To>
                                                                <ui:AssignOperation.Value>
                                                                  <InArgument x:TypeArguments="s:String[]">[{_dicConfig("PROCESS_NAME_ID").ToString,intKFCount.tostring,intRealizeCount.tostring,intSteelCount.tostring}]</InArgument>
                                                                </ui:AssignOperation.Value>
                                                              </ui:AssignOperation>
                                                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_48">
                                                                <ui:AssignOperation.To>
                                                                  <OutArgument x:TypeArguments="s:String[]">[arrExtraRecipients]</OutArgument>
                                                                </ui:AssignOperation.To>
                                                                <ui:AssignOperation.Value>
                                                                  <InArgument x:TypeArguments="s:String[]">[{}]</InArgument>
                                                                </ui:AssignOperation.Value>
                                                              </ui:AssignOperation>
                                                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_49">
                                                                <ui:AssignOperation.To>
                                                                  <OutArgument x:TypeArguments="s:String[]">[arrAttachments]</OutArgument>
                                                                </ui:AssignOperation.To>
                                                                <ui:AssignOperation.Value>
                                                                  <InArgument x:TypeArguments="s:String[]">[{Path.Combine(_dicConfig("PROCESS_DATA").ToString, _dicConfig("WORKTRAY_FILE").ToString)}]</InArgument>
                                                                </ui:AssignOperation.Value>
                                                              </ui:AssignOperation>
                                                            </scg:List>
                                                          </ui:MultipleAssign.AssignOperations>
                                                        </ui:MultipleAssign>
                                                        <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="inv_utils_send_email_execution_report" sap:VirtualizedContainerService.HintSize="338,96.6666666666667" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_75" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="wfs\_fmw\utils_send_email.xaml">
                                                          <ui:InvokeWorkflowFile.Arguments>
                                                            <InArgument x:TypeArguments="x:String" x:Key="_strSubject">[strSubject]</InArgument>
                                                            <InArgument x:TypeArguments="x:String" x:Key="_strCredentialsName">[_dicConfig("EMAIL_CREDENTIALS").ToString]</InArgument>
                                                            <InArgument x:TypeArguments="s:String[]" x:Key="_arrBodyFields">[arrBodyFields]</InArgument>
                                                            <InArgument x:TypeArguments="s:String[]" x:Key="_arrRecipients">[arrExtraRecipients]</InArgument>
                                                            <InArgument x:TypeArguments="x:String" x:Key="_strSenderName">
                                                              <Literal x:TypeArguments="x:String" Value="" />
                                                            </InArgument>
                                                            <InArgument x:TypeArguments="s:String[]" x:Key="_arrAttachmentsFiles">[arrAttachments]</InArgument>
                                                            <InArgument x:TypeArguments="x:Boolean" x:Key="_boolSendEmail">[CBool(_dicConfig("SEND_EMAILS"))]</InArgument>
                                                            <InArgument x:TypeArguments="x:Int32" x:Key="_intEnvironment">[CInt(_dicConfig("ENVIRONMENT"))]</InArgument>
                                                            <InArgument x:TypeArguments="x:String" x:Key="_strRecipientsFmwFile">[_dicConfig("RECIPIENTS_FILE").ToString]</InArgument>
                                                            <InArgument x:TypeArguments="x:String" x:Key="_strEmailWrapperFile">[_dicConfig("EMAIL_WRAPPER_INTERNAL").ToString]</InArgument>
                                                            <InArgument x:TypeArguments="x:String" x:Key="_strBodyMsgFile">[strBodyFile]</InArgument>
                                                            <InArgument x:TypeArguments="x:String" x:Key="_strEmailType">execution_report</InArgument>
                                                            <InArgument x:TypeArguments="s:String[]" x:Key="_arrExtraWrapperFields">[{}]</InArgument>
                                                            <InArgument x:TypeArguments="x:String" x:Key="_strEmailServer">[_dicConfig("EMAIL_TYPE").ToString]</InArgument>
                                                            <InArgument x:TypeArguments="x:Int32" x:Key="_intMaxTimeToSendEmail">45</InArgument>
                                                          </ui:InvokeWorkflowFile.Arguments>
                                                        </ui:InvokeWorkflowFile>
                                                      </Sequence>
                                                      <ui:Comment sap:VirtualizedContainerService.HintSize="436.666666666667,104.666666666667" sap2010:WorkflowViewState.IdRef="Comment_23" Text="Invoke your process above from here. If process is successful, the assignments at the end of the state will occur." />
                                                      <Assign DisplayName="increment_robot_state" sap:VirtualizedContainerService.HintSize="436.666666666667,71.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_178">
                                                        <Assign.To>
                                                          <OutArgument x:TypeArguments="x:Int32">[_intRobotState]</OutArgument>
                                                        </Assign.To>
                                                        <Assign.Value>
                                                          <InArgument x:TypeArguments="x:Int32">[_intRobotState + 1]</InArgument>
                                                        </Assign.Value>
                                                      </Assign>
                                                      <Assign DisplayName="reset_retry_counter" sap:VirtualizedContainerService.HintSize="436.666666666667,61.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_179">
                                                        <Assign.To>
                                                          <OutArgument x:TypeArguments="x:Int32">[intRetryCounter]</OutArgument>
                                                        </Assign.To>
                                                        <Assign.Value>
                                                          <InArgument x:TypeArguments="x:Int32">0</InArgument>
                                                        </Assign.Value>
                                                      </Assign>
                                                    </Sequence>
                                                  </TryCatch.Try>
                                                  <TryCatch.Catches>
                                                    <Catch x:TypeArguments="ui:BusinessRuleException" sap:VirtualizedContainerService.HintSize="483.333333333333,131.333333333333" sap2010:WorkflowViewState.IdRef="Catch`1_37">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <ActivityAction x:TypeArguments="ui:BusinessRuleException">
                                                        <ActivityAction.Argument>
                                                          <DelegateInArgument x:TypeArguments="ui:BusinessRuleException" Name="exception" />
                                                        </ActivityAction.Argument>
                                                        <Assign DisplayName="get_business_exception" sap:VirtualizedContainerService.HintSize="262,61.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_175">
                                                          <Assign.To>
                                                            <OutArgument x:TypeArguments="ui:BusinessRuleException">[excBusinessError]</OutArgument>
                                                          </Assign.To>
                                                          <Assign.Value>
                                                            <InArgument x:TypeArguments="ui:BusinessRuleException">[exception]</InArgument>
                                                          </Assign.Value>
                                                        </Assign>
                                                      </ActivityAction>
                                                    </Catch>
                                                    <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="426.666666666667,131.333333333333" sap2010:WorkflowViewState.IdRef="Catch`1_38">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <ActivityAction x:TypeArguments="s:Exception">
                                                        <ActivityAction.Argument>
                                                          <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                        </ActivityAction.Argument>
                                                        <Assign DisplayName="get_system_exception" sap:VirtualizedContainerService.HintSize="262,61.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_176">
                                                          <Assign.To>
                                                            <OutArgument x:TypeArguments="s:Exception">[excSystemError]</OutArgument>
                                                          </Assign.To>
                                                          <Assign.Value>
                                                            <InArgument x:TypeArguments="s:Exception">[exception]</InArgument>
                                                          </Assign.Value>
                                                        </Assign>
                                                      </ActivityAction>
                                                    </Catch>
                                                  </TryCatch.Catches>
                                                </TryCatch>
                                              </If.Then>
                                            </If>
                                          </Sequence>
                                        </State.Entry>
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <av:Point x:Key="ShapeLocation">250.333333333333,549.333333333333</av:Point>
                                            <av:Size x:Key="ShapeSize">206.666666666667,98</av:Size>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            <x:Double x:Key="StateContainerWidth">172.54267874483662</x:Double>
                                            <x:Double x:Key="StateContainerHeight">61.682419781027875</x:Double>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <State.Transitions>
                                          <Transition DisplayName="Success" sap2010:WorkflowViewState.IdRef="Transition_31">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <av:PointCollection x:Key="ConnectorLocation">250.333333333333,632.633333333333 220.333333333333,632.633333333333 220.333333333333,745.933333333333 250,745.933333333333</av:PointCollection>
                                                <x:Int32 x:Key="SrcConnectionPointIndex">65</x:Int32>
                                                <x:Int32 x:Key="DestConnectionPointIndex">29</x:Int32>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <Transition.To>
                                              <x:Reference>__ReferenceID1</x:Reference>
                                            </Transition.To>
                                            <Transition.Condition>[excSystemError is Nothing and excBusinessError is Nothing]</Transition.Condition>
                                          </Transition>
                                          <Transition DisplayName="Error" sap2010:WorkflowViewState.IdRef="Transition_32">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <av:PointCollection x:Key="ConnectorLocation">457,583.633333333333 487,583.633333333333 487,563.766666666667 583.2,563.766666666667</av:PointCollection>
                                                <x:Int32 x:Key="SrcConnectionPointIndex">24</x:Int32>
                                                <x:Int32 x:Key="DestConnectionPointIndex">73</x:Int32>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <Transition.To>
                                              <x:Reference>__ReferenceID2</x:Reference>
                                            </Transition.To>
                                            <Transition.Condition>[excSystemError isNot Nothing or excBusinessError isNot Nothing]</Transition.Condition>
                                          </Transition>
                                        </State.Transitions>
                                      </State>
                                    </Transition.To>
                                  </Transition>
                                </State.Transitions>
                              </State>
                            </Transition.To>
                          </Transition>
                          <Transition DisplayName="Error" sap:VirtualizedContainerService.HintSize="450,505" sap2010:WorkflowViewState.IdRef="Transition_27">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Int32 x:Key="SrcConnectionPointIndex">36</x:Int32>
                                <x:Int32 x:Key="DestConnectionPointIndex">41</x:Int32>
                                <av:PointCollection x:Key="ConnectorLocation">455,335.5 485,335.5 485,372.033333333333 583.2,372.033333333333</av:PointCollection>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                            <Transition.To>
                              <x:Reference>__ReferenceID2</x:Reference>
                            </Transition.To>
                            <Transition.Condition>[excSystemError isNot Nothing or excBusinessError isNot Nothing]</Transition.Condition>
                          </Transition>
                        </State.Transitions>
                      </State>
                    </Transition.To>
                  </Transition>
                  <Transition DisplayName="Error" sap:VirtualizedContainerService.HintSize="450,505" sap2010:WorkflowViewState.IdRef="Transition_29">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Int32 x:Key="SrcConnectionPointIndex">48</x:Int32>
                        <x:Int32 x:Key="DestConnectionPointIndex">25</x:Int32>
                        <av:PointCollection x:Key="ConnectorLocation">455,219.6 485,219.6 485,276.166666666667 583.2,276.166666666667</av:PointCollection>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <Transition.To>
                      <x:Reference>__ReferenceID2</x:Reference>
                    </Transition.To>
                    <Transition.Condition>[excSystemError isNot Nothing or excBusinessError isNot Nothing]</Transition.Condition>
                  </Transition>
                </State.Transitions>
              </State>
            </Transition.To>
          </Transition>
        </State.Transitions>
      </State>
      <State DisplayName="i. State_i" sap:VirtualizedContainerService.HintSize="179.333333333333,61.3333333333333" sap2010:WorkflowViewState.IdRef="State_15">
        <State.Entry>
          <Sequence sap2010:Annotation.AnnotationText="When copying this state, the only modification to be made is changing the condition of the below IF statement to match the process number." DisplayName="process_current_state" sap:VirtualizedContainerService.HintSize="526,1499" sap2010:WorkflowViewState.IdRef="Sequence_92">
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
            <If Condition="[_intRobotState = Cint(&quot;i&quot;)]" DisplayName="if_robot_state_is_this" sap:VirtualizedContainerService.HintSize="484,1363" sap2010:WorkflowViewState.IdRef="If_25">
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <If.Then>
                <TryCatch DisplayName="tc_process_current_state" sap:VirtualizedContainerService.HintSize="438,1173" sap2010:WorkflowViewState.IdRef="TryCatch_14">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <TryCatch.Try>
                    <Sequence DisplayName="try_process_current_state" sap:VirtualizedContainerService.HintSize="376,707" sap2010:WorkflowViewState.IdRef="Sequence_91">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <ui:LogMessage DisplayName="log_starting_state" sap:VirtualizedContainerService.HintSize="334,93" sap2010:WorkflowViewState.IdRef="LogMessage_55" Level="Info" Message="[&quot;--- Starting state: &quot;+ _intRobotState.ToString + &quot; ---&quot;]">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                      </ui:LogMessage>
                      <ui:Comment sap:VirtualizedContainerService.HintSize="334,95" sap2010:WorkflowViewState.IdRef="Comment_18" Text="Invoke your process above from here. If process is successful, the assignments at the end of the state will occur." />
                      <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" sap2010:Annotation.AnnotationText="This activity allows to stop execution from orchestrator. It can be invoked many times as needed per state, to ensure checking of orchestrator signal." DisplayName="inv_orchestrator_stop_process" sap:VirtualizedContainerService.HintSize="334,147" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_28" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="wfs\_fmw\orchestrator_stop_process.xaml">
                        <ui:InvokeWorkflowFile.Arguments>
                          <scg:Dictionary x:TypeArguments="x:String, Argument" />
                        </ui:InvokeWorkflowFile.Arguments>
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                      </ui:InvokeWorkflowFile>
                      <Assign DisplayName="increment_robot_state" sap:VirtualizedContainerService.HintSize="334,60" sap2010:WorkflowViewState.IdRef="Assign_75">
                        <Assign.To>
                          <OutArgument x:TypeArguments="x:Int32">[_intRobotState]</OutArgument>
                        </Assign.To>
                        <Assign.Value>
                          <InArgument x:TypeArguments="x:Int32">[_intRobotState + 1]</InArgument>
                        </Assign.Value>
                      </Assign>
                      <Assign DisplayName="reset_retry_counter" sap:VirtualizedContainerService.HintSize="334,60" sap2010:WorkflowViewState.IdRef="Assign_76">
                        <Assign.To>
                          <OutArgument x:TypeArguments="x:Int32">[intRetryCounter]</OutArgument>
                        </Assign.To>
                        <Assign.Value>
                          <InArgument x:TypeArguments="x:Int32">0</InArgument>
                        </Assign.Value>
                      </Assign>
                    </Sequence>
                  </TryCatch.Try>
                  <TryCatch.Catches>
                    <Catch x:TypeArguments="ui:BusinessRuleException" sap:VirtualizedContainerService.HintSize="404,130" sap2010:WorkflowViewState.IdRef="Catch`1_26">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <ActivityAction x:TypeArguments="ui:BusinessRuleException">
                        <ActivityAction.Argument>
                          <DelegateInArgument x:TypeArguments="ui:BusinessRuleException" Name="exception" />
                        </ActivityAction.Argument>
                        <Assign DisplayName="get_business_exception" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_77">
                          <Assign.To>
                            <OutArgument x:TypeArguments="ui:BusinessRuleException">[excBusinessError]</OutArgument>
                          </Assign.To>
                          <Assign.Value>
                            <InArgument x:TypeArguments="ui:BusinessRuleException">[exception]</InArgument>
                          </Assign.Value>
                        </Assign>
                      </ActivityAction>
                    </Catch>
                    <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="404,21" sap2010:WorkflowViewState.IdRef="Catch`1_27">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <ActivityAction x:TypeArguments="s:Exception">
                        <ActivityAction.Argument>
                          <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                        </ActivityAction.Argument>
                        <Assign DisplayName="get_system_exception" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_78">
                          <Assign.To>
                            <OutArgument x:TypeArguments="s:Exception">[excSystemError]</OutArgument>
                          </Assign.To>
                          <Assign.Value>
                            <InArgument x:TypeArguments="s:Exception">[exception]</InArgument>
                          </Assign.Value>
                        </Assign>
                      </ActivityAction>
                    </Catch>
                  </TryCatch.Catches>
                </TryCatch>
              </If.Then>
            </If>
          </Sequence>
        </State.Entry>
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <av:Point x:Key="ShapeLocation">570.8,9.2</av:Point>
            <av:Size x:Key="ShapeSize">179.333333333333,61.3333333333333</av:Size>
            <x:Boolean x:Key="IsPinned">False</x:Boolean>
            <x:Double x:Key="StateContainerWidth">145</x:Double>
            <x:Double x:Key="StateContainerHeight">25</x:Double>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </State>
      <State x:Name="__ReferenceID7" sap2010:Annotation.AnnotationText="1. Initilize parameters&#xA;2. Close applications&#xA;3. Read config file&#xA;4. Clean process_data folder" DisplayName="framework_init_state" sap:VirtualizedContainerService.HintSize="1067.33333333333,10234" sap2010:WorkflowViewState.IdRef="State_16">
        <State.Entry>
          <TryCatch DisplayName="tc_init_sequence" sap:VirtualizedContainerService.HintSize="1020.66666666667,9762.66666666667" sap2010:WorkflowViewState.IdRef="TryCatch_15">
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
            <TryCatch.Try>
              <Sequence DisplayName="try_init_sequence" sap:VirtualizedContainerService.HintSize="982,8987.33333333333" sap2010:WorkflowViewState.IdRef="Sequence_94">
                <Sequence.Variables>
                  <Variable x:TypeArguments="x:Boolean" Name="boolFileExist" />
                </Sequence.Variables>
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <ui:MultipleAssign DisplayName="assign_init_parameters" sap:VirtualizedContainerService.HintSize="940,283.333333333333" sap2010:WorkflowViewState.IdRef="MultipleAssign_7">
                  <ui:MultipleAssign.AssignOperations>
                    <scg:List x:TypeArguments="ui:AssignOperation" Capacity="8">
                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_12">
                        <ui:AssignOperation.To>
                          <OutArgument x:TypeArguments="s:DateTime">[dtiExecutionStartTime]</OutArgument>
                        </ui:AssignOperation.To>
                        <ui:AssignOperation.Value>
                          <InArgument x:TypeArguments="s:DateTime">[Now]</InArgument>
                        </ui:AssignOperation.Value>
                      </ui:AssignOperation>
                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_13">
                        <ui:AssignOperation.To>
                          <OutArgument x:TypeArguments="s:Exception">[excSystemError]</OutArgument>
                        </ui:AssignOperation.To>
                        <ui:AssignOperation.Value>
                          <InArgument x:TypeArguments="s:Exception">[Nothing]</InArgument>
                        </ui:AssignOperation.Value>
                      </ui:AssignOperation>
                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_14">
                        <ui:AssignOperation.To>
                          <OutArgument x:TypeArguments="ui:BusinessRuleException">[excBusinessError]</OutArgument>
                        </ui:AssignOperation.To>
                        <ui:AssignOperation.Value>
                          <InArgument x:TypeArguments="ui:BusinessRuleException">[Nothing]</InArgument>
                        </ui:AssignOperation.Value>
                      </ui:AssignOperation>
                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_15">
                        <ui:AssignOperation.To>
                          <OutArgument x:TypeArguments="s:String[]">[arrScreenshotNames]</OutArgument>
                        </ui:AssignOperation.To>
                        <ui:AssignOperation.Value>
                          <InArgument x:TypeArguments="s:String[]">[{}]</InArgument>
                        </ui:AssignOperation.Value>
                      </ui:AssignOperation>
                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_50">
                        <ui:AssignOperation.To>
                          <OutArgument x:TypeArguments="x:Int32">[intRealizeCount]</OutArgument>
                        </ui:AssignOperation.To>
                        <ui:AssignOperation.Value>
                          <InArgument x:TypeArguments="x:Int32">0</InArgument>
                        </ui:AssignOperation.Value>
                      </ui:AssignOperation>
                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_51">
                        <ui:AssignOperation.To>
                          <OutArgument x:TypeArguments="x:Int32">[intSteelCount]</OutArgument>
                        </ui:AssignOperation.To>
                        <ui:AssignOperation.Value>
                          <InArgument x:TypeArguments="x:Int32">0</InArgument>
                        </ui:AssignOperation.Value>
                      </ui:AssignOperation>
                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_52">
                        <ui:AssignOperation.To>
                          <OutArgument x:TypeArguments="x:Int32">[intKFCount]</OutArgument>
                        </ui:AssignOperation.To>
                        <ui:AssignOperation.Value>
                          <InArgument x:TypeArguments="x:Int32">0</InArgument>
                        </ui:AssignOperation.Value>
                      </ui:AssignOperation>
                    </scg:List>
                  </ui:MultipleAssign.AssignOperations>
                </ui:MultipleAssign>
                <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="ivk_utils_close_apps" sap:VirtualizedContainerService.HintSize="940,113.333333333333" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_1" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="wfs\_fmw\utils_close_apps.xaml">
                  <ui:InvokeWorkflowFile.Arguments>
                    <InArgument x:TypeArguments="x:Int32" x:Key="_intTimeoutClose">2</InArgument>
                  </ui:InvokeWorkflowFile.Arguments>
                </ui:InvokeWorkflowFile>
                <If sap2010:Annotation.AnnotationText="This allows to be run as standalone (i.e., run this outside Framework where _dicConfigruation is empty) &#xA;OR&#xA;run inside Framework passing the external dictionary as argument" Condition="[_dicConfig Is Nothing]" DisplayName="if_external_config_dict_empty" sap:VirtualizedContainerService.HintSize="940,371.333333333333" sap2010:WorkflowViewState.IdRef="If_26">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <If.Then>
                    <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="inv_utils_read_config_dict" sap:VirtualizedContainerService.HintSize="334,113.333333333333" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_2" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="wfs\_fmw\utils_read_config_dict.xaml">
                      <ui:InvokeWorkflowFile.Arguments>
                        <OutArgument x:TypeArguments="scg:Dictionary(x:String, x:Object)" x:Key="_dicConfiguration">
                          <mva:VisualBasicReference x:TypeArguments="scg:Dictionary(x:String, x:Object)" ExpressionText="_dicConfig" />
                        </OutArgument>
                        <InArgument x:TypeArguments="x:String" x:Key="_strConfigFile">
                          <Literal x:TypeArguments="x:String">C:\Users\htvrpa02\RPA05_ETAXUpload\configuration.xlsx</Literal>
                        </InArgument>
                        <InArgument x:TypeArguments="s:String[]" x:Key="_strarrConfigSheets">
                          <mva:VisualBasicValue x:TypeArguments="s:String[]" ExpressionText="{}{&quot;base&quot;}" />
                        </InArgument>
                      </ui:InvokeWorkflowFile.Arguments>
                    </ui:InvokeWorkflowFile>
                  </If.Then>
                </If>
                <If sap2010:Annotation.AnnotationText="Modify utils_delete_process_files to operate on the specific process files" Condition="[CBool(_dicConfig(&quot;INITIAL_RUN&quot;)) = True]" DisplayName="if_new_execution_is_enable" sap:VirtualizedContainerService.HintSize="940,1367.33333333333" sap2010:WorkflowViewState.IdRef="If_112">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <If.Then>
                    <Sequence DisplayName="delete_all_excel_in_process" sap:VirtualizedContainerService.HintSize="476,1154.66666666667" sap2010:WorkflowViewState.IdRef="Sequence_308">
                      <Sequence.Variables>
                        <Variable x:TypeArguments="s:String[]" Name="arrFiles" />
                      </Sequence.Variables>
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <ui:LogMessage DisplayName="trace_clean_process_data" sap:VirtualizedContainerService.HintSize="434,93.3333333333333" sap2010:WorkflowViewState.IdRef="LogMessage_152" Level="Trace" Message="[&quot;Thưc hiện xóa toàn bộ dữ liệu cũ...&quot;]" />
                      <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="ivk_excel_kill" sap:VirtualizedContainerService.HintSize="434,113.333333333333" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_73" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="wfs\excel\excel_kill.xaml">
                        <ui:InvokeWorkflowFile.Arguments>
                          <scg:Dictionary x:TypeArguments="x:String, Argument" />
                        </ui:InvokeWorkflowFile.Arguments>
                      </ui:InvokeWorkflowFile>
                      <Assign DisplayName="assign_arrFiles (report)" sap:VirtualizedContainerService.HintSize="434,61.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_171">
                        <Assign.To>
                          <OutArgument x:TypeArguments="s:String[]">[arrFiles]</OutArgument>
                        </Assign.To>
                        <Assign.Value>
                          <InArgument x:TypeArguments="s:String[]">[Directory.GetFiles(_dicConfig("REPORT_FOLDER").ToString,"*.xls*",SearchOption.AllDirectories)]</InArgument>
                        </Assign.Value>
                      </Assign>
                      <ui:ForEach x:TypeArguments="x:String" CurrentIndex="{x:Null}" DisplayName="fef_to_delete" sap:VirtualizedContainerService.HintSize="434,206.666666666667" sap2010:WorkflowViewState.IdRef="ForEach`1_25" Values="[arrFiles]">
                        <ui:ForEach.Body>
                          <ActivityAction x:TypeArguments="x:String">
                            <ActivityAction.Argument>
                              <DelegateInArgument x:TypeArguments="x:String" Name="file" />
                            </ActivityAction.Argument>
                            <ui:Delete ContinueOnError="{x:Null}" DisplayName="delete_file" sap:VirtualizedContainerService.HintSize="284,80" sap2010:WorkflowViewState.IdRef="Delete_1" Path="[file]" />
                          </ActivityAction>
                        </ui:ForEach.Body>
                      </ui:ForEach>
                      <Assign DisplayName="assign_arrFiles (upload)" sap:VirtualizedContainerService.HintSize="434,61.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_172">
                        <Assign.To>
                          <OutArgument x:TypeArguments="s:String[]">[arrFiles]</OutArgument>
                        </Assign.To>
                        <Assign.Value>
                          <InArgument x:TypeArguments="s:String[]">[Directory.GetFiles(_dicConfig("UPLOAD_FOLDER").ToString,"*.xls*",SearchOption.AllDirectories)]</InArgument>
                        </Assign.Value>
                      </Assign>
                      <ui:ForEach x:TypeArguments="x:String" CurrentIndex="{x:Null}" DisplayName="fef_to_delete" sap:VirtualizedContainerService.HintSize="434,206.666666666667" sap2010:WorkflowViewState.IdRef="ForEach`1_26" Values="[arrFiles]">
                        <ui:ForEach.Body>
                          <ActivityAction x:TypeArguments="x:String">
                            <ActivityAction.Argument>
                              <DelegateInArgument x:TypeArguments="x:String" Name="file" />
                            </ActivityAction.Argument>
                            <ui:Delete ContinueOnError="{x:Null}" DisplayName="delete_file" sap:VirtualizedContainerService.HintSize="284,80" sap2010:WorkflowViewState.IdRef="Delete_2" Path="[file]" />
                          </ActivityAction>
                        </ui:ForEach.Body>
                      </ui:ForEach>
                      <ui:Delete ContinueOnError="True" DisplayName="delete_worktray" sap:VirtualizedContainerService.HintSize="434,80" sap2010:WorkflowViewState.IdRef="Delete_3" Path="[Path.Combine(_dicConfig(&quot;PROCESS_DATA&quot;).ToString, _dicConfig(&quot;WORKTRAY_FILE&quot;).ToString)]" />
                    </Sequence>
                  </If.Then>
                </If>
                <ui:CommentOut DisplayName="Comment Out" sap:VirtualizedContainerService.HintSize="940,298.666666666667" sap2010:WorkflowViewState.IdRef="CommentOut_14">
                  <ui:CommentOut.Body>
                    <Sequence DisplayName="Ignored Activities" sap:VirtualizedContainerService.HintSize="242,220" sap2010:WorkflowViewState.IdRef="Sequence_309">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <If sap2010:Annotation.AnnotationText="Modify utils_delete_process_files to operate on the specific process files" Condition="[CBool(_dicConfig(&quot;DELETE_TEMP_FILES&quot;))]" DisplayName="if_delete_temp_files_is_enable" sap:VirtualizedContainerService.HintSize="200,128" sap2010:WorkflowViewState.IdRef="If_44">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                            <x:Boolean x:Key="IsPinned">True</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <If.Then>
                          <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="inv_utils_delete_process_files workflow" sap:VirtualizedContainerService.HintSize="334,86.6666666666667" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_3" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="wfs\_fmw\utils_delete_process_files.xaml">
                            <ui:InvokeWorkflowFile.Arguments>
                              <InArgument x:TypeArguments="x:String" x:Key="_strFolderToDelete">[path.Combine(environment.CurrentDirectory,_dicConfig("PROCESS_DATA").ToString)]</InArgument>
                            </ui:InvokeWorkflowFile.Arguments>
                          </ui:InvokeWorkflowFile>
                        </If.Then>
                      </If>
                    </Sequence>
                  </ui:CommentOut.Body>
                </ui:CommentOut>
                <Assign DisplayName="set_retry_number" sap:VirtualizedContainerService.HintSize="940,61.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_79">
                  <Assign.To>
                    <OutArgument x:TypeArguments="x:Int32">[intMaxTryNumber]</OutArgument>
                  </Assign.To>
                  <Assign.Value>
                    <InArgument x:TypeArguments="x:Int32">[CInt(_dicConfig("MAX_TRIES_NUMBER"))]</InArgument>
                  </Assign.Value>
                </Assign>
                <Sequence DisplayName="create_worktray" sap:VirtualizedContainerService.HintSize="940,1053.33333333333" sap2010:WorkflowViewState.IdRef="Sequence_130">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <ui:PathExists DisplayName="pe_worktray_file" Exists="[boolFileExist]" sap:VirtualizedContainerService.HintSize="898,90" sap2010:WorkflowViewState.IdRef="PathExists_1" Path="[Path.Combine(_dicConfig(&quot;PROCESS_DATA&quot;).ToString, _dicConfig(&quot;WORKTRAY_FILE&quot;).ToString)]" PathType="File" />
                  <If Condition="[boolFileExist]" DisplayName="if_worktray_exists" sap:VirtualizedContainerService.HintSize="898,831.333333333333" sap2010:WorkflowViewState.IdRef="If_43">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <If.Then>
                      <Sequence sap2010:Annotation.AnnotationText="" DisplayName="get_current_worktray" sap:VirtualizedContainerService.HintSize="376,622.666666666667" sap2010:WorkflowViewState.IdRef="Sequence_128">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <ui:LogMessage DisplayName="log_trace_worktray_exist" sap:VirtualizedContainerService.HintSize="334,93.3333333333333" sap2010:WorkflowViewState.IdRef="LogMessage_81" Level="Trace" Message="[&quot;Init: Đã có file Worktray.xlsx tồn tại...&quot;]">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                        </ui:LogMessage>
                        <ui:ReadRange Range="{x:Null}" AddHeaders="True" DataTable="[dtaWorktray]" DisplayName="rr_dtaWorktray" sap:VirtualizedContainerService.HintSize="334,86.6666666666667" sap2010:WorkflowViewState.IdRef="ReadRange_1" SheetName="base" WorkbookPath="[Path.Combine(_dicConfig(&quot;PROCESS_DATA&quot;).ToString, _dicConfig(&quot;WORKTRAY_FILE&quot;).ToString)]">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                        </ui:ReadRange>
                        <ui:ReadRange Range="{x:Null}" AddHeaders="True" DataTable="[dtaTracking]" DisplayName="rr_dtaTracking" sap:VirtualizedContainerService.HintSize="334,86.6666666666667" sap2010:WorkflowViewState.IdRef="ReadRange_4" SheetName="workbench" WorkbookPath="[Path.Combine(_dicConfig(&quot;PROCESS_DATA&quot;).ToString, _dicConfig(&quot;WORKTRAY_FILE&quot;).ToString)]">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                        </ui:ReadRange>
                        <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="ivk_utils_replace_value_dta" sap:VirtualizedContainerService.HintSize="334,113.333333333333" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_4" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="wfs\_utils\utils_replace_value_dta.xaml">
                          <ui:InvokeWorkflowFile.Arguments>
                            <InOutArgument x:TypeArguments="sd:DataTable" x:Key="_dtaData">[dtaWorktray]</InOutArgument>
                            <InArgument x:TypeArguments="x:String" x:Key="_strOriginValue">Failed</InArgument>
                            <InArgument x:TypeArguments="x:String" x:Key="_strReplacedValue">Inactive</InArgument>
                          </ui:InvokeWorkflowFile.Arguments>
                        </ui:InvokeWorkflowFile>
                      </Sequence>
                    </If.Then>
                    <If.Else>
                      <Sequence sap2010:Annotation.AnnotationText="" DisplayName="init_a_new_worktray" sap:VirtualizedContainerService.HintSize="476,669.333333333333" sap2010:WorkflowViewState.IdRef="Sequence_129">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <ui:LogMessage DisplayName="trace_worktray_not_exist" sap:VirtualizedContainerService.HintSize="434,93.3333333333333" sap2010:WorkflowViewState.IdRef="LogMessage_82" Level="Trace" Message="[&quot;Init: Không phát hiện file Worktray trong thư mục process. Bắt đầu việc copy file worktray mới...&quot;]" />
                        <ui:CopyFile ContinueOnError="{x:Null}" Destination="[Path.Combine(_dicConfig(&quot;PROCESS_DATA&quot;).ToString, _dicConfig(&quot;WORKTRAY_FILE&quot;).ToString)]" DisplayName="copyfile_worktray_template" sap:VirtualizedContainerService.HintSize="434,160" sap2010:WorkflowViewState.IdRef="CopyFile_1" Overwrite="True" Path="[Path.Combine(_dicConfig(&quot;INPUTS&quot;).ToString, _dicConfig(&quot;WORKTRAY_FILE&quot;).ToString)]">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                        </ui:CopyFile>
                        <ui:ReadRange Range="{x:Null}" AddHeaders="True" DataTable="[dtaWorktray]" DisplayName="rr_dtaWorktray" sap:VirtualizedContainerService.HintSize="434,86.6666666666667" sap2010:WorkflowViewState.IdRef="ReadRange_3" SheetName="base" WorkbookPath="[Path.Combine(_dicConfig(&quot;PROCESS_DATA&quot;).ToString, _dicConfig(&quot;WORKTRAY_FILE&quot;).ToString)]">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                        </ui:ReadRange>
                        <ui:ReadRange Range="{x:Null}" AddHeaders="True" DataTable="[dtaTracking]" DisplayName="rr_dtaTracking" sap:VirtualizedContainerService.HintSize="434,86.6666666666667" sap2010:WorkflowViewState.IdRef="ReadRange_5" SheetName="workbench" WorkbookPath="[Path.Combine(_dicConfig(&quot;PROCESS_DATA&quot;).ToString, _dicConfig(&quot;WORKTRAY_FILE&quot;).ToString)]">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                        </ui:ReadRange>
                      </Sequence>
                    </If.Else>
                  </If>
                </Sequence>
                <Sequence DisplayName="delete_outdate_files" sap:VirtualizedContainerService.HintSize="940,460" sap2010:WorkflowViewState.IdRef="Sequence_131">
                  <Sequence.Variables>
                    <Variable x:TypeArguments="x:Int32" Name="intObsoleteDays" />
                  </Sequence.Variables>
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <Assign DisplayName="assign_intNuberDaysToDelete" sap:VirtualizedContainerService.HintSize="334,61.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_109">
                    <Assign.To>
                      <OutArgument x:TypeArguments="x:Int32">[intObsoleteDays]</OutArgument>
                    </Assign.To>
                    <Assign.Value>
                      <InArgument x:TypeArguments="x:Int32">[Cint(_dicConfig("OBSOLETE_DAYS_NUMBER"))]</InArgument>
                    </Assign.Value>
                  </Assign>
                  <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="ivk_delete_exceptions" sap:VirtualizedContainerService.HintSize="334,113.333333333333" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_5" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="wfs\_utils\utils_delete_outdate_file.xaml">
                    <ui:InvokeWorkflowFile.Arguments>
                      <InArgument x:TypeArguments="x:String" x:Key="_strFolder">[_dicConfig("EXCEPTIONS").ToString]</InArgument>
                      <InArgument x:TypeArguments="s:DateTime" x:Key="_dtiCurrent">[dtiProcess]</InArgument>
                      <InArgument x:TypeArguments="x:Int32" x:Key="_intMaxDiff">[intObsoleteDays]</InArgument>
                    </ui:InvokeWorkflowFile.Arguments>
                  </ui:InvokeWorkflowFile>
                  <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="ivk_delete_process_logs" sap:VirtualizedContainerService.HintSize="334,113.333333333333" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_6" LogEntry="No" LogExit="No" UnSafe="False" WorkflowFileName="wfs\_utils\utils_delete_outdate_file.xaml">
                    <ui:InvokeWorkflowFile.Arguments>
                      <InArgument x:TypeArguments="x:String" x:Key="_strFolder">[_dicConfig("JSON_PROCESS_LOGS").ToString]</InArgument>
                      <InArgument x:TypeArguments="s:DateTime" x:Key="_dtiCurrent">[dtiProcess]</InArgument>
                      <InArgument x:TypeArguments="x:Int32" x:Key="_intMaxDiff">[intObsoleteDays]</InArgument>
                    </ui:InvokeWorkflowFile.Arguments>
                  </ui:InvokeWorkflowFile>
                </Sequence>
                <Switch x:TypeArguments="x:String" DisplayName="sw_log_enviroment" Expression="[_dicConfig(&quot;ENVIRONMENT&quot;).ToString]" sap:VirtualizedContainerService.HintSize="940,710" sap2010:WorkflowViewState.IdRef="Switch`1_14">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <ui:LogMessage x:Key="10" DisplayName="log_executing_process_dev" sap:VirtualizedContainerService.HintSize="334,93.3333333333333" sap2010:WorkflowViewState.IdRef="LogMessage_56" Level="Info" Message="[&quot;--- Robot chạy trong môi trường DEV ---&quot;]" />
                  <ui:LogMessage x:Key="20" DisplayName="log_executing_process_qa" sap:VirtualizedContainerService.HintSize="334,93.3333333333333" sap2010:WorkflowViewState.IdRef="LogMessage_57" Level="Info" Message="[&quot;--- Robot chạy trong môi trường QA ---&quot;]">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                  </ui:LogMessage>
                  <ui:LogMessage x:Key="30" DisplayName="log_executing_process_prd" sap:VirtualizedContainerService.HintSize="334,93.3333333333333" sap2010:WorkflowViewState.IdRef="LogMessage_58" Level="Info" Message="[&quot;--- Robot chạy trong môi trường PRD ---&quot;]" />
                </Switch>
                <Switch x:TypeArguments="x:String" DisplayName="sw_dtiProcess" Expression="[_dicConfig(&quot;ENVIRONMENT&quot;).ToString]" sap:VirtualizedContainerService.HintSize="496.666666666667,838" sap2010:WorkflowViewState.IdRef="Switch`1_19">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <Sequence x:Key="10" sap:VirtualizedContainerService.HintSize="376,286.666666666667" sap2010:WorkflowViewState.IdRef="Sequence_212">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <Assign DisplayName="assign_dtiProcess_from_config" sap:VirtualizedContainerService.HintSize="334,61.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_140">
                      <Assign.To>
                        <OutArgument x:TypeArguments="s:DateTime">[dtiProcess]</OutArgument>
                      </Assign.To>
                      <Assign.Value>
                        <InArgument x:TypeArguments="s:DateTime">[datetime.ParseExact(_dicConfig("TESTING_DATE").ToString,"dd/MM/yyyy", System.Globalization.CultureInfo.InvariantCulture)]</InArgument>
                      </Assign.Value>
                    </Assign>
                    <ui:LogMessage DisplayName="log_dev_env" sap:VirtualizedContainerService.HintSize="334,93.3333333333333" sap2010:WorkflowViewState.IdRef="LogMessage_103" Level="Info" Message="[&quot;Robot vận hành quy trình cho ngày chỉ định (thử nghiệm): &quot; + dtiProcess.ToString(&quot;dd-MM-yyyy&quot;)]" />
                  </Sequence>
                  <x:Null x:Key="20" />
                  <Assign x:Key="30" DisplayName="assign_dti_now" sap:VirtualizedContainerService.HintSize="262,61.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_184">
                    <Assign.To>
                      <OutArgument x:TypeArguments="s:DateTime">[dtiProcess]</OutArgument>
                    </Assign.To>
                    <Assign.Value>
                      <InArgument x:TypeArguments="s:DateTime">[Now]</InArgument>
                    </Assign.Value>
                  </Assign>
                </Switch>
                <If Condition="[_intRobotState = 0]" DisplayName="if_robot_state_is_zero" sap:VirtualizedContainerService.HintSize="940,359.333333333333" sap2010:WorkflowViewState.IdRef="If_27">
                  <If.Then>
                    <Sequence sap2010:Annotation.AnnotationText="1. Set robot state to 1&#xA;2. Clean process_data folder if it is activated" DisplayName="normal_execution" sap:VirtualizedContainerService.HintSize="304,197.333333333333" sap2010:WorkflowViewState.IdRef="Sequence_93">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <Assign DisplayName="start_robot" sap:VirtualizedContainerService.HintSize="262,61.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_80">
                        <Assign.To>
                          <OutArgument x:TypeArguments="x:Int32">[_intRobotState]</OutArgument>
                        </Assign.To>
                        <Assign.Value>
                          <InArgument x:TypeArguments="x:Int32">1</InArgument>
                        </Assign.Value>
                      </Assign>
                    </Sequence>
                  </If.Then>
                  <If.Else>
                    <ui:LogMessage DisplayName="log_skip_state" sap:VirtualizedContainerService.HintSize="334,93.3333333333333" sap2010:WorkflowViewState.IdRef="LogMessage_59" Level="Warn" Message="[&quot;Robot vận hành từ state: &quot; + _intRobotState.ToString]">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                    </ui:LogMessage>
                  </If.Else>
                </If>
                <Sequence DisplayName="check_input_existance" sap:VirtualizedContainerService.HintSize="940,1850" sap2010:WorkflowViewState.IdRef="Sequence_303">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <ui:PathExists DisplayName="pe_backlog_file" Exists="[boolFileExist]" sap:VirtualizedContainerService.HintSize="484,90" sap2010:WorkflowViewState.IdRef="PathExists_2" Path="[Path.Combine(_dicConfig(&quot;INPUTS&quot;).ToString, _dicConfig(&quot;BACKLOG_FILE&quot;).ToString)]" PathType="File" />
                  <If Condition="[boolFileExist = False]" DisplayName="if_backlog_not_exist" sap:VirtualizedContainerService.HintSize="484,429.333333333333" sap2010:WorkflowViewState.IdRef="If_58">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <If.Then>
                      <Sequence DisplayName="throw_system_exc" sap:VirtualizedContainerService.HintSize="376,247.333333333333" sap2010:WorkflowViewState.IdRef="Sequence_183">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <ui:LogMessage DisplayName="log_warn_file_not_exist" sap:VirtualizedContainerService.HintSize="334,93.3333333333333" sap2010:WorkflowViewState.IdRef="LogMessage_87" Level="Warn" Message="[&quot;File Backlog.xlsx không tồn tại: &quot; &amp; Path.Combine(_dicConfig(&quot;INPUT_FOLDER&quot;).ToString, _dicConfig(&quot;BACKLOG_FILE&quot;).ToString) &amp;&quot;...&quot;]" />
                        <Throw DisplayName="throw_sys_exc" Exception="[new SystemException(&quot;Không tồn tại file Backlog.xlsx&quot;)]" sap:VirtualizedContainerService.HintSize="334,22" sap2010:WorkflowViewState.IdRef="Throw_6" />
                      </Sequence>
                    </If.Then>
                    <If.Else>
                      <Sequence sap2010:WorkflowViewState.IdRef="Sequence_184">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                      </Sequence>
                    </If.Else>
                  </If>
                  <ui:PathExists DisplayName="pe_customer_definition_file" Exists="[boolFileExist]" sap:VirtualizedContainerService.HintSize="484,90" sap2010:WorkflowViewState.IdRef="PathExists_3" Path="[Path.Combine(_dicConfig(&quot;INPUTS&quot;).ToString, _dicConfig(&quot;CUSTOMER_DEFINITION_FILE&quot;).ToString)]" PathType="File" />
                  <If Condition="[boolFileExist = False]" DisplayName="if_customer_definition_not_exist" sap:VirtualizedContainerService.HintSize="484,429.333333333333" sap2010:WorkflowViewState.IdRef="If_110">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <If.Then>
                      <Sequence DisplayName="throw_system_exc" sap:VirtualizedContainerService.HintSize="376,247.333333333333" sap2010:WorkflowViewState.IdRef="Sequence_304">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <ui:LogMessage DisplayName="log_warn_file_not_exist" sap:VirtualizedContainerService.HintSize="334,93.3333333333333" sap2010:WorkflowViewState.IdRef="LogMessage_150" Level="Warn" Message="[&quot;File Customer Definition.xlsx không tồn tại: &quot; &amp; Path.Combine(_dicConfig(&quot;INPUT_FOLDER&quot;).ToString, _dicConfig(&quot;BACKLOG_FILE&quot;).ToString) &amp;&quot;...&quot;]" />
                        <Throw DisplayName="throw_sys_exc" Exception="[new SystemException(&quot;Không tồn tại file customer_definition.xlsx&quot;)]" sap:VirtualizedContainerService.HintSize="334,22" sap2010:WorkflowViewState.IdRef="Throw_8" />
                      </Sequence>
                    </If.Then>
                    <If.Else>
                      <Sequence sap2010:WorkflowViewState.IdRef="Sequence_305">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                      </Sequence>
                    </If.Else>
                  </If>
                  <ui:PathExists DisplayName="pe_special_item_definition_file" Exists="[boolFileExist]" sap:VirtualizedContainerService.HintSize="484,90" sap2010:WorkflowViewState.IdRef="PathExists_4" Path="[Path.Combine(_dicConfig(&quot;INPUTS&quot;).ToString, _dicConfig(&quot;SPECIAL_FILE&quot;).ToString)]" PathType="File" />
                  <If Condition="[boolFileExist = False]" DisplayName="if_special_item_not_exist" sap:VirtualizedContainerService.HintSize="484,429.333333333333" sap2010:WorkflowViewState.IdRef="If_111">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <If.Then>
                      <Sequence DisplayName="throw_system_exc" sap:VirtualizedContainerService.HintSize="376,247.333333333333" sap2010:WorkflowViewState.IdRef="Sequence_306">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <ui:LogMessage DisplayName="log_warn_file_not_exist" sap:VirtualizedContainerService.HintSize="334,93.3333333333333" sap2010:WorkflowViewState.IdRef="LogMessage_151" Level="Warn" Message="[&quot;File Special_Item.xlsx không tồn tại: &quot; &amp; Path.Combine(_dicConfig(&quot;INPUT_FOLDER&quot;).ToString, _dicConfig(&quot;BACKLOG_FILE&quot;).ToString) &amp;&quot;...&quot;]" />
                        <Throw DisplayName="throw_sys_exc" Exception="[new SystemException(&quot;Không tồn tại file special_item.xlsx&quot;)]" sap:VirtualizedContainerService.HintSize="334,22" sap2010:WorkflowViewState.IdRef="Throw_9" />
                      </Sequence>
                    </If.Then>
                    <If.Else>
                      <Sequence sap2010:WorkflowViewState.IdRef="Sequence_307">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                      </Sequence>
                    </If.Else>
                  </If>
                </Sequence>
                <ui:MultipleAssign DisplayName="init_folder" sap:VirtualizedContainerService.HintSize="940,160.666666666667" sap2010:WorkflowViewState.IdRef="MultipleAssign_22">
                  <ui:MultipleAssign.AssignOperations>
                    <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_53">
                        <ui:AssignOperation.To>
                          <OutArgument x:TypeArguments="x:String">[strSteelInputFolder]</OutArgument>
                        </ui:AssignOperation.To>
                        <ui:AssignOperation.Value>
                          <InArgument x:TypeArguments="x:String">[Path.Combine(_dicConfig("STEEL_INPUT_FOLDER").ToString, dtiProcess.ToString("yyyyMMdd"))]</InArgument>
                        </ui:AssignOperation.Value>
                      </ui:AssignOperation>
                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_54">
                        <ui:AssignOperation.To>
                          <OutArgument x:TypeArguments="x:String">[strSuccessFolder]</OutArgument>
                        </ui:AssignOperation.To>
                        <ui:AssignOperation.Value>
                          <InArgument x:TypeArguments="x:String">[Path.Combine(_dicConfig("STEEL_INPUT_FOLDER").ToString, dtiProcess.ToString("yyyyMMdd"), "Success")]</InArgument>
                        </ui:AssignOperation.Value>
                      </ui:AssignOperation>
                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_55">
                        <ui:AssignOperation.To>
                          <OutArgument x:TypeArguments="x:String">[strFailedFolder]</OutArgument>
                        </ui:AssignOperation.To>
                        <ui:AssignOperation.Value>
                          <InArgument x:TypeArguments="x:String">[Path.Combine(_dicConfig("STEEL_INPUT_FOLDER").ToString, dtiProcess.ToString("yyyyMMdd"), "Failed")]</InArgument>
                        </ui:AssignOperation.Value>
                      </ui:AssignOperation>
                    </scg:List>
                  </ui:MultipleAssign.AssignOperations>
                </ui:MultipleAssign>
                <Assign DisplayName="set_counter_0" sap:VirtualizedContainerService.HintSize="940,61.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_81">
                  <Assign.To>
                    <OutArgument x:TypeArguments="x:Int32">[intRetryCounter]</OutArgument>
                  </Assign.To>
                  <Assign.Value>
                    <InArgument x:TypeArguments="x:Int32">0</InArgument>
                  </Assign.Value>
                </Assign>
              </Sequence>
            </TryCatch.Try>
            <TryCatch.Catches>
              <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="986.666666666667,458" sap2010:WorkflowViewState.IdRef="Catch`1_28">
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <ActivityAction x:TypeArguments="s:Exception">
                  <ActivityAction.Argument>
                    <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                  </ActivityAction.Argument>
                  <Sequence DisplayName="catch_exception" sap:VirtualizedContainerService.HintSize="376,388" sap2010:WorkflowViewState.IdRef="Sequence_95">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <Assign DisplayName="get_exception" sap:VirtualizedContainerService.HintSize="334,61.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_82">
                      <Assign.To>
                        <OutArgument x:TypeArguments="s:Exception">[excSystemError]</OutArgument>
                      </Assign.To>
                      <Assign.Value>
                        <InArgument x:TypeArguments="s:Exception">[exception]</InArgument>
                      </Assign.Value>
                    </Assign>
                    <Assign DisplayName="start_robot" sap:VirtualizedContainerService.HintSize="334,61.3333333333333" sap2010:WorkflowViewState.IdRef="Assign_95">
                      <Assign.To>
                        <OutArgument x:TypeArguments="x:Int32">[_intRobotState]</OutArgument>
                      </Assign.To>
                      <Assign.Value>
                        <InArgument x:TypeArguments="x:Int32">0</InArgument>
                      </Assign.Value>
                    </Assign>
                    <ui:LogMessage DisplayName="system_exception" sap:VirtualizedContainerService.HintSize="334,93.3333333333333" sap2010:WorkflowViewState.IdRef="LogMessage_60" Level="Fatal" Message="[&quot;Khởi tạo robot thất bại.&quot;]" />
                  </Sequence>
                </ActivityAction>
              </Catch>
            </TryCatch.Catches>
          </TryCatch>
        </State.Entry>
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <av:Point x:Key="ShapeLocation">0,108</av:Point>
            <av:Size x:Key="ShapeSize">168.666666666667,429.333333333333</av:Size>
            <x:Boolean x:Key="IsPinned">False</x:Boolean>
            <x:Double x:Key="StateContainerWidth">135</x:Double>
            <x:Double x:Key="StateContainerHeight">301.04</x:Double>
            <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
        <State.Transitions>
          <Transition DisplayName="Success" sap:VirtualizedContainerService.HintSize="450,505" sap2010:WorkflowViewState.IdRef="Transition_19">
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <av:PointCollection x:Key="ConnectorLocation">168.666666666667,129.633333333333 198.666666666667,129.633333333333 198.666666666667,83.5 245,83.5</av:PointCollection>
                <x:Int32 x:Key="SrcConnectionPointIndex">0</x:Int32>
                <x:Int32 x:Key="DestConnectionPointIndex">37</x:Int32>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
            <Transition.To>
              <x:Reference>__ReferenceID0</x:Reference>
            </Transition.To>
            <Transition.Condition>[excSystemError is Nothing and excBusinessError is Nothing]</Transition.Condition>
          </Transition>
          <Transition DisplayName="report_error" sap:VirtualizedContainerService.HintSize="448.8,509.6" sap2010:WorkflowViewState.IdRef="Transition_23">
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Int32 x:Key="SrcConnectionPointIndex">35</x:Int32>
                <x:Int32 x:Key="DestConnectionPointIndex">49</x:Int32>
                <av:PointCollection x:Key="ConnectorLocation">75.9,537.333333333333 75.9,780.266666666667 250,780.266666666667</av:PointCollection>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
            <Transition.To>
              <x:Reference>__ReferenceID1</x:Reference>
            </Transition.To>
            <Transition.Condition>[excSystemError isNot Nothing or excBusinessError isNot Nothing]</Transition.Condition>
          </Transition>
        </State.Transitions>
      </State>
      <x:Reference>__ReferenceID2</x:Reference>
      <x:Reference>__ReferenceID3</x:Reference>
      <x:Reference>__ReferenceID4</x:Reference>
      <x:Reference>__ReferenceID5</x:Reference>
      <x:Reference>__ReferenceID6</x:Reference>
      <StateMachine.Variables>
        <Variable x:TypeArguments="s:Exception" Name="excSystemError" />
        <Variable x:TypeArguments="x:Int32" Name="intRetryCounter" />
        <Variable x:TypeArguments="x:Int32" Name="intMaxTryNumber" />
        <Variable x:TypeArguments="ui:BusinessRuleException" Name="excBusinessError" />
        <Variable x:TypeArguments="s:DateTime" Name="dtiExecutionStartTime" />
        <Variable x:TypeArguments="s:String[]" Name="arrScreenshotNames" />
        <Variable x:TypeArguments="s:DateTime" Name="dtiProcess" />
        <Variable x:TypeArguments="sd:DataTable" Name="dtaWorktray" />
        <Variable x:TypeArguments="sd:DataTable" Name="dtaTracking" />
        <Variable x:TypeArguments="scg:Dictionary(x:String, x:Boolean)" Name="dicRealizeNumber" />
        <Variable x:TypeArguments="sd:DataTable" Name="dtaRealize" />
        <Variable x:TypeArguments="sd:DataTable" Name="dtaCustomerDefinition" />
        <Variable x:TypeArguments="sd:DataTable" Name="dtaSpecialItems" />
        <Variable x:TypeArguments="sd:DataTable" Name="dtaVATReport" />
        <Variable x:TypeArguments="sd:DataTable" Name="dtaMaterialMaster" />
        <Variable x:TypeArguments="sd:DataTable" Name="dtaGrossProfit" />
        <Variable x:TypeArguments="sd:DataTable" Name="dtaBacklog" />
        <Variable x:TypeArguments="sd:DataTable" Name="dtaConversion" />
        <Variable x:TypeArguments="x:Int32" Name="intRealizeCount" />
        <Variable x:TypeArguments="x:Int32" Name="intSteelCount" />
        <Variable x:TypeArguments="x:Int32" Name="intKFCount" />
        <Variable x:TypeArguments="x:String" Name="strSteelInputFolder" />
        <Variable x:TypeArguments="x:String" Name="strSuccessFolder" />
        <Variable x:TypeArguments="x:String" Name="strFailedFolder" />
      </StateMachine.Variables>
    </StateMachine>
  </Sequence>
</Activity>